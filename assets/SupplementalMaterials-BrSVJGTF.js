import{X as C,Y as v,b as r,j as e,F as a,I as h,T as l,Z as m,J,$ as X,S as Y,K as Z,aK as k,ad as W,at as T,ae as $,au as B,av as P,aB as L,aI as Q,aD as V,aE as M,ay as A,aF as ee,aL as ie,aM as ne,aN as y,a7 as p,a8 as R,a9 as F}from"./index-BRm15mQO.js";import{d as E}from"./Visibility-D7LLAtsg.js";const ae=()=>{const{userDetails:i}=C(),t=v(),[s,o]=r.useState(!1),[d,c]=r.useState(!1),x=()=>{i!=null&&i.uid?navigator.clipboard.writeText(i.uid).then(()=>{o(!0),c(!0)}).catch(g=>{console.error("Could not copy text: ",g)}):console.error("User details are null or undefined")},b=(g,u)=>{u!=="clickaway"&&o(!1)},j=()=>{t("/")};return e.jsxs(a,{children:[e.jsx(a,{sx:{display:"flex",alignItems:"center"},children:e.jsx(h,{variant:"text",onClick:j,sx:{mr:2},children:"â† Home Page"})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[(i==null?void 0:i.isAdmin)&&e.jsx(m,{label:"Educator (Admin User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),!(i!=null&&i.isAdmin)&&e.jsx(m,{label:"Student (Regular User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#bbdefb",color:"#1e88e5",mr:1}}),i&&e.jsx(J,{title:d?"Copied!":"Click to Copy",enterDelay:300,leaveDelay:200,children:e.jsx(m,{label:`User ID: ${i.uid}`,variant:"outlined",onClick:x,sx:{borderRadius:"15px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",mr:2}})}),e.jsx(X,{})]}),e.jsx(Y,{open:s,autoHideDuration:6e3,onClose:b,children:e.jsx(Z,{onClose:b,severity:"success",sx:{width:"100%"},children:"User ID copied to clipboard!"})})]})]})},se=()=>{const i=v();return e.jsx(h,{variant:"contained",color:"primary",onClick:()=>i("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},te=({materialId:i,open:t,onClose:s,onDelete:o})=>{const d=k(),c=async()=>{const x=L(d,"materials",i);await Q(x),o(),s()};return e.jsxs(W,{open:t,onClose:s,children:[e.jsx(T,{children:"Delete Material"}),e.jsx($,{children:e.jsx(B,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(P,{children:[e.jsx(h,{onClick:s,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:c,color:"secondary",children:"Delete"})]})]})},le=({materialId:i,onClick:t})=>e.jsx(h,{variant:"contained",color:"error",onClick:()=>t(i),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),oe=({materialId:i,open:t,onClose:s,onUnpublish:o})=>{const d=k(),c=async()=>{const x=L(d,"materials",i);await V(x,{published:!1}),o(),s()};return e.jsxs(W,{open:t,onClose:s,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(T,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx($,{children:e.jsx(B,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(P,{children:[e.jsx(h,{onClick:s,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:c,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},re=()=>{const{userDetails:i}=C(),t=k(),[s,o]=r.useState([]),[d,c]=r.useState(!0),[x,b]=r.useState(!1),[j,g]=r.useState(null),[u,S]=r.useState({open:!1,materialId:null}),f=v();r.useEffect(()=>{if(!i)return;const n=i.isAdmin?M(A(t,"materials")):M(A(t,"materials"),ee("published","==",!0)),O=ie(n,q=>{const z=q.docs.map(D=>({id:D.id,...D.data()}));o(z),c(!1)});return()=>O()},[t,i]);const U=n=>{g(n),b(!0)},N=()=>{b(!1),g(null)},H=()=>{o(s.filter(n=>n.id!==j))},_=n=>{S({open:!0,materialId:n})},G=()=>{o(s.map(n=>n.id===u.materialId?{...n,published:!1}:n))},K=()=>{S({open:!1,materialId:null})};if(d)return e.jsx(ne,{});const I=s.filter(n=>!n.published),w=s.filter(n=>n.published);return e.jsxs(a,{sx:{width:"100%"},children:[(i==null?void 0:i.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(a,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#F57F17"},children:"Saved (Unpublished)"})}),e.jsx(y,{container:!0,spacing:3,children:I.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):I.map(n=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(a,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(a,{children:n.author===(i==null?void 0:i.uid)&&e.jsx(m,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>f(`/view-material/${n.id}`),"aria-label":"view",children:e.jsx(E,{})}),e.jsx(l,{variant:"h6",children:n.title||"Untitled"})]}),e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Date: ",n.timestamp.toDate().toLocaleDateString()]}),e.jsx(l,{variant:"body2",color:"textSecondary",children:n.published?"Published":"Unpublished"}),e.jsx(a,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(i==null?void 0:i.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>f(`/edit-material/${n.id}`),"aria-label":"edit",children:e.jsx(R,{})}),e.jsx(p,{onClick:()=>U(n.id),"aria-label":"delete",children:e.jsx(F,{})})]})})]})},n.id))})]}),e.jsx(a,{sx:{backgroundColor:"#C8E6C9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(y,{container:!0,spacing:3,children:w.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):w.map(n=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(a,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(a,{children:n.author===(i==null?void 0:i.uid)&&e.jsx(m,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>f(`/view-material/${n.id}`),"aria-label":"view",children:e.jsx(E,{})}),e.jsx(l,{variant:"h6",children:n.title||"Untitled"})]}),e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Date: ",n.timestamp.toDate().toLocaleDateString()]}),e.jsx(l,{variant:"body2",color:"textSecondary",children:n.published?"Published":"Unpublished"}),e.jsx(a,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(i==null?void 0:i.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>f(`/edit-material/${n.id}`),"aria-label":"edit",children:e.jsx(R,{})}),e.jsx(p,{onClick:()=>U(n.id),"aria-label":"delete",children:e.jsx(F,{})}),e.jsx(le,{materialId:n.id,onClick:_})]})})]})},n.id))}),j&&e.jsx(te,{materialId:j,open:x,onClose:N,onDelete:H}),u.materialId&&e.jsx(oe,{materialId:u.materialId,open:u.open,onClose:K,onUnpublish:G})]})},xe=()=>{const{userDetails:i}=C();return e.jsxs(a,{sx:{flexGrow:1,padding:3},children:[e.jsx(ae,{}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(i==null?void 0:i.isAdmin)&&e.jsx(se,{}),e.jsx(re,{})]})]})};export{xe as default};
