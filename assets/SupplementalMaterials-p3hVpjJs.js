import{U as k,V as S,b as o,j as e,F as n,I as h,T as l,W as g,J as Z,X as ee,S as P,K as G,aI as w,aa as H,ar as L,ab as N,as as _,at as z,az as J,aG as se,aB as ie,aC as F,aE as W,aw as E,aD as ne,aJ as ae,aK as te,aL as C,a4 as p,a5 as T,a6 as $}from"./index-TFSSbGtC.js";import{d as B}from"./Visibility-BZgNNStS.js";const le=()=>{const{userDetails:s}=k(),t=S(),[a,r]=o.useState(!1),[c,d]=o.useState(!1),x=()=>{s!=null&&s.uid?navigator.clipboard.writeText(s.uid).then(()=>{r(!0),d(!0)}).catch(m=>{console.error("Could not copy text: ",m)}):console.error("User details are null or undefined")},b=(m,u)=>{u!=="clickaway"&&r(!1)},j=()=>{t("/")};return e.jsxs(n,{children:[e.jsx(n,{sx:{display:"flex",alignItems:"center"},children:e.jsx(h,{variant:"text",onClick:j,sx:{mr:2},children:"â† Home Page"})}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[(s==null?void 0:s.isAdmin)&&e.jsx(g,{label:"Educator (Admin User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),!(s!=null&&s.isAdmin)&&e.jsx(g,{label:"Student (Regular User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#bbdefb",color:"#1e88e5",mr:1}}),s&&e.jsx(Z,{title:c?"Copied!":"Click to Copy",enterDelay:300,leaveDelay:200,children:e.jsx(g,{label:`User ID: ${s.uid}`,variant:"outlined",onClick:x,sx:{borderRadius:"15px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",mr:2}})}),e.jsx(ee,{})]}),e.jsx(P,{open:a,autoHideDuration:6e3,onClose:b,children:e.jsx(G,{onClose:b,severity:"success",sx:{width:"100%"},children:"User ID copied to clipboard!"})})]})]})},re=()=>{const s=S();return e.jsx(h,{variant:"contained",color:"primary",onClick:()=>s("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},oe=({materialId:s,open:t,onClose:a,onDelete:r})=>{const c=w(),d=async()=>{const x=J(c,"materials",s);await se(x),r(),a()};return e.jsxs(H,{open:t,onClose:a,children:[e.jsx(L,{children:"Delete Material"}),e.jsx(N,{children:e.jsx(_,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(z,{children:[e.jsx(h,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:d,color:"secondary",children:"Delete"})]})]})},de=({materialId:s,onClick:t})=>e.jsx(h,{variant:"contained",color:"error",onClick:()=>t(s),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),ce=({materialId:s,open:t,onClose:a,onUnpublish:r})=>{const c=w(),d=async()=>{const x=J(c,"materials",s);await ie(x,{published:!1}),r(),a()};return e.jsxs(H,{open:t,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(L,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(N,{children:e.jsx(_,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(z,{children:[e.jsx(h,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:d,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},xe=()=>{const{userDetails:s}=k(),t=w(),[a,r]=o.useState([]),[c,d]=o.useState(!0),[x,b]=o.useState(!1),[j,m]=o.useState(null),[u,U]=o.useState({open:!1,materialId:null}),[I,y]=o.useState(null),f=S();o.useEffect(()=>{if(!s)return;const i=s.isAdmin?F(E(t,"materials"),W("timestamp","desc")):F(E(t,"materials"),ne("published","==",!0),W("timestamp","desc")),Q=ae(i,v=>{const Y=v.docs.map(R=>({id:R.id,...R.data()}));r(Y),d(!1)},v=>{console.error(v),y("Failed to fetch materials"),d(!1)});return()=>Q()},[t,s]);const D=i=>{m(i),b(!0)},K=()=>{b(!1),m(null)},O=()=>{r(a.filter(i=>i.id!==j))},q=i=>{U({open:!0,materialId:i})},V=()=>{r(a.map(i=>i.id===u.materialId?{...i,published:!1}:i))},X=()=>{U({open:!1,materialId:null})};if(c)return e.jsx(te,{});const M=a.filter(i=>!i.published),A=a.filter(i=>i.published);return e.jsxs(n,{sx:{width:"100%"},children:[(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#F57F17"},children:"Saved"})}),e.jsx(C,{container:!0,spacing:3,children:M.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):M.map(i=>e.jsx(C,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>f(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(B,{})}),e.jsx(l,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Status: ",i.published?"Published":"Unpublished"]})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>f(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(T,{})}),e.jsx(p,{onClick:()=>D(i.id),"aria-label":"delete",children:e.jsx($,{})})]})})]})},i.id))})]}),e.jsx(n,{sx:{backgroundColor:"#C8E6C9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(C,{container:!0,spacing:3,children:A.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):A.map(i=>e.jsx(C,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>f(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(B,{})}),e.jsx(l,{variant:"h6",sx:{flexGrow:1,maxWidth:"50%",wordWrap:"break-word"},children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Status: ",i.published?"Published":"Unpublished"]})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>f(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(T,{})}),e.jsx(p,{onClick:()=>D(i.id),"aria-label":"delete",children:e.jsx($,{})}),e.jsx(de,{materialId:i.id,onClick:q})]})})]})},i.id))}),j&&e.jsx(oe,{materialId:j,open:x,onClose:K,onDelete:O}),u.materialId&&e.jsx(ce,{materialId:u.materialId,open:u.open,onClose:X,onUnpublish:V}),I&&e.jsx(P,{open:!0,autoHideDuration:6e3,onClose:()=>y(null),children:e.jsx(G,{onClose:()=>y(null),severity:"error",children:I})})]})},pe=()=>{const{userDetails:s}=k();return e.jsxs(n,{sx:{flexGrow:1,padding:3},children:[e.jsx(le,{}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(s==null?void 0:s.isAdmin)&&e.jsx(re,{}),e.jsx(xe,{})]})]})};export{pe as default};
