import{X as v,Y as D,b as d,j as e,K as n,L as h,T as t,Z as g,M as le,$ as te,S as q,N as z,aL as I,ad as O,au as J,ae as K,av as X,aw as Y,aC as Z,aJ as ae,aE as oe,aF as L,aH as H,aG as F,az as G,aM as re,aN as de,H as j,a7 as x,a8 as A,a9 as E}from"./index-CDXmXtA6.js";import{d as M}from"./Visibility-06d6lEnV.js";const ce=()=>{const{userDetails:s}=v(),o=D(),[l,r]=d.useState(!1),[c,a]=d.useState(!1),u=()=>{s!=null&&s.uid?navigator.clipboard.writeText(s.uid).then(()=>{r(!0),a(!0)}).catch(C=>{console.error("Could not copy text: ",C)}):console.error("User details are null or undefined")},m=(C,f)=>{f!=="clickaway"&&r(!1)},p=()=>{o("/")};return e.jsxs(n,{children:[e.jsx(n,{sx:{display:"flex",alignItems:"center"},children:e.jsx(h,{variant:"text",onClick:p,sx:{mr:2},children:"← Home Page"})}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(t,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[(s==null?void 0:s.isAdmin)&&e.jsx(g,{label:"Educator (Admin User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),!(s!=null&&s.isAdmin)&&e.jsx(g,{label:"Student (Regular User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#bbdefb",color:"#1e88e5",mr:1}}),s&&e.jsx(le,{title:c?"Copied!":"Click to Copy",enterDelay:300,leaveDelay:200,children:e.jsx(g,{label:`User ID: ${s.uid}`,variant:"outlined",onClick:u,sx:{borderRadius:"15px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",mr:2}})}),e.jsx(te,{})]}),e.jsx(q,{open:l,autoHideDuration:6e3,onClose:m,children:e.jsx(z,{onClose:m,severity:"success",sx:{width:"100%"},children:"User ID copied to clipboard!"})})]})]})},xe=()=>{const s=D();return e.jsx(h,{variant:"contained",color:"primary",onClick:()=>s("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},he=({materialId:s,open:o,onClose:l,onDelete:r})=>{const c=I(),a=async()=>{const u=Z(c,"materials",s);await ae(u),r(),l()};return e.jsxs(O,{open:o,onClose:l,children:[e.jsx(J,{children:"Delete Material"}),e.jsx(K,{children:e.jsx(X,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(Y,{children:[e.jsx(h,{onClick:l,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:a,color:"secondary",children:"Delete"})]})]})},_=({materialId:s,onClick:o})=>e.jsx(h,{variant:"contained",color:"error",onClick:()=>o(s),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),ue=({materialId:s,open:o,onClose:l,onUnpublish:r})=>{const c=I(),a=async()=>{const u=Z(c,"materials",s);await oe(u,{published:!1}),r(),l()};return e.jsxs(O,{open:o,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(J,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(K,{children:e.jsx(X,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(Y,{children:[e.jsx(h,{onClick:l,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:a,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},pe=({selectedCourse:s,onCourseChange:o})=>{const{userDetails:l}=v(),[r,c]=d.useState(["Public-Source"]);return d.useEffect(()=>{if(l!=null&&l.class){const a=Array.from(new Set(["Public-Source",...l.class]));c(a)}else c(["Public-Source"])},[l]),e.jsx(n,{sx:{display:"flex",gap:2,mb:2},children:r.map(a=>e.jsx(h,{variant:s===a?"contained":"outlined",onClick:()=>o(a),children:a},a))})},be=()=>{const{userDetails:s}=v(),o=I(),[l,r]=d.useState([]),[c,a]=d.useState(!0),[u,m]=d.useState(!1),[p,C]=d.useState("Public-Source"),[f,R]=d.useState(null),[y,U]=d.useState({open:!1,materialId:null}),[W,k]=d.useState(null),b=D();d.useEffect(()=>{if(!s)return;a(!0);const i=s.isAdmin?L(G(o,"materials"),F("course","==",p),H("timestamp","desc")):L(G(o,"materials"),F("course","==",p),F("published","==",!0),H("timestamp","desc")),se=re(i,w=>{const ne=w.docs.map(B=>({id:B.id,...B.data()}));r(ne),a(!1)},w=>{console.error(w),k("Failed to fetch materials"),a(!1)});return()=>se()},[o,s,p]);const S=i=>{R(i),m(!0)},Q=()=>{m(!1),R(null)},V=()=>{r(l.filter(i=>i.id!==f))},T=i=>{U({open:!0,materialId:i})},ee=()=>{r(l.map(i=>i.id===y.materialId?{...i,published:!1}:i))},ie=()=>{U({open:!1,materialId:null})};if(c)return e.jsx(de,{});const P=l.filter(i=>!i.published&&!i.scheduledTimestamp),N=l.filter(i=>i.scheduledTimestamp&&!i.published),$=l.filter(i=>i.published);return e.jsxs(n,{sx:{width:"100%"},children:[e.jsx(pe,{selectedCourse:p,onCourseChange:i=>{a(!0),C(i)}}),(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#F57C00"},children:"Saved"})}),e.jsx(j,{container:!0,spacing:3,children:P.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):P.map(i=>e.jsx(j,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#FFF9C4"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>b(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(M,{})}),e.jsx(t,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Saved"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>b(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(A,{})}),e.jsx(x,{onClick:()=>S(i.id),"aria-label":"delete",children:e.jsx(E,{})})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),e.jsx(n,{sx:{backgroundColor:"#E3F2FD",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#0D47A1"},children:"Publish Scheduled"})}),e.jsx(j,{container:!0,spacing:3,children:N.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No materials scheduled for publishing found."}):N.map(i=>e.jsx(j,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E3F2FD"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>b(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(M,{})}),e.jsx(t,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Scheduled for Publishing"})]}),i.scheduledTimestamp&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(n,{sx:{backgroundColor:"#E3F2FD",border:"1px solid #90CAF9",borderRadius:"16px",padding:"4px 8px"},children:e.jsxs(t,{variant:"body2",sx:{color:"#0D47A1",fontWeight:"bold"},children:["Publish Date: ",i.scheduledTimestamp.toDate().toLocaleString()]})})}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>b(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(A,{})}),e.jsx(x,{onClick:()=>S(i.id),"aria-label":"delete",children:e.jsx(E,{})}),e.jsx(_,{materialId:i.id,onClick:T})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))})]}),e.jsx(n,{sx:{backgroundColor:"#E8F5E9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(j,{container:!0,spacing:3,children:$.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):$.map(i=>e.jsx(j,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E8F5E9"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>b(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(M,{})}),e.jsx(t,{variant:"h6",sx:{flexGrow:1,maxWidth:"50%",wordWrap:"break-word"},children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Published"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>b(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(A,{})}),e.jsx(x,{onClick:()=>S(i.id),"aria-label":"delete",children:e.jsx(E,{})}),e.jsx(_,{materialId:i.id,onClick:T})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),f&&e.jsx(he,{materialId:f,open:u,onClose:Q,onDelete:V}),y.materialId&&e.jsx(ue,{materialId:y.materialId,open:y.open,onClose:ie,onUnpublish:ee}),W&&e.jsx(q,{open:!0,autoHideDuration:6e3,onClose:()=>k(null),children:e.jsx(z,{onClose:()=>k(null),severity:"error",children:W})})]})},me=()=>{const{userDetails:s}=v();return e.jsxs(n,{sx:{flexGrow:1,padding:3},children:[e.jsx(ce,{}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(s==null?void 0:s.isAdmin)&&e.jsx(xe,{}),e.jsx(be,{})]})]})};export{me as default};
