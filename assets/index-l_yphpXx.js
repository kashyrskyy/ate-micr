import{s as Qr,_ as Ln,e as $,u as Xr,f as Zr,L as Kr,j as a,h as Jr,i as es,E as ts,H as ns,B as cn,p as Be,T as rs,I as ss,P as is,J as as,K as os,M as _n,N as Le,O as ls,q as mn,Q as Xe,R as vr,U as qt,V as zn,W as an,X as cs,k as ht,l as mt,Y as Tt,Z as At,t as St,A as wt,$ as jt,a0 as It,a1 as yr,a2 as Tr,a3 as dn,a4 as ds,a5 as tr,a6 as gn,a7 as _t,a8 as us,a9 as fs,aa as hs,ab as ms,ac as pn,ad as gs,ae as Pn,af as Qt,ag as kt,ah as Xt,ai as Ut,aj as Vt,ak as $n,al as Ne,am as oe,an as ut,ao as De,ap as ps,aq as En,ar as We,as as _e,at as rt,au as ft,av as Dt,aw as bs}from"./index-BvbHlgd-.js";import{d as jn}from"./Visibility-BgIulHAm.js";const xs=["className"],vs=h=>{const{alignItems:v,classes:F}=h;return es({root:["root",v==="flex-start"&&"alignItemsFlexStart"]},ts,F)},ys=Qr("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(h,v)=>{const{ownerState:F}=h;return[v.root,F.alignItems==="flex-start"&&v.alignItemsFlexStart]}})(({theme:h,ownerState:v})=>Ln({minWidth:56,color:(h.vars||h).palette.action.active,flexShrink:0,display:"inline-flex"},v.alignItems==="flex-start"&&{marginTop:8})),Ts=$.forwardRef(function(v,F){const c=Xr({props:v,name:"MuiListItemIcon"}),{className:e}=c,t=Zr(c,xs),d=$.useContext(Kr),i=Ln({},c,{alignItems:d.alignItems}),y=vs(i);return a.jsx(ys,Ln({className:Jr(y.root,e),ownerState:i,ref:F},t))}),As=$.memo(({setIsAdding:h})=>{console.log("Header loaded");const v=ns(),F=()=>{v("/")};return a.jsxs(cn,{className:"lab-notebook-container",children:[a.jsx(cn,{sx:{display:"flex",alignItems:"center"},children:a.jsx(Be,{variant:"text",onClick:F,className:"back-home-button",children:"← Home Page"})}),a.jsx(rs,{className:"webpage_title",children:"My Laboratory Notebook"}),a.jsx(cn,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:a.jsx(Be,{className:"create-new-button",variant:"contained",color:"primary",onClick:()=>h(!0),children:"+ Create New"})})]})}),In=({designs:h,handleEdit:v,handleDelete:F,isAdmin:c,userDetails:e,showUserIdColumn:t})=>{const d=i=>i?i instanceof zn?i.toDate().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):i instanceof Date?i.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A":"N/A";return a.jsx(ss,{component:is,children:a.jsxs(as,{sx:{"& .MuiTableCell-root":{fontSize:"1rem"},"& .MuiTableCell-head":{fontSize:"1.2rem",backgroundColor:"#1A76D3",color:"white"}},children:[a.jsx(os,{children:a.jsxs(_n,{sx:{height:"60px"},children:[a.jsx(Le,{sx:{fontWeight:"bold",width:t?"30%":"40%"},children:"Title"}),a.jsx(Le,{sx:{fontWeight:"bold",width:"20%"},children:"Course"}),t&&a.jsx(Le,{sx:{fontWeight:"bold",width:"20%"},children:"User ID"}),a.jsx(Le,{sx:{fontWeight:"bold",width:"15%"},children:"Created"}),a.jsx(Le,{sx:{fontWeight:"bold",width:"15%"},children:"Last Edited"}),a.jsx(Le,{sx:{fontWeight:"bold",width:"10%"},children:"Edit"}),a.jsx(Le,{sx:{fontWeight:"bold",width:"10%"},children:"Delete"})]})}),a.jsx(ls,{children:h&&h.length>0?h.map(i=>{const y=i.userId===(e==null?void 0:e.uid);return a.jsxs(_n,{sx:{height:"80px"},children:[a.jsx(Le,{children:a.jsx("button",{onClick:()=>v(i.id),className:"hyperlink-style",children:i.title})}),a.jsx(Le,{children:i.course||"N/A"}),t&&a.jsx(Le,{children:i.userId}),a.jsx(Le,{children:d(i.dateCreated)}),a.jsx(Le,{children:d(i.dateModified)}),a.jsx(Le,{children:a.jsx(mn,{title:"Edit",children:a.jsx("span",{children:a.jsx(Xe,{onClick:()=>y&&v(i.id),color:"primary",disabled:!y,children:a.jsx(vr,{})})})})}),a.jsx(Le,{children:a.jsx(mn,{title:"Delete",children:a.jsx("span",{children:a.jsx(Xe,{onClick:()=>y&&F(i.id),color:"error",disabled:!y,children:a.jsx(qt,{})})})})})]},i.id)}):a.jsx(_n,{children:a.jsx(Le,{colSpan:t?6:5,children:"No Designs Found"})})})]})})};function Ss(h,v){return v.forEach(function(F){F&&typeof F!="string"&&!Array.isArray(F)&&Object.keys(F).forEach(function(c){if(c!=="default"&&!(c in h)){var e=Object.getOwnPropertyDescriptor(F,c);Object.defineProperty(h,c,e.get?e:{enumerable:!0,get:function(){return F[c]}})}})}),Object.freeze(h)}function Ar(h,v){return new Promise(function(F,c){let e;return ws(h).then(function(t){try{return e=t,F(new Blob([v.slice(0,2),e,v.slice(2)],{type:"image/jpeg"}))}catch(d){return c(d)}},c)})}const ws=h=>new Promise((v,F)=>{const c=new FileReader;c.addEventListener("load",({target:{result:e}})=>{const t=new DataView(e);let d=0;if(t.getUint16(d)!==65496)return F("not a valid JPEG");for(d+=2;;){const i=t.getUint16(d);if(i===65498)break;const y=t.getUint16(d+2);if(i===65505&&t.getUint32(d+4)===1165519206){const w=d+10;let n;switch(t.getUint16(w)){case 18761:n=!0;break;case 19789:n=!1;break;default:return F("TIFF header contains invalid endian")}if(t.getUint16(w+2,n)!==42)return F("TIFF header contains invalid version");const s=t.getUint32(w+4,n),r=w+s+2+12*t.getUint16(w+s,n);for(let l=w+s+2;l<r;l+=12)if(t.getUint16(l,n)==274){if(t.getUint16(l+2,n)!==3)return F("Orientation data type is invalid");if(t.getUint32(l+4,n)!==1)return F("Orientation data count is invalid");t.setUint16(l+8,1,n);break}return v(e.slice(d,d+2+y))}d+=2+y}return v(new Blob)}),c.readAsArrayBuffer(h)});var bn={},Cs={get exports(){return bn},set exports(h){bn=h}};(function(h){var v,F,c={};Cs.exports=c,c.parse=function(e,t){for(var d=c.bin.readUshort,i=c.bin.readUint,y=0,w={},n=new Uint8Array(e),s=n.length-4;i(n,s)!=101010256;)s--;y=s,y+=4;var r=d(n,y+=4);d(n,y+=2);var l=i(n,y+=2),p=i(n,y+=4);y+=4,y=p;for(var I=0;I<r;I++){i(n,y),y+=4,y+=4,y+=4,i(n,y+=4),l=i(n,y+=4);var k=i(n,y+=4),C=d(n,y+=4),z=d(n,y+2),B=d(n,y+4);y+=6;var R=i(n,y+=8);y+=4,y+=C+z+B,c._readLocal(n,R,w,l,k,t)}return w},c._readLocal=function(e,t,d,i,y,w){var n=c.bin.readUshort,s=c.bin.readUint;s(e,t),n(e,t+=4),n(e,t+=2);var r=n(e,t+=2);s(e,t+=2),s(e,t+=4),t+=4;var l=n(e,t+=8),p=n(e,t+=2);t+=2;var I=c.bin.readUTF8(e,t,l);if(t+=l,t+=p,w)d[I]={size:y,csize:i};else{var k=new Uint8Array(e.buffer,t);if(r==0)d[I]=new Uint8Array(k.buffer.slice(t,t+i));else{if(r!=8)throw"unknown compression method: "+r;var C=new Uint8Array(y);c.inflateRaw(k,C),d[I]=C}}},c.inflateRaw=function(e,t){return c.F.inflate(e,t)},c.inflate=function(e,t){return e[0],e[1],c.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},c.deflate=function(e,t){t==null&&(t={level:6});var d=0,i=new Uint8Array(50+Math.floor(1.1*e.length));i[d]=120,i[d+1]=156,d+=2,d=c.F.deflateRaw(e,i,d,t.level);var y=c.adler(e,0,e.length);return i[d+0]=y>>>24&255,i[d+1]=y>>>16&255,i[d+2]=y>>>8&255,i[d+3]=y>>>0&255,new Uint8Array(i.buffer,0,d+4)},c.deflateRaw=function(e,t){t==null&&(t={level:6});var d=new Uint8Array(50+Math.floor(1.1*e.length)),i=c.F.deflateRaw(e,d,i,t.level);return new Uint8Array(d.buffer,0,i)},c.encode=function(e,t){t==null&&(t=!1);var d=0,i=c.bin.writeUint,y=c.bin.writeUshort,w={};for(var n in e){var s=!c._noNeed(n)&&!t,r=e[n],l=c.crc.crc(r,0,r.length);w[n]={cpr:s,usize:r.length,crc:l,file:s?c.deflateRaw(r):r}}for(var n in w)d+=w[n].file.length+30+46+2*c.bin.sizeUTF8(n);d+=22;var p=new Uint8Array(d),I=0,k=[];for(var n in w){var C=w[n];k.push(I),I=c._writeHeader(p,I,n,C,0)}var z=0,B=I;for(var n in w)C=w[n],k.push(I),I=c._writeHeader(p,I,n,C,1,k[z++]);var R=I-B;return i(p,I,101010256),I+=4,y(p,I+=4,z),y(p,I+=2,z),i(p,I+=2,R),i(p,I+=4,B),I+=4,I+=2,p.buffer},c._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},c._writeHeader=function(e,t,d,i,y,w){var n=c.bin.writeUint,s=c.bin.writeUshort,r=i.file;return n(e,t,y==0?67324752:33639248),t+=4,y==1&&(t+=2),s(e,t,20),s(e,t+=2,0),s(e,t+=2,i.cpr?8:0),n(e,t+=2,0),n(e,t+=4,i.crc),n(e,t+=4,r.length),n(e,t+=4,i.usize),s(e,t+=4,c.bin.sizeUTF8(d)),s(e,t+=2,0),t+=2,y==1&&(t+=2,t+=2,n(e,t+=6,w),t+=4),t+=c.bin.writeUTF8(e,t,d),y==0&&(e.set(r,t),t+=r.length),t},c.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var d=t,i=0;i<8;i++)1&d?d=3988292384^d>>>1:d>>>=1;e[t]=d}return e}(),update:function(e,t,d,i){for(var y=0;y<i;y++)e=c.crc.table[255&(e^t[d+y])]^e>>>8;return e},crc:function(e,t,d){return 4294967295^c.crc.update(4294967295,e,t,d)}},c.adler=function(e,t,d){for(var i=1,y=0,w=t,n=t+d;w<n;){for(var s=Math.min(w+5552,n);w<s;)y+=i+=e[w++];i%=65521,y%=65521}return y<<16|i},c.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,d){e[t]=255&d,e[t+1]=d>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,d){e[t]=255&d,e[t+1]=d>>8&255,e[t+2]=d>>16&255,e[t+3]=d>>24&255},readASCII:function(e,t,d){for(var i="",y=0;y<d;y++)i+=String.fromCharCode(e[t+y]);return i},writeASCII:function(e,t,d){for(var i=0;i<d.length;i++)e[t+i]=d.charCodeAt(i)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,d){for(var i,y="",w=0;w<d;w++)y+="%"+c.bin.pad(e[t+w].toString(16));try{i=decodeURIComponent(y)}catch{return c.bin.readASCII(e,t,d)}return i},writeUTF8:function(e,t,d){for(var i=d.length,y=0,w=0;w<i;w++){var n=d.charCodeAt(w);if(!(4294967168&n))e[t+y]=n,y++;else if(!(4294965248&n))e[t+y]=192|n>>6,e[t+y+1]=128|n>>0&63,y+=2;else if(!(4294901760&n))e[t+y]=224|n>>12,e[t+y+1]=128|n>>6&63,e[t+y+2]=128|n>>0&63,y+=3;else{if(4292870144&n)throw"e";e[t+y]=240|n>>18,e[t+y+1]=128|n>>12&63,e[t+y+2]=128|n>>6&63,e[t+y+3]=128|n>>0&63,y+=4}}return y},sizeUTF8:function(e){for(var t=e.length,d=0,i=0;i<t;i++){var y=e.charCodeAt(i);if(!(4294967168&y))d++;else if(!(4294965248&y))d+=2;else if(!(4294901760&y))d+=3;else{if(4292870144&y)throw"e";d+=4}}return d}},c.F={},c.F.deflateRaw=function(e,t,d,i){var y=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][i],w=c.F.U,n=c.F._goodIndex;c.F._hash;var s=c.F._putsE,r=0,l=d<<3,p=0,I=e.length;if(i==0){for(;r<I;)s(t,l,r+(A=Math.min(65535,I-r))==I?1:0),l=c.F._copyExact(e,r,A,t,l+8),r+=A;return l>>>3}var k=w.lits,C=w.strt,z=w.prev,B=0,R=0,H=0,b=0,M=0,f=0;for(I>2&&(C[f=c.F._hash(e,0)]=0),r=0;r<I;r++){if(M=f,r+1<I-2){f=c.F._hash(e,r+1);var u=r+1&32767;z[u]=C[f],C[f]=u}if(p<=r){(B>14e3||R>26697)&&I-r>100&&(p<r&&(k[B]=r-p,B+=2,p=r),l=c.F._writeBlock(r==I-1||p==I?1:0,k,B,b,e,H,r-H,t,l),B=R=b=0,H=r);var x=0;r<I-2&&(x=c.F._bestMatch(e,r,z,M,Math.min(y[2],I-r),y[3]));var A=x>>>16,S=65535&x;if(x!=0){S=65535&x;var E=n(A=x>>>16,w.of0);w.lhst[257+E]++;var T=n(S,w.df0);w.dhst[T]++,b+=w.exb[E]+w.dxb[T],k[B]=A<<23|r-p,k[B+1]=S<<16|E<<8|T,B+=2,p=r+A}else w.lhst[e[r]]++;R++}}for(H==r&&e.length!=0||(p<r&&(k[B]=r-p,B+=2,p=r),l=c.F._writeBlock(1,k,B,b,e,H,r-H,t,l),B=0,R=0,B=R=b=0,H=r);7&l;)l++;return l>>>3},c.F._bestMatch=function(e,t,d,i,y,w){var n=32767&t,s=d[n],r=n-s+32768&32767;if(s==n||i!=c.F._hash(e,t-r))return 0;for(var l=0,p=0,I=Math.min(32767,t);r<=I&&--w!=0&&s!=n;){if(l==0||e[t+l]==e[t+l-r]){var k=c.F._howLong(e,t,r);if(k>l){if(p=r,(l=k)>=y)break;r+2<k&&(k=r+2);for(var C=0,z=0;z<k-2;z++){var B=t-r+z+32768&32767,R=B-d[B]+32768&32767;R>C&&(C=R,s=B)}}}r+=(n=s)-(s=d[n])+32768&32767}return l<<16|p},c.F._howLong=function(e,t,d){if(e[t]!=e[t-d]||e[t+1]!=e[t+1-d]||e[t+2]!=e[t+2-d])return 0;var i=t,y=Math.min(e.length,t+258);for(t+=3;t<y&&e[t]==e[t-d];)t++;return t-i},c.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},c.saved=0,c.F._writeBlock=function(e,t,d,i,y,w,n,s,r){var l,p,I,k,C,z,B,R,H,b=c.F.U,M=c.F._putsF,f=c.F._putsE;b.lhst[256]++,p=(l=c.F.getTrees())[0],I=l[1],k=l[2],C=l[3],z=l[4],B=l[5],R=l[6],H=l[7];var u=32+(r+3&7?8-(r+3&7):0)+(n<<3),x=i+c.F.contSize(b.fltree,b.lhst)+c.F.contSize(b.fdtree,b.dhst),A=i+c.F.contSize(b.ltree,b.lhst)+c.F.contSize(b.dtree,b.dhst);A+=14+3*B+c.F.contSize(b.itree,b.ihst)+(2*b.ihst[16]+3*b.ihst[17]+7*b.ihst[18]);for(var S=0;S<286;S++)b.lhst[S]=0;for(S=0;S<30;S++)b.dhst[S]=0;for(S=0;S<19;S++)b.ihst[S]=0;var E=u<x&&u<A?0:x<A?1:2;if(M(s,r,e),M(s,r+1,E),r+=3,E==0){for(;7&r;)r++;r=c.F._copyExact(y,w,n,s,r)}else{var T,_;if(E==1&&(T=b.fltree,_=b.fdtree),E==2){c.F.makeCodes(b.ltree,p),c.F.revCodes(b.ltree,p),c.F.makeCodes(b.dtree,I),c.F.revCodes(b.dtree,I),c.F.makeCodes(b.itree,k),c.F.revCodes(b.itree,k),T=b.ltree,_=b.dtree,f(s,r,C-257),f(s,r+=5,z-1),f(s,r+=5,B-4),r+=4;for(var m=0;m<B;m++)f(s,r+3*m,b.itree[1+(b.ordr[m]<<1)]);r+=3*B,r=c.F._codeTiny(R,b.itree,s,r),r=c.F._codeTiny(H,b.itree,s,r)}for(var o=w,N=0;N<d;N+=2){for(var D=t[N],P=D>>>23,G=o+(8388607&D);o<G;)r=c.F._writeLit(y[o++],T,s,r);if(P!=0){var W=t[N+1],q=W>>16,V=W>>8&255,L=255&W;f(s,r=c.F._writeLit(257+V,T,s,r),P-b.of0[V]),r+=b.exb[V],M(s,r=c.F._writeLit(L,_,s,r),q-b.df0[L]),r+=b.dxb[L],o+=P}}r=c.F._writeLit(256,T,s,r)}return r},c.F._copyExact=function(e,t,d,i,y){var w=y>>>3;return i[w]=d,i[w+1]=d>>>8,i[w+2]=255-i[w],i[w+3]=255-i[w+1],w+=4,i.set(new Uint8Array(e.buffer,t,d),w),y+(d+4<<3)},c.F.getTrees=function(){for(var e=c.F.U,t=c.F._hufTree(e.lhst,e.ltree,15),d=c.F._hufTree(e.dhst,e.dtree,15),i=[],y=c.F._lenCodes(e.ltree,i),w=[],n=c.F._lenCodes(e.dtree,w),s=0;s<i.length;s+=2)e.ihst[i[s]]++;for(s=0;s<w.length;s+=2)e.ihst[w[s]]++;for(var r=c.F._hufTree(e.ihst,e.itree,7),l=19;l>4&&e.itree[1+(e.ordr[l-1]<<1)]==0;)l--;return[t,d,r,y,n,l,i,w]},c.F.getSecond=function(e){for(var t=[],d=0;d<e.length;d+=2)t.push(e[d+1]);return t},c.F.nonZero=function(e){for(var t="",d=0;d<e.length;d+=2)e[d+1]!=0&&(t+=(d>>1)+",");return t},c.F.contSize=function(e,t){for(var d=0,i=0;i<t.length;i++)d+=t[i]*e[1+(i<<1)];return d},c.F._codeTiny=function(e,t,d,i){for(var y=0;y<e.length;y+=2){var w=e[y],n=e[y+1];i=c.F._writeLit(w,t,d,i);var s=w==16?2:w==17?3:7;w>15&&(c.F._putsE(d,i,n,s),i+=s)}return i},c.F._lenCodes=function(e,t){for(var d=e.length;d!=2&&e[d-1]==0;)d-=2;for(var i=0;i<d;i+=2){var y=e[i+1],w=i+3<d?e[i+3]:-1,n=i+5<d?e[i+5]:-1,s=i==0?-1:e[i-1];if(y==0&&w==y&&n==y){for(var r=i+5;r+2<d&&e[r+2]==y;)r+=2;(l=Math.min(r+1-i>>>1,138))<11?t.push(17,l-3):t.push(18,l-11),i+=2*l-2}else if(y==s&&w==y&&n==y){for(r=i+5;r+2<d&&e[r+2]==y;)r+=2;var l=Math.min(r+1-i>>>1,6);t.push(16,l-3),i+=2*l-2}else t.push(y,0)}return d>>>1},c.F._hufTree=function(e,t,d){var i=[],y=e.length,w=t.length,n=0;for(n=0;n<w;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<y;n++)e[n]!=0&&i.push({lit:n,f:e[n]});var s=i.length,r=i.slice(0);if(s==0)return 0;if(s==1){var l=i[0].lit;return r=l==0?1:0,t[1+(l<<1)]=1,t[1+(r<<1)]=1,1}i.sort(function(R,H){return R.f-H.f});var p=i[0],I=i[1],k=0,C=1,z=2;for(i[0]={lit:-1,f:p.f+I.f,l:p,r:I,d:0};C!=s-1;)p=k!=C&&(z==s||i[k].f<i[z].f)?i[k++]:i[z++],I=k!=C&&(z==s||i[k].f<i[z].f)?i[k++]:i[z++],i[C++]={lit:-1,f:p.f+I.f,l:p,r:I};var B=c.F.setDepth(i[C-1],0);for(B>d&&(c.F.restrictDepth(r,d,B),B=d),n=0;n<s;n++)t[1+(r[n].lit<<1)]=r[n].d;return B},c.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(c.F.setDepth(e.l,t+1),c.F.setDepth(e.r,t+1))},c.F.restrictDepth=function(e,t,d){var i=0,y=1<<d-t,w=0;for(e.sort(function(s,r){return r.d==s.d?s.f-r.f:r.d-s.d}),i=0;i<e.length&&e[i].d>t;i++){var n=e[i].d;e[i].d=t,w+=y-(1<<d-n)}for(w>>>=d-t;w>0;)(n=e[i].d)<t?(e[i].d++,w-=1<<t-n-1):i++;for(;i>=0;i--)e[i].d==t&&w<0&&(e[i].d--,w++);w!=0&&console.log("debt left")},c.F._goodIndex=function(e,t){var d=0;return t[16|d]<=e&&(d|=16),t[8|d]<=e&&(d|=8),t[4|d]<=e&&(d|=4),t[2|d]<=e&&(d|=2),t[1|d]<=e&&(d|=1),d},c.F._writeLit=function(e,t,d,i){return c.F._putsF(d,i,t[e<<1]),i+t[1+(e<<1)]},c.F.inflate=function(e,t){var d=Uint8Array;if(e[0]==3&&e[1]==0)return t||new d(0);var i=c.F,y=i._bitsF,w=i._bitsE,n=i._decodeTiny,s=i.makeCodes,r=i.codes2map,l=i._get17,p=i.U,I=t==null;I&&(t=new d(e.length>>>2<<3));for(var k,C,z=0,B=0,R=0,H=0,b=0,M=0,f=0,u=0,x=0;z==0;)if(z=y(e,x,1),B=y(e,x+1,2),x+=3,B!=0){if(I&&(t=c.F._check(t,u+(1<<17))),B==1&&(k=p.flmap,C=p.fdmap,M=511,f=31),B==2){R=w(e,x,5)+257,H=w(e,x+5,5)+1,b=w(e,x+10,4)+4,x+=14;for(var A=0;A<38;A+=2)p.itree[A]=0,p.itree[A+1]=0;var S=1;for(A=0;A<b;A++){var E=w(e,x+3*A,3);p.itree[1+(p.ordr[A]<<1)]=E,E>S&&(S=E)}x+=3*b,s(p.itree,S),r(p.itree,S,p.imap),k=p.lmap,C=p.dmap,x=n(p.imap,(1<<S)-1,R+H,e,x,p.ttree);var T=i._copyOut(p.ttree,0,R,p.ltree);M=(1<<T)-1;var _=i._copyOut(p.ttree,R,H,p.dtree);f=(1<<_)-1,s(p.ltree,T),r(p.ltree,T,k),s(p.dtree,_),r(p.dtree,_,C)}for(;;){var m=k[l(e,x)&M];x+=15&m;var o=m>>>4;if(!(o>>>8))t[u++]=o;else{if(o==256)break;var N=u+o-254;if(o>264){var D=p.ldef[o-257];N=u+(D>>>3)+w(e,x,7&D),x+=7&D}var P=C[l(e,x)&f];x+=15&P;var G=P>>>4,W=p.ddef[G],q=(W>>>4)+y(e,x,15&W);for(x+=15&W,I&&(t=c.F._check(t,u+(1<<17)));u<N;)t[u]=t[u++-q],t[u]=t[u++-q],t[u]=t[u++-q],t[u]=t[u++-q];u=N}}}else{7&x&&(x+=8-(7&x));var V=4+(x>>>3),L=e[V-4]|e[V-3]<<8;I&&(t=c.F._check(t,u+L)),t.set(new d(e.buffer,e.byteOffset+V,L),u),x=V+L<<3,u+=L}return t.length==u?t:t.slice(0,u)},c.F._check=function(e,t){var d=e.length;if(t<=d)return e;var i=new Uint8Array(Math.max(d<<1,t));return i.set(e,0),i},c.F._decodeTiny=function(e,t,d,i,y,w){for(var n=c.F._bitsE,s=c.F._get17,r=0;r<d;){var l=e[s(i,y)&t];y+=15&l;var p=l>>>4;if(p<=15)w[r]=p,r++;else{var I=0,k=0;p==16?(k=3+n(i,y,2),y+=2,I=w[r-1]):p==17?(k=3+n(i,y,3),y+=3):p==18&&(k=11+n(i,y,7),y+=7);for(var C=r+k;r<C;)w[r]=I,r++}}return y},c.F._copyOut=function(e,t,d,i){for(var y=0,w=0,n=i.length>>>1;w<d;){var s=e[w+t];i[w<<1]=0,i[1+(w<<1)]=s,s>y&&(y=s),w++}for(;w<n;)i[w<<1]=0,i[1+(w<<1)]=0,w++;return y},c.F.makeCodes=function(e,t){for(var d,i,y,w,n=c.F.U,s=e.length,r=n.bl_count,l=0;l<=t;l++)r[l]=0;for(l=1;l<s;l+=2)r[e[l]]++;var p=n.next_code;for(d=0,r[0]=0,i=1;i<=t;i++)d=d+r[i-1]<<1,p[i]=d;for(y=0;y<s;y+=2)(w=e[y+1])!=0&&(e[y]=p[w],p[w]++)},c.F.codes2map=function(e,t,d){for(var i=e.length,y=c.F.U.rev15,w=0;w<i;w+=2)if(e[w+1]!=0)for(var n=w>>1,s=e[w+1],r=n<<4|s,l=t-s,p=e[w]<<l,I=p+(1<<l);p!=I;)d[y[p]>>>15-t]=r,p++},c.F.revCodes=function(e,t){for(var d=c.F.U.rev15,i=15-t,y=0;y<e.length;y+=2){var w=e[y]<<t-e[y+1];e[y]=d[w]>>>i}},c.F._putsE=function(e,t,d){d<<=7&t;var i=t>>>3;e[i]|=d,e[i+1]|=d>>>8},c.F._putsF=function(e,t,d){d<<=7&t;var i=t>>>3;e[i]|=d,e[i+1]|=d>>>8,e[i+2]|=d>>>16},c.F._bitsE=function(e,t,d){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<d)-1},c.F._bitsF=function(e,t,d){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<d)-1},c.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},c.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},c.F.U=(v=Uint16Array,F=Uint32Array,{next_code:new v(16),bl_count:new v(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new v(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new F(32),flmap:new v(512),fltree:[],fdmap:new v(32),fdtree:[],lmap:new v(32768),ltree:[],ttree:[],dmap:new v(32768),dtree:[],imap:new v(512),itree:[],rev15:new v(32768),lhst:new F(286),dhst:new F(30),ihst:new F(19),lits:new F(15e3),strt:new v(65536),prev:new v(32768)}),function(){for(var e=c.F.U,t=0;t<32768;t++){var d=t;d=(4278255360&(d=(4042322160&(d=(3435973836&(d=(2863311530&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,e.rev15[t]=(d>>>16|d<<16)>>>17}function i(y,w,n){for(;w--!=0;)y.push(0,n)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];i(e.fltree,144,8),i(e.fltree,112,9),i(e.fltree,24,7),i(e.fltree,8,8),c.F.makeCodes(e.fltree,9),c.F.codes2map(e.fltree,9,e.flmap),c.F.revCodes(e.fltree,9),i(e.fdtree,32,5),c.F.makeCodes(e.fdtree,5),c.F.codes2map(e.fdtree,5,e.fdmap),c.F.revCodes(e.fdtree,5),i(e.itree,19,0),i(e.ltree,286,0),i(e.dtree,30,0),i(e.ttree,320,0)}()})();var _s=Ss({__proto__:null,default:bn},[bn]);const et=function(){var h={nextZero(n,s){for(;n[s]!=0;)s++;return s},readUshort:(n,s)=>n[s]<<8|n[s+1],writeUshort(n,s,r){n[s]=r>>8&255,n[s+1]=255&r},readUint:(n,s)=>16777216*n[s]+(n[s+1]<<16|n[s+2]<<8|n[s+3]),writeUint(n,s,r){n[s]=r>>24&255,n[s+1]=r>>16&255,n[s+2]=r>>8&255,n[s+3]=255&r},readASCII(n,s,r){let l="";for(let p=0;p<r;p++)l+=String.fromCharCode(n[s+p]);return l},writeASCII(n,s,r){for(let l=0;l<r.length;l++)n[s+l]=r.charCodeAt(l)},readBytes(n,s,r){const l=[];for(let p=0;p<r;p++)l.push(n[s+p]);return l},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,s,r){let l,p="";for(let I=0;I<r;I++)p+=`%${h.pad(n[s+I].toString(16))}`;try{l=decodeURIComponent(p)}catch{return h.readASCII(n,s,r)}return l}};function v(n,s,r,l){const p=s*r,I=t(l),k=Math.ceil(s*I/8),C=new Uint8Array(4*p),z=new Uint32Array(C.buffer),{ctype:B}=l,{depth:R}=l,H=h.readUshort;if(B==6){const D=p<<2;if(R==8)for(var b=0;b<D;b+=4)C[b]=n[b],C[b+1]=n[b+1],C[b+2]=n[b+2],C[b+3]=n[b+3];if(R==16)for(b=0;b<D;b++)C[b]=n[b<<1]}else if(B==2){const D=l.tabs.tRNS;if(D==null){if(R==8)for(b=0;b<p;b++){var M=3*b;z[b]=255<<24|n[M+2]<<16|n[M+1]<<8|n[M]}if(R==16)for(b=0;b<p;b++)M=6*b,z[b]=255<<24|n[M+4]<<16|n[M+2]<<8|n[M]}else{var f=D[0];const P=D[1],G=D[2];if(R==8)for(b=0;b<p;b++){var u=b<<2;M=3*b,z[b]=255<<24|n[M+2]<<16|n[M+1]<<8|n[M],n[M]==f&&n[M+1]==P&&n[M+2]==G&&(C[u+3]=0)}if(R==16)for(b=0;b<p;b++)u=b<<2,M=6*b,z[b]=255<<24|n[M+4]<<16|n[M+2]<<8|n[M],H(n,M)==f&&H(n,M+2)==P&&H(n,M+4)==G&&(C[u+3]=0)}}else if(B==3){const D=l.tabs.PLTE,P=l.tabs.tRNS,G=P?P.length:0;if(R==1)for(var x=0;x<r;x++){var A=x*k,S=x*s;for(b=0;b<s;b++){u=S+b<<2;var E=3*(T=n[A+(b>>3)]>>7-((7&b)<<0)&1);C[u]=D[E],C[u+1]=D[E+1],C[u+2]=D[E+2],C[u+3]=T<G?P[T]:255}}if(R==2)for(x=0;x<r;x++)for(A=x*k,S=x*s,b=0;b<s;b++)u=S+b<<2,E=3*(T=n[A+(b>>2)]>>6-((3&b)<<1)&3),C[u]=D[E],C[u+1]=D[E+1],C[u+2]=D[E+2],C[u+3]=T<G?P[T]:255;if(R==4)for(x=0;x<r;x++)for(A=x*k,S=x*s,b=0;b<s;b++)u=S+b<<2,E=3*(T=n[A+(b>>1)]>>4-((1&b)<<2)&15),C[u]=D[E],C[u+1]=D[E+1],C[u+2]=D[E+2],C[u+3]=T<G?P[T]:255;if(R==8)for(b=0;b<p;b++){var T;u=b<<2,E=3*(T=n[b]),C[u]=D[E],C[u+1]=D[E+1],C[u+2]=D[E+2],C[u+3]=T<G?P[T]:255}}else if(B==4){if(R==8)for(b=0;b<p;b++){u=b<<2;var _=n[m=b<<1];C[u]=_,C[u+1]=_,C[u+2]=_,C[u+3]=n[m+1]}if(R==16)for(b=0;b<p;b++){var m;u=b<<2,_=n[m=b<<2],C[u]=_,C[u+1]=_,C[u+2]=_,C[u+3]=n[m+2]}}else if(B==0)for(f=l.tabs.tRNS?l.tabs.tRNS:-1,x=0;x<r;x++){const D=x*k,P=x*s;if(R==1)for(var o=0;o<s;o++){var N=(_=255*(n[D+(o>>>3)]>>>7-(7&o)&1))==255*f?0:255;z[P+o]=N<<24|_<<16|_<<8|_}else if(R==2)for(o=0;o<s;o++)N=(_=85*(n[D+(o>>>2)]>>>6-((3&o)<<1)&3))==85*f?0:255,z[P+o]=N<<24|_<<16|_<<8|_;else if(R==4)for(o=0;o<s;o++)N=(_=17*(n[D+(o>>>1)]>>>4-((1&o)<<2)&15))==17*f?0:255,z[P+o]=N<<24|_<<16|_<<8|_;else if(R==8)for(o=0;o<s;o++)N=(_=n[D+o])==f?0:255,z[P+o]=N<<24|_<<16|_<<8|_;else if(R==16)for(o=0;o<s;o++)_=n[D+(o<<1)],N=H(n,D+(o<<1))==f?0:255,z[P+o]=N<<24|_<<16|_<<8|_}return C}function F(n,s,r,l){const p=t(n),I=Math.ceil(r*p/8),k=new Uint8Array((I+1+n.interlace)*l);return s=n.tabs.CgBI?e(s,k):c(s,k),n.interlace==0?s=d(s,n,0,r,l):n.interlace==1&&(s=function(z,B){const R=B.width,H=B.height,b=t(B),M=b>>3,f=Math.ceil(R*b/8),u=new Uint8Array(H*f);let x=0;const A=[0,0,4,0,2,0,1],S=[0,4,0,2,0,1,0],E=[8,8,8,4,4,2,2],T=[8,8,4,4,2,2,1];let _=0;for(;_<7;){const o=E[_],N=T[_];let D=0,P=0,G=A[_];for(;G<H;)G+=o,P++;let W=S[_];for(;W<R;)W+=N,D++;const q=Math.ceil(D*b/8);d(z,B,x,D,P);let V=0,L=A[_];for(;L<H;){let J=S[_],ue=x+V*q<<3;for(;J<R;){var m;if(b==1&&(m=(m=z[ue>>3])>>7-(7&ue)&1,u[L*f+(J>>3)]|=m<<7-((7&J)<<0)),b==2&&(m=(m=z[ue>>3])>>6-(7&ue)&3,u[L*f+(J>>2)]|=m<<6-((3&J)<<1)),b==4&&(m=(m=z[ue>>3])>>4-(7&ue)&15,u[L*f+(J>>1)]|=m<<4-((1&J)<<2)),b>=8){const ie=L*f+J*M;for(let re=0;re<M;re++)u[ie+re]=z[(ue>>3)+re]}ue+=b,J+=N}V++,L+=o}D*P!=0&&(x+=P*(1+q)),_+=1}return u}(s,n)),s}function c(n,s){return e(new Uint8Array(n.buffer,2,n.length-6),s)}var e=function(){const n={H:{}};return n.H.N=function(s,r){const l=Uint8Array;let p,I,k=0,C=0,z=0,B=0,R=0,H=0,b=0,M=0,f=0;if(s[0]==3&&s[1]==0)return r||new l(0);const u=n.H,x=u.b,A=u.e,S=u.R,E=u.n,T=u.A,_=u.Z,m=u.m,o=r==null;for(o&&(r=new l(s.length>>>2<<5));k==0;)if(k=x(s,f,1),C=x(s,f+1,2),f+=3,C!=0){if(o&&(r=n.H.W(r,M+(1<<17))),C==1&&(p=m.J,I=m.h,H=511,b=31),C==2){z=A(s,f,5)+257,B=A(s,f+5,5)+1,R=A(s,f+10,4)+4,f+=14;let D=1;for(var N=0;N<38;N+=2)m.Q[N]=0,m.Q[N+1]=0;for(N=0;N<R;N++){const W=A(s,f+3*N,3);m.Q[1+(m.X[N]<<1)]=W,W>D&&(D=W)}f+=3*R,E(m.Q,D),T(m.Q,D,m.u),p=m.w,I=m.d,f=S(m.u,(1<<D)-1,z+B,s,f,m.v);const P=u.V(m.v,0,z,m.C);H=(1<<P)-1;const G=u.V(m.v,z,B,m.D);b=(1<<G)-1,E(m.C,P),T(m.C,P,p),E(m.D,G),T(m.D,G,I)}for(;;){const D=p[_(s,f)&H];f+=15&D;const P=D>>>4;if(!(P>>>8))r[M++]=P;else{if(P==256)break;{let G=M+P-254;if(P>264){const J=m.q[P-257];G=M+(J>>>3)+A(s,f,7&J),f+=7&J}const W=I[_(s,f)&b];f+=15&W;const q=W>>>4,V=m.c[q],L=(V>>>4)+x(s,f,15&V);for(f+=15&V;M<G;)r[M]=r[M++-L],r[M]=r[M++-L],r[M]=r[M++-L],r[M]=r[M++-L];M=G}}}}else{7&f&&(f+=8-(7&f));const D=4+(f>>>3),P=s[D-4]|s[D-3]<<8;o&&(r=n.H.W(r,M+P)),r.set(new l(s.buffer,s.byteOffset+D,P),M),f=D+P<<3,M+=P}return r.length==M?r:r.slice(0,M)},n.H.W=function(s,r){const l=s.length;if(r<=l)return s;const p=new Uint8Array(l<<1);return p.set(s,0),p},n.H.R=function(s,r,l,p,I,k){const C=n.H.e,z=n.H.Z;let B=0;for(;B<l;){const R=s[z(p,I)&r];I+=15&R;const H=R>>>4;if(H<=15)k[B]=H,B++;else{let b=0,M=0;H==16?(M=3+C(p,I,2),I+=2,b=k[B-1]):H==17?(M=3+C(p,I,3),I+=3):H==18&&(M=11+C(p,I,7),I+=7);const f=B+M;for(;B<f;)k[B]=b,B++}}return I},n.H.V=function(s,r,l,p){let I=0,k=0;const C=p.length>>>1;for(;k<l;){const z=s[k+r];p[k<<1]=0,p[1+(k<<1)]=z,z>I&&(I=z),k++}for(;k<C;)p[k<<1]=0,p[1+(k<<1)]=0,k++;return I},n.H.n=function(s,r){const l=n.H.m,p=s.length;let I,k,C,z;const B=l.j;for(var R=0;R<=r;R++)B[R]=0;for(R=1;R<p;R+=2)B[s[R]]++;const H=l.K;for(I=0,B[0]=0,k=1;k<=r;k++)I=I+B[k-1]<<1,H[k]=I;for(C=0;C<p;C+=2)z=s[C+1],z!=0&&(s[C]=H[z],H[z]++)},n.H.A=function(s,r,l){const p=s.length,I=n.H.m.r;for(let k=0;k<p;k+=2)if(s[k+1]!=0){const C=k>>1,z=s[k+1],B=C<<4|z,R=r-z;let H=s[k]<<R;const b=H+(1<<R);for(;H!=b;)l[I[H]>>>15-r]=B,H++}},n.H.l=function(s,r){const l=n.H.m.r,p=15-r;for(let I=0;I<s.length;I+=2){const k=s[I]<<r-s[I+1];s[I]=l[k]>>>p}},n.H.M=function(s,r,l){l<<=7&r;const p=r>>>3;s[p]|=l,s[p+1]|=l>>>8},n.H.I=function(s,r,l){l<<=7&r;const p=r>>>3;s[p]|=l,s[p+1]|=l>>>8,s[p+2]|=l>>>16},n.H.e=function(s,r,l){return(s[r>>>3]|s[1+(r>>>3)]<<8)>>>(7&r)&(1<<l)-1},n.H.b=function(s,r,l){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16)>>>(7&r)&(1<<l)-1},n.H.Z=function(s,r){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(s,r){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16|s[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=function(){const s=Uint16Array,r=Uint32Array;return{K:new s(16),j:new s(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new s(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new s(512),_:[],h:new s(32),$:[],w:new s(32768),C:[],v:[],d:new s(32768),D:[],u:new s(512),Q:[],r:new s(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new s(65536),g:new s(32768)}}(),function(){const s=n.H.m;for(var r=0;r<32768;r++){let p=r;p=(2863311530&p)>>>1|(1431655765&p)<<1,p=(3435973836&p)>>>2|(858993459&p)<<2,p=(4042322160&p)>>>4|(252645135&p)<<4,p=(4278255360&p)>>>8|(16711935&p)<<8,s.r[r]=(p>>>16|p<<16)>>>17}function l(p,I,k){for(;I--!=0;)p.push(0,k)}for(r=0;r<32;r++)s.q[r]=s.S[r]<<3|s.T[r],s.c[r]=s.p[r]<<4|s.z[r];l(s._,144,8),l(s._,112,9),l(s._,24,7),l(s._,8,8),n.H.n(s._,9),n.H.A(s._,9,s.J),n.H.l(s._,9),l(s.$,32,5),n.H.n(s.$,5),n.H.A(s.$,5,s.h),n.H.l(s.$,5),l(s.Q,19,0),l(s.C,286,0),l(s.D,30,0),l(s.v,320,0)}(),n.H.N}();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function d(n,s,r,l,p){let I=t(s);const k=Math.ceil(l*I/8);let C,z;I=Math.ceil(I/8);let B=n[r],R=0;if(B>1&&(n[r]=[0,0,1][B-2]),B==3)for(R=I;R<k;R++)n[R+1]=n[R+1]+(n[R+1-I]>>>1)&255;for(let H=0;H<p;H++)if(C=r+H*k,z=C+H+1,B=n[z-1],R=0,B==0)for(;R<k;R++)n[C+R]=n[z+R];else if(B==1){for(;R<I;R++)n[C+R]=n[z+R];for(;R<k;R++)n[C+R]=n[z+R]+n[C+R-I]}else if(B==2)for(;R<k;R++)n[C+R]=n[z+R]+n[C+R-k];else if(B==3){for(;R<I;R++)n[C+R]=n[z+R]+(n[C+R-k]>>>1);for(;R<k;R++)n[C+R]=n[z+R]+(n[C+R-k]+n[C+R-I]>>>1)}else{for(;R<I;R++)n[C+R]=n[z+R]+i(0,n[C+R-k],0);for(;R<k;R++)n[C+R]=n[z+R]+i(n[C+R-I],n[C+R-k],n[C+R-I-k])}return n}function i(n,s,r){const l=n+s-r,p=l-n,I=l-s,k=l-r;return p*p<=I*I&&p*p<=k*k?n:I*I<=k*k?s:r}function y(n,s,r){r.width=h.readUint(n,s),s+=4,r.height=h.readUint(n,s),s+=4,r.depth=n[s],s++,r.ctype=n[s],s++,r.compress=n[s],s++,r.filter=n[s],s++,r.interlace=n[s],s++}function w(n,s,r,l,p,I,k,C,z){const B=Math.min(s,p),R=Math.min(r,I);let H=0,b=0;for(let _=0;_<R;_++)for(let m=0;m<B;m++)if(k>=0&&C>=0?(H=_*s+m<<2,b=(C+_)*p+k+m<<2):(H=(-C+_)*s-k+m<<2,b=_*p+m<<2),z==0)l[b]=n[H],l[b+1]=n[H+1],l[b+2]=n[H+2],l[b+3]=n[H+3];else if(z==1){var M=n[H+3]*.00392156862745098,f=n[H]*M,u=n[H+1]*M,x=n[H+2]*M,A=l[b+3]*(1/255),S=l[b]*A,E=l[b+1]*A,T=l[b+2]*A;const o=1-M,N=M+A*o,D=N==0?0:1/N;l[b+3]=255*N,l[b+0]=(f+S*o)*D,l[b+1]=(u+E*o)*D,l[b+2]=(x+T*o)*D}else if(z==2)M=n[H+3],f=n[H],u=n[H+1],x=n[H+2],A=l[b+3],S=l[b],E=l[b+1],T=l[b+2],M==A&&f==S&&u==E&&x==T?(l[b]=0,l[b+1]=0,l[b+2]=0,l[b+3]=0):(l[b]=f,l[b+1]=u,l[b+2]=x,l[b+3]=M);else if(z==3){if(M=n[H+3],f=n[H],u=n[H+1],x=n[H+2],A=l[b+3],S=l[b],E=l[b+1],T=l[b+2],M==A&&f==S&&u==E&&x==T)continue;if(M<220&&A>20)return!1}return!0}return{decode:function(s){const r=new Uint8Array(s);let l=8;const p=h,I=p.readUshort,k=p.readUint,C={tabs:{},frames:[]},z=new Uint8Array(r.length);let B,R=0,H=0;const b=[137,80,78,71,13,10,26,10];for(var M=0;M<8;M++)if(r[M]!=b[M])throw"The input is not a PNG file!";for(;l<r.length;){const _=p.readUint(r,l);l+=4;const m=p.readASCII(r,l,4);if(l+=4,m=="IHDR")y(r,l,C);else if(m=="iCCP"){for(var f=l;r[f]!=0;)f++;p.readASCII(r,l,f-l),r[f+1];const o=r.slice(f+2,l+_);let N=null;try{N=c(o)}catch{N=e(o)}C.tabs[m]=N}else if(m=="CgBI")C.tabs[m]=r.slice(l,l+4);else if(m=="IDAT"){for(M=0;M<_;M++)z[R+M]=r[l+M];R+=_}else if(m=="acTL")C.tabs[m]={num_frames:k(r,l),num_plays:k(r,l+4)},B=new Uint8Array(r.length);else if(m=="fcTL"){H!=0&&((T=C.frames[C.frames.length-1]).data=F(C,B.slice(0,H),T.rect.width,T.rect.height),H=0);const o={x:k(r,l+12),y:k(r,l+16),width:k(r,l+4),height:k(r,l+8)};let N=I(r,l+22);N=I(r,l+20)/(N==0?100:N);const D={rect:o,delay:Math.round(1e3*N),dispose:r[l+24],blend:r[l+25]};C.frames.push(D)}else if(m=="fdAT"){for(M=0;M<_-4;M++)B[H+M]=r[l+M+4];H+=_-4}else if(m=="pHYs")C.tabs[m]=[p.readUint(r,l),p.readUint(r,l+4),r[l+8]];else if(m=="cHRM")for(C.tabs[m]=[],M=0;M<8;M++)C.tabs[m].push(p.readUint(r,l+4*M));else if(m=="tEXt"||m=="zTXt"){C.tabs[m]==null&&(C.tabs[m]={});var u=p.nextZero(r,l),x=p.readASCII(r,l,u-l),A=l+_-u-1;if(m=="tEXt")E=p.readASCII(r,u+1,A);else{var S=c(r.slice(u+2,u+2+A));E=p.readUTF8(S,0,S.length)}C.tabs[m][x]=E}else if(m=="iTXt"){C.tabs[m]==null&&(C.tabs[m]={}),u=0,f=l,u=p.nextZero(r,f),x=p.readASCII(r,f,u-f);const o=r[f=u+1];var E;r[f+1],f+=2,u=p.nextZero(r,f),p.readASCII(r,f,u-f),f=u+1,u=p.nextZero(r,f),p.readUTF8(r,f,u-f),A=_-((f=u+1)-l),o==0?E=p.readUTF8(r,f,A):(S=c(r.slice(f,f+A)),E=p.readUTF8(S,0,S.length)),C.tabs[m][x]=E}else if(m=="PLTE")C.tabs[m]=p.readBytes(r,l,_);else if(m=="hIST"){const o=C.tabs.PLTE.length/3;for(C.tabs[m]=[],M=0;M<o;M++)C.tabs[m].push(I(r,l+2*M))}else if(m=="tRNS")C.ctype==3?C.tabs[m]=p.readBytes(r,l,_):C.ctype==0?C.tabs[m]=I(r,l):C.ctype==2&&(C.tabs[m]=[I(r,l),I(r,l+2),I(r,l+4)]);else if(m=="gAMA")C.tabs[m]=p.readUint(r,l)/1e5;else if(m=="sRGB")C.tabs[m]=r[l];else if(m=="bKGD")C.ctype==0||C.ctype==4?C.tabs[m]=[I(r,l)]:C.ctype==2||C.ctype==6?C.tabs[m]=[I(r,l),I(r,l+2),I(r,l+4)]:C.ctype==3&&(C.tabs[m]=r[l]);else if(m=="IEND")break;l+=_,p.readUint(r,l),l+=4}var T;return H!=0&&((T=C.frames[C.frames.length-1]).data=F(C,B.slice(0,H),T.rect.width,T.rect.height)),C.data=F(C,z,C.width,C.height),delete C.compress,delete C.interlace,delete C.filter,C},toRGBA8:function(s){const r=s.width,l=s.height;if(s.tabs.acTL==null)return[v(s.data,r,l,s).buffer];const p=[];s.frames[0].data==null&&(s.frames[0].data=s.data);const I=r*l*4,k=new Uint8Array(I),C=new Uint8Array(I),z=new Uint8Array(I);for(let R=0;R<s.frames.length;R++){const H=s.frames[R],b=H.rect.x,M=H.rect.y,f=H.rect.width,u=H.rect.height,x=v(H.data,f,u,s);if(R!=0)for(var B=0;B<I;B++)z[B]=k[B];if(H.blend==0?w(x,f,u,k,r,l,b,M,0):H.blend==1&&w(x,f,u,k,r,l,b,M,1),p.push(k.buffer.slice(0)),H.dispose!=0){if(H.dispose==1)w(C,f,u,k,r,l,b,M,0);else if(H.dispose==2)for(B=0;B<I;B++)k[B]=z[B]}}return p},_paeth:i,_copyTile:w,_bin:h}}();(function(){const{_copyTile:h}=et,{_bin:v}=et,F=et._paeth;var c={table:function(){const f=new Uint32Array(256);for(let u=0;u<256;u++){let x=u;for(let A=0;A<8;A++)1&x?x=3988292384^x>>>1:x>>>=1;f[u]=x}return f}(),update(f,u,x,A){for(let S=0;S<A;S++)f=c.table[255&(f^u[x+S])]^f>>>8;return f},crc:(f,u,x)=>4294967295^c.update(4294967295,f,u,x)};function e(f,u,x,A){u[x]+=f[0]*A>>4,u[x+1]+=f[1]*A>>4,u[x+2]+=f[2]*A>>4,u[x+3]+=f[3]*A>>4}function t(f){return Math.max(0,Math.min(255,f))}function d(f,u){const x=f[0]-u[0],A=f[1]-u[1],S=f[2]-u[2],E=f[3]-u[3];return x*x+A*A+S*S+E*E}function i(f,u,x,A,S,E,T){T==null&&(T=1);const _=A.length,m=[];for(var o=0;o<_;o++){const L=A[o];m.push([L>>>0&255,L>>>8&255,L>>>16&255,L>>>24&255])}for(o=0;o<_;o++){let L=4294967295;for(var N=0,D=0;D<_;D++){var P=d(m[o],m[D]);D!=o&&P<L&&(L=P,N=D)}}const G=new Uint32Array(S.buffer),W=new Int16Array(u*x*4),q=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(o=0;o<q.length;o++)q[o]=255*((q[o]+.5)/16-.5);for(let L=0;L<x;L++)for(let J=0;J<u;J++){var V;o=4*(L*u+J),T!=2?V=[t(f[o]+W[o]),t(f[o+1]+W[o+1]),t(f[o+2]+W[o+2]),t(f[o+3]+W[o+3])]:(P=q[4*(3&L)+(3&J)],V=[t(f[o]+P),t(f[o+1]+P),t(f[o+2]+P),t(f[o+3]+P)]),N=0;let ue=16777215;for(D=0;D<_;D++){const le=d(V,m[D]);le<ue&&(ue=le,N=D)}const ie=m[N],re=[V[0]-ie[0],V[1]-ie[1],V[2]-ie[2],V[3]-ie[3]];T==1&&(J!=u-1&&e(re,W,o+4,7),L!=x-1&&(J!=0&&e(re,W,o+4*u-4,3),e(re,W,o+4*u,5),J!=u-1&&e(re,W,o+4*u+4,1))),E[o>>2]=N,G[o>>2]=A[N]}}function y(f,u,x,A,S){S==null&&(S={});const{crc:E}=c,T=v.writeUint,_=v.writeUshort,m=v.writeASCII;let o=8;const N=f.frames.length>1;let D,P=!1,G=33+(N?20:0);if(S.sRGB!=null&&(G+=13),S.pHYs!=null&&(G+=21),S.iCCP!=null&&(D=pako.deflate(S.iCCP),G+=21+D.length+4),f.ctype==3){for(var W=f.plte.length,q=0;q<W;q++)f.plte[q]>>>24!=255&&(P=!0);G+=8+3*W+4+(P?8+1*W+4:0)}for(var V=0;V<f.frames.length;V++)N&&(G+=38),G+=(ie=f.frames[V]).cimg.length+12,V!=0&&(G+=4);G+=12;const L=new Uint8Array(G),J=[137,80,78,71,13,10,26,10];for(q=0;q<8;q++)L[q]=J[q];if(T(L,o,13),o+=4,m(L,o,"IHDR"),o+=4,T(L,o,u),o+=4,T(L,o,x),o+=4,L[o]=f.depth,o++,L[o]=f.ctype,o++,L[o]=0,o++,L[o]=0,o++,L[o]=0,o++,T(L,o,E(L,o-17,17)),o+=4,S.sRGB!=null&&(T(L,o,1),o+=4,m(L,o,"sRGB"),o+=4,L[o]=S.sRGB,o++,T(L,o,E(L,o-5,5)),o+=4),S.iCCP!=null){const re=13+D.length;T(L,o,re),o+=4,m(L,o,"iCCP"),o+=4,m(L,o,"ICC profile"),o+=11,o+=2,L.set(D,o),o+=D.length,T(L,o,E(L,o-(re+4),re+4)),o+=4}if(S.pHYs!=null&&(T(L,o,9),o+=4,m(L,o,"pHYs"),o+=4,T(L,o,S.pHYs[0]),o+=4,T(L,o,S.pHYs[1]),o+=4,L[o]=S.pHYs[2],o++,T(L,o,E(L,o-13,13)),o+=4),N&&(T(L,o,8),o+=4,m(L,o,"acTL"),o+=4,T(L,o,f.frames.length),o+=4,T(L,o,S.loop!=null?S.loop:0),o+=4,T(L,o,E(L,o-12,12)),o+=4),f.ctype==3){for(T(L,o,3*(W=f.plte.length)),o+=4,m(L,o,"PLTE"),o+=4,q=0;q<W;q++){const re=3*q,le=f.plte[q],ce=255&le,fe=le>>>8&255,ke=le>>>16&255;L[o+re+0]=ce,L[o+re+1]=fe,L[o+re+2]=ke}if(o+=3*W,T(L,o,E(L,o-3*W-4,3*W+4)),o+=4,P){for(T(L,o,W),o+=4,m(L,o,"tRNS"),o+=4,q=0;q<W;q++)L[o+q]=f.plte[q]>>>24&255;o+=W,T(L,o,E(L,o-W-4,W+4)),o+=4}}let ue=0;for(V=0;V<f.frames.length;V++){var ie=f.frames[V];N&&(T(L,o,26),o+=4,m(L,o,"fcTL"),o+=4,T(L,o,ue++),o+=4,T(L,o,ie.rect.width),o+=4,T(L,o,ie.rect.height),o+=4,T(L,o,ie.rect.x),o+=4,T(L,o,ie.rect.y),o+=4,_(L,o,A[V]),o+=2,_(L,o,1e3),o+=2,L[o]=ie.dispose,o++,L[o]=ie.blend,o++,T(L,o,E(L,o-30,30)),o+=4);const re=ie.cimg;T(L,o,(W=re.length)+(V==0?0:4)),o+=4;const le=o;m(L,o,V==0?"IDAT":"fdAT"),o+=4,V!=0&&(T(L,o,ue++),o+=4),L.set(re,o),o+=W,T(L,o,E(L,le,o-le)),o+=4}return T(L,o,0),o+=4,m(L,o,"IEND"),o+=4,T(L,o,E(L,o-4,4)),o+=4,L.buffer}function w(f,u,x){for(let A=0;A<f.frames.length;A++){const S=f.frames[A];S.rect.width;const E=S.rect.height,T=new Uint8Array(E*S.bpl+E);S.cimg=l(S.img,E,S.bpp,S.bpl,T,u,x)}}function n(f,u,x,A,S){const E=S[0],T=S[1],_=S[2],m=S[3],o=S[4],N=S[5];let D=6,P=8,G=255;for(var W=0;W<f.length;W++){const ye=new Uint8Array(f[W]);for(var q=ye.length,V=0;V<q;V+=4)G&=ye[V+3]}const L=G!=255,J=function(de,he,pe,Se,be,je){const xe=[];for(var ne=0;ne<de.length;ne++){const te=new Uint8Array(de[ne]),Ue=new Uint32Array(te.buffer);var we;let se=0,Oe=0,ee=he,Ee=pe,Ie=Se?1:0;if(ne!=0){const gt=je||Se||ne==1||xe[ne-2].dispose!=0?1:2;let pt=0,nt=1e9;for(let ot=0;ot<gt;ot++){var Ce=new Uint8Array(de[ne-1-ot]);const Ot=new Uint32Array(de[ne-1-ot]);let ge=he,Re=pe,Ke=-1,$e=-1;for(let qe=0;qe<pe;qe++)for(let Ve=0;Ve<he;Ve++)Ue[Ae=qe*he+Ve]!=Ot[Ae]&&(Ve<ge&&(ge=Ve),Ve>Ke&&(Ke=Ve),qe<Re&&(Re=qe),qe>$e&&($e=qe));Ke==-1&&(ge=Re=Ke=$e=0),be&&((1&ge)==1&&ge--,(1&Re)==1&&Re--);const ct=(Ke-ge+1)*($e-Re+1);ct<nt&&(nt=ct,pt=ot,se=ge,Oe=Re,ee=Ke-ge+1,Ee=$e-Re+1)}Ce=new Uint8Array(de[ne-1-pt]),pt==1&&(xe[ne-1].dispose=2),we=new Uint8Array(ee*Ee*4),h(Ce,he,pe,we,ee,Ee,-se,-Oe,0),Ie=h(te,he,pe,we,ee,Ee,-se,-Oe,3)?1:0,Ie==1?r(te,he,pe,we,{x:se,y:Oe,width:ee,height:Ee}):h(te,he,pe,we,ee,Ee,-se,-Oe,0)}else we=te.slice(0);xe.push({rect:{x:se,y:Oe,width:ee,height:Ee},img:we,blend:Ie,dispose:0})}if(Se)for(ne=0;ne<xe.length;ne++){if((Ye=xe[ne]).blend==1)continue;const te=Ye.rect,Ue=xe[ne-1].rect,se=Math.min(te.x,Ue.x),Oe=Math.min(te.y,Ue.y),ee={x:se,y:Oe,width:Math.max(te.x+te.width,Ue.x+Ue.width)-se,height:Math.max(te.y+te.height,Ue.y+Ue.height)-Oe};xe[ne-1].dispose=1,ne-1!=0&&s(de,he,pe,xe,ne-1,ee,be),s(de,he,pe,xe,ne,ee,be)}let at=0;if(de.length!=1)for(var Ae=0;Ae<xe.length;Ae++){var Ye;at+=(Ye=xe[Ae]).rect.width*Ye.rect.height}return xe}(f,u,x,E,T,_),ue={},ie=[],re=[];if(A!=0){const ye=[];for(V=0;V<J.length;V++)ye.push(J[V].img.buffer);const de=function(be){let je=0;for(var xe=0;xe<be.length;xe++)je+=be[xe].byteLength;const ne=new Uint8Array(je);let we=0;for(xe=0;xe<be.length;xe++){const Ce=new Uint8Array(be[xe]),at=Ce.length;for(let Ae=0;Ae<at;Ae+=4){let Ye=Ce[Ae],te=Ce[Ae+1],Ue=Ce[Ae+2];const se=Ce[Ae+3];se==0&&(Ye=te=Ue=0),ne[we+Ae]=Ye,ne[we+Ae+1]=te,ne[we+Ae+2]=Ue,ne[we+Ae+3]=se}we+=at}return ne.buffer}(ye),he=I(de,A);for(V=0;V<he.plte.length;V++)ie.push(he.plte[V].est.rgba);let pe=0;for(V=0;V<J.length;V++){const Se=(ce=J[V]).img.length;var le=new Uint8Array(he.inds.buffer,pe>>2,Se>>2);re.push(le);const be=new Uint8Array(he.abuf,pe,Se);N&&i(ce.img,ce.rect.width,ce.rect.height,ie,be,le),ce.img.set(be),pe+=Se}}else for(W=0;W<J.length;W++){var ce=J[W];const ye=new Uint32Array(ce.img.buffer);var fe=ce.rect.width;for(q=ye.length,le=new Uint8Array(q),re.push(le),V=0;V<q;V++){const de=ye[V];if(V!=0&&de==ye[V-1])le[V]=le[V-1];else if(V>fe&&de==ye[V-fe])le[V]=le[V-fe];else{let he=ue[de];if(he==null&&(ue[de]=he=ie.length,ie.push(de),ie.length>=300))break;le[V]=he}}}const ke=ie.length;for(ke<=256&&o==0&&(P=ke<=2?1:ke<=4?2:ke<=16?4:8,P=Math.max(P,m)),W=0;W<J.length;W++){(ce=J[W]).rect.x,ce.rect.y,fe=ce.rect.width;const ye=ce.rect.height;let de=ce.img;new Uint32Array(de.buffer);let he=4*fe,pe=4;if(ke<=256&&o==0){he=Math.ceil(P*fe/8);var Te=new Uint8Array(he*ye);const Se=re[W];for(let be=0;be<ye;be++){V=be*he;const je=be*fe;if(P==8)for(var me=0;me<fe;me++)Te[V+me]=Se[je+me];else if(P==4)for(me=0;me<fe;me++)Te[V+(me>>1)]|=Se[je+me]<<4-4*(1&me);else if(P==2)for(me=0;me<fe;me++)Te[V+(me>>2)]|=Se[je+me]<<6-2*(3&me);else if(P==1)for(me=0;me<fe;me++)Te[V+(me>>3)]|=Se[je+me]<<7-1*(7&me)}de=Te,D=3,pe=1}else if(L==0&&J.length==1){Te=new Uint8Array(fe*ye*3);const Se=fe*ye;for(V=0;V<Se;V++){const be=3*V,je=4*V;Te[be]=de[je],Te[be+1]=de[je+1],Te[be+2]=de[je+2]}de=Te,D=2,pe=3,he=3*fe}ce.img=de,ce.bpl=he,ce.bpp=pe}return{ctype:D,depth:P,plte:ie,frames:J}}function s(f,u,x,A,S,E,T){const _=Uint8Array,m=Uint32Array,o=new _(f[S-1]),N=new m(f[S-1]),D=S+1<f.length?new _(f[S+1]):null,P=new _(f[S]),G=new m(P.buffer);let W=u,q=x,V=-1,L=-1;for(let ue=0;ue<E.height;ue++)for(let ie=0;ie<E.width;ie++){const re=E.x+ie,le=E.y+ue,ce=le*u+re,fe=G[ce];fe==0||A[S-1].dispose==0&&N[ce]==fe&&(D==null||D[4*ce+3]!=0)||(re<W&&(W=re),re>V&&(V=re),le<q&&(q=le),le>L&&(L=le))}V==-1&&(W=q=V=L=0),T&&((1&W)==1&&W--,(1&q)==1&&q--),E={x:W,y:q,width:V-W+1,height:L-q+1};const J=A[S];J.rect=E,J.blend=1,J.img=new Uint8Array(E.width*E.height*4),A[S-1].dispose==0?(h(o,u,x,J.img,E.width,E.height,-E.x,-E.y,0),r(P,u,x,J.img,E)):h(P,u,x,J.img,E.width,E.height,-E.x,-E.y,0)}function r(f,u,x,A,S){h(f,u,x,A,S.width,S.height,-S.x,-S.y,2)}function l(f,u,x,A,S,E,T){const _=[];let m,o=[0,1,2,3,4];E!=-1?o=[E]:(u*A>5e5||x==1)&&(o=[0]),T&&(m={level:0});const N=_s;for(var D=0;D<o.length;D++){for(let W=0;W<u;W++)p(S,f,W,A,x,o[D]);_.push(N.deflate(S,m))}let P,G=1e9;for(D=0;D<_.length;D++)_[D].length<G&&(P=D,G=_[D].length);return _[P]}function p(f,u,x,A,S,E){const T=x*A;let _=T+x;if(f[_]=E,_++,E==0)if(A<500)for(var m=0;m<A;m++)f[_+m]=u[T+m];else f.set(new Uint8Array(u.buffer,T,A),_);else if(E==1){for(m=0;m<S;m++)f[_+m]=u[T+m];for(m=S;m<A;m++)f[_+m]=u[T+m]-u[T+m-S]+256&255}else if(x==0){for(m=0;m<S;m++)f[_+m]=u[T+m];if(E==2)for(m=S;m<A;m++)f[_+m]=u[T+m];if(E==3)for(m=S;m<A;m++)f[_+m]=u[T+m]-(u[T+m-S]>>1)+256&255;if(E==4)for(m=S;m<A;m++)f[_+m]=u[T+m]-F(u[T+m-S],0,0)+256&255}else{if(E==2)for(m=0;m<A;m++)f[_+m]=u[T+m]+256-u[T+m-A]&255;if(E==3){for(m=0;m<S;m++)f[_+m]=u[T+m]+256-(u[T+m-A]>>1)&255;for(m=S;m<A;m++)f[_+m]=u[T+m]+256-(u[T+m-A]+u[T+m-S]>>1)&255}if(E==4){for(m=0;m<S;m++)f[_+m]=u[T+m]+256-F(0,u[T+m-A],0)&255;for(m=S;m<A;m++)f[_+m]=u[T+m]+256-F(u[T+m-S],u[T+m-A],u[T+m-S-A])&255}}}function I(f,u){const x=new Uint8Array(f),A=x.slice(0),S=new Uint32Array(A.buffer),E=k(A,u),T=E[0],_=E[1],m=x.length,o=new Uint8Array(m>>2);let N;if(x.length<2e7)for(var D=0;D<m;D+=4)N=C(T,P=x[D]*(1/255),G=x[D+1]*(1/255),W=x[D+2]*(1/255),q=x[D+3]*(1/255)),o[D>>2]=N.ind,S[D>>2]=N.est.rgba;else for(D=0;D<m;D+=4){var P=x[D]*.00392156862745098,G=x[D+1]*(1/255),W=x[D+2]*(1/255),q=x[D+3]*(1/255);for(N=T;N.left;)N=z(N.est,P,G,W,q)<=0?N.left:N.right;o[D>>2]=N.ind,S[D>>2]=N.est.rgba}return{abuf:A.buffer,inds:o,plte:_}}function k(f,u,x){x==null&&(x=1e-4);const A=new Uint32Array(f.buffer),S={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};S.bst=H(f,S.i0,S.i1),S.est=b(S.bst);const E=[S];for(;E.length<u;){let _=0,m=0;for(var T=0;T<E.length;T++)E[T].est.L>_&&(_=E[T].est.L,m=T);if(_<x)break;const o=E[m],N=B(f,A,o.i0,o.i1,o.est.e,o.est.eMq255);if(o.i0>=N||o.i1<=N){o.est.L=0;continue}const D={i0:o.i0,i1:N,bst:null,est:null,tdst:0,left:null,right:null};D.bst=H(f,D.i0,D.i1),D.est=b(D.bst);const P={i0:N,i1:o.i1,bst:null,est:null,tdst:0,left:null,right:null};for(P.bst={R:[],m:[],N:o.bst.N-D.bst.N},T=0;T<16;T++)P.bst.R[T]=o.bst.R[T]-D.bst.R[T];for(T=0;T<4;T++)P.bst.m[T]=o.bst.m[T]-D.bst.m[T];P.est=b(P.bst),o.left=D,o.right=P,E[m]=D,E.push(P)}for(E.sort((_,m)=>m.bst.N-_.bst.N),T=0;T<E.length;T++)E[T].ind=T;return[S,E]}function C(f,u,x,A,S){if(f.left==null)return f.tdst=function(D,P,G,W,q){const V=P-D[0],L=G-D[1],J=W-D[2],ue=q-D[3];return V*V+L*L+J*J+ue*ue}(f.est.q,u,x,A,S),f;const E=z(f.est,u,x,A,S);let T=f.left,_=f.right;E>0&&(T=f.right,_=f.left);const m=C(T,u,x,A,S);if(m.tdst<=E*E)return m;const o=C(_,u,x,A,S);return o.tdst<m.tdst?o:m}function z(f,u,x,A,S){const{e:E}=f;return E[0]*u+E[1]*x+E[2]*A+E[3]*S-f.eMq}function B(f,u,x,A,S,E){for(A-=4;x<A;){for(;R(f,x,S)<=E;)x+=4;for(;R(f,A,S)>E;)A-=4;if(x>=A)break;const T=u[x>>2];u[x>>2]=u[A>>2],u[A>>2]=T,x+=4,A-=4}for(;R(f,x,S)>E;)x-=4;return x+4}function R(f,u,x){return f[u]*x[0]+f[u+1]*x[1]+f[u+2]*x[2]+f[u+3]*x[3]}function H(f,u,x){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=[0,0,0,0],E=x-u>>2;for(let T=u;T<x;T+=4){const _=f[T]*.00392156862745098,m=f[T+1]*(1/255),o=f[T+2]*(1/255),N=f[T+3]*(1/255);S[0]+=_,S[1]+=m,S[2]+=o,S[3]+=N,A[0]+=_*_,A[1]+=_*m,A[2]+=_*o,A[3]+=_*N,A[5]+=m*m,A[6]+=m*o,A[7]+=m*N,A[10]+=o*o,A[11]+=o*N,A[15]+=N*N}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:S,N:E}}function b(f){const{R:u}=f,{m:x}=f,{N:A}=f,S=x[0],E=x[1],T=x[2],_=x[3],m=A==0?0:1/A,o=[u[0]-S*S*m,u[1]-S*E*m,u[2]-S*T*m,u[3]-S*_*m,u[4]-E*S*m,u[5]-E*E*m,u[6]-E*T*m,u[7]-E*_*m,u[8]-T*S*m,u[9]-T*E*m,u[10]-T*T*m,u[11]-T*_*m,u[12]-_*S*m,u[13]-_*E*m,u[14]-_*T*m,u[15]-_*_*m],N=o,D=M;let P=[Math.random(),Math.random(),Math.random(),Math.random()],G=0,W=0;if(A!=0)for(let V=0;V<16&&(P=D.multVec(N,P),W=Math.sqrt(D.dot(P,P)),P=D.sml(1/W,P),!(V!=0&&Math.abs(W-G)<1e-9));V++)G=W;const q=[S*m,E*m,T*m,_*m];return{Cov:o,q,e:P,L:G,eMq255:D.dot(D.sml(255,q),P),eMq:D.dot(P,q),rgba:(Math.round(255*q[3])<<24|Math.round(255*q[2])<<16|Math.round(255*q[1])<<8|Math.round(255*q[0])<<0)>>>0}}var M={multVec:(f,u)=>[f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3],f[4]*u[0]+f[5]*u[1]+f[6]*u[2]+f[7]*u[3],f[8]*u[0]+f[9]*u[1]+f[10]*u[2]+f[11]*u[3],f[12]*u[0]+f[13]*u[1]+f[14]*u[2]+f[15]*u[3]],dot:(f,u)=>f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3],sml:(f,u)=>[f*u[0],f*u[1],f*u[2],f*u[3]]};et.encode=function(u,x,A,S,E,T,_){S==null&&(S=0),_==null&&(_=!1);const m=n(u,x,A,S,[!1,!1,!1,0,_,!1]);return w(m,-1),y(m,x,A,E,T)},et.encodeLL=function(u,x,A,S,E,T,_,m){const o={ctype:0+(S==1?0:2)+(E==0?0:4),depth:T,frames:[]},N=(S+E)*T,D=N*x;for(let P=0;P<u.length;P++)o.frames.push({rect:{x:0,y:0,width:x,height:A},img:new Uint8Array(u[P]),blend:0,dispose:1,bpp:Math.ceil(N/8),bpl:Math.ceil(D/8)});return w(o,0,!0),y(o,x,A,_,m)},et.encode.compress=n,et.encode.dither=i,et.quantize=I,et.quantize.getKDtree=k,et.quantize.getNearest=C})();const Sr={toArrayBuffer(h,v){const F=h.width,c=h.height,e=F<<2,t=h.getContext("2d").getImageData(0,0,F,c),d=new Uint32Array(t.data.buffer),i=(32*F+31)/32<<2,y=i*c,w=122+y,n=new ArrayBuffer(w),s=new DataView(n),r=1<<20;let l,p,I,k,C=r,z=0,B=0,R=0;function H(f){s.setUint16(B,f,!0),B+=2}function b(f){s.setUint32(B,f,!0),B+=4}function M(f){B+=f}H(19778),b(w),M(4),b(122),b(108),b(F),b(-c>>>0),H(1),H(32),b(3),b(y),b(2835),b(2835),M(8),b(16711680),b(65280),b(255),b(4278190080),b(1466527264),function f(){for(;z<c&&C>0;){for(k=122+z*i,l=0;l<e;)C--,p=d[R++],I=p>>>24,s.setUint32(k+l,p<<8|I),l+=4;z++}R<d.length?(C=r,setTimeout(f,Sr._dly)):v(n)}()},toBlob(h,v){this.toArrayBuffer(h,F=>{v(new Blob([F],{type:"image/bmp"}))})},_dly:9};var ze={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Es={[ze.CHROME]:16384,[ze.FIREFOX]:11180,[ze.DESKTOP_SAFARI]:16384,[ze.IE]:8192,[ze.IOS]:4096,[ze.ETC]:8192};const Wn=typeof window<"u",wr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,xn=Wn&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),js=(Wn||wr)&&(xn&&xn.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Cr=(Wn||wr)&&(xn&&xn.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Gn(h,v,F=Date.now()){return new Promise(c=>{const e=h.split(","),t=e[0].match(/:(.*?);/)[1],d=globalThis.atob(e[1]);let i=d.length;const y=new Uint8Array(i);for(;i--;)y[i]=d.charCodeAt(i);const w=new Blob([y],{type:t});w.name=v,w.lastModified=F,c(w)})}function _r(h){return new Promise((v,F)=>{const c=new Cr;c.onload=()=>v(c.result),c.onerror=e=>F(e),c.readAsDataURL(h)})}function Er(h){return new Promise((v,F)=>{const c=new Image;c.onload=()=>v(c),c.onerror=e=>F(e),c.src=h})}function yt(){if(yt.cachedResult!==void 0)return yt.cachedResult;let h=ze.ETC;const{userAgent:v}=navigator;return/Chrom(e|ium)/i.test(v)?h=ze.CHROME:/iP(ad|od|hone)/i.test(v)&&/WebKit/i.test(v)?h=ze.IOS:/Safari/i.test(v)?h=ze.DESKTOP_SAFARI:/Firefox/i.test(v)?h=ze.FIREFOX:(/MSIE/i.test(v)||document.documentMode)&&(h=ze.IE),yt.cachedResult=h,yt.cachedResult}function jr(h,v){const F=yt(),c=Es[F];let e=h,t=v,d=e*t;const i=e>t?t/e:e/t;for(;d>c*c;){const y=(c+e)/2,w=(c+t)/2;y<w?(t=w,e=w*i):(t=y*i,e=y),d=e*t}return{width:e,height:t}}function Tn(h,v){let F,c;try{if(F=new OffscreenCanvas(h,v),c=F.getContext("2d"),c===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{F=document.createElement("canvas"),c=F.getContext("2d")}return F.width=h,F.height=v,[F,c]}function Ir(h,v){const{width:F,height:c}=jr(h.width,h.height),[e,t]=Tn(F,c);return v&&/jpe?g/.test(v)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(h,0,0,e.width,e.height),e}function un(){return un.cachedResult!==void 0||(un.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),un.cachedResult}function vn(h,v={}){return new Promise(function(F,c){let e,t;var d=function(){try{return t=Ir(e,v.fileType||h.type),F([e,t])}catch(y){return c(y)}},i=function(y){try{var w=function(n){try{throw n}catch(s){return c(s)}};try{let n;return _r(h).then(function(s){try{return n=s,Er(n).then(function(r){try{return e=r,function(){try{return d()}catch(l){return c(l)}}()}catch(l){return w(l)}},w)}catch(r){return w(r)}},w)}catch(n){w(n)}}catch(n){return c(n)}};try{if(un()||[ze.DESKTOP_SAFARI,ze.MOBILE_SAFARI].includes(yt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(h).then(function(y){try{return e=y,d()}catch{return i()}},i)}catch{i()}})}function yn(h,v,F,c,e=1){return new Promise(function(t,d){let i;if(v==="image/png"){let w,n,s;return w=h.getContext("2d"),{data:n}=w.getImageData(0,0,h.width,h.height),s=et.encode([n.buffer],h.width,h.height,4096*e),i=new Blob([s],{type:v}),i.name=F,i.lastModified=c,y.call(this)}{let w=function(){return y.call(this)};if(v==="image/bmp")return new Promise(n=>Sr.toBlob(h,n)).then((function(n){try{return i=n,i.name=F,i.lastModified=c,w.call(this)}catch(s){return d(s)}}).bind(this),d);{let n=function(){return w.call(this)};if(typeof OffscreenCanvas=="function"&&h instanceof OffscreenCanvas)return h.convertToBlob({type:v,quality:e}).then((function(s){try{return i=s,i.name=F,i.lastModified=c,n.call(this)}catch(r){return d(r)}}).bind(this),d);{let s;return s=h.toDataURL(v,e),Gn(s,F,c).then((function(r){try{return i=r,n.call(this)}catch(l){return d(l)}}).bind(this),d)}}}function y(){return t(i)}})}function st(h){h.width=0,h.height=0}function Et(){return new Promise(function(h,v){let F,c,e,t;return Et.cachedResult!==void 0?h(Et.cachedResult):Gn("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(d){try{return F=d,vn(F).then(function(i){try{return c=i[1],yn(c,F.type,F.name,F.lastModified).then(function(y){try{return e=y,st(c),vn(e).then(function(w){try{return t=w[0],Et.cachedResult=t.width===1&&t.height===2,h(Et.cachedResult)}catch(n){return v(n)}},v)}catch(w){return v(w)}},v)}catch(y){return v(y)}},v)}catch(i){return v(i)}},v)})}function Dr(h){return new Promise((v,F)=>{const c=new Cr;c.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return v(-2);const d=t.byteLength;let i=2;for(;i<d;){if(t.getUint16(i+2,!1)<=8)return v(-1);const y=t.getUint16(i,!1);if(i+=2,y==65505){if(t.getUint32(i+=2,!1)!=1165519206)return v(-1);const w=t.getUint16(i+=6,!1)==18761;i+=t.getUint32(i+4,w);const n=t.getUint16(i,w);i+=2;for(let s=0;s<n;s++)if(t.getUint16(i+12*s,w)==274)return v(t.getUint16(i+12*s+8,w))}else{if((65280&y)!=65280)break;i+=t.getUint16(i,!1)}}return v(-1)},c.onerror=e=>F(e),c.readAsArrayBuffer(h)})}function Rr(h,v){const{width:F}=h,{height:c}=h,{maxWidthOrHeight:e}=v;let t,d=h;return isFinite(e)&&(F>e||c>e)&&([d,t]=Tn(F,c),F>c?(d.width=e,d.height=c/F*e):(d.width=F/c*e,d.height=e),t.drawImage(h,0,0,d.width,d.height),st(h)),d}function Fr(h,v){const{width:F}=h,{height:c}=h,[e,t]=Tn(F,c);switch(v>4&&v<9?(e.width=c,e.height=F):(e.width=F,e.height=c),v){case 2:t.transform(-1,0,0,1,F,0);break;case 3:t.transform(-1,0,0,-1,F,c);break;case 4:t.transform(1,0,0,-1,0,c);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,c,0);break;case 7:t.transform(0,-1,-1,0,c,F);break;case 8:t.transform(0,-1,1,0,0,F)}return t.drawImage(h,0,0,F,c),st(h),e}function nr(h,v,F=0){return new Promise(function(c,e){let t,d,i,y,w,n,s,r,l,p,I,k,C,z,B,R,H,b,M,f;function u(A=5){if(v.signal&&v.signal.aborted)throw v.signal.reason;t+=A,v.onProgress(Math.min(t,100))}function x(A){if(v.signal&&v.signal.aborted)throw v.signal.reason;t=Math.min(Math.max(A,t),100),v.onProgress(t)}return t=F,d=v.maxIteration||10,i=1024*v.maxSizeMB*1024,u(),vn(h,v).then((function(A){try{return[,y]=A,u(),w=Rr(y,v),u(),new Promise(function(S,E){var T;if(!(T=v.exifOrientation))return Dr(h).then((function(m){try{return T=m,_.call(this)}catch(o){return E(o)}}).bind(this),E);function _(){return S(T)}return _.call(this)}).then((function(S){try{return n=S,u(),Et().then((function(E){try{return s=E?w:Fr(w,n),u(),r=v.initialQuality||1,l=v.fileType||h.type,yn(s,l,h.name,h.lastModified,r).then((function(T){try{{let m=function(){if(d--&&(B>i||B>C)){let N,D;return N=f?.95*M.width:M.width,D=f?.95*M.height:M.height,[H,b]=Tn(N,D),b.drawImage(M,0,0,N,D),r*=l==="image/png"?.85:.95,yn(H,l,h.name,h.lastModified,r).then(function(P){try{return R=P,st(M),M=H,B=R.size,x(Math.min(99,Math.floor((z-B)/(z-i)*100))),m}catch(G){return e(G)}},e)}return[1]},o=function(){return st(M),st(H),st(w),st(s),st(y),x(100),c(R)};if(p=T,u(),I=p.size>i,k=p.size>h.size,!I&&!k)return x(100),c(p);var _;return C=h.size,z=p.size,B=z,M=s,f=!v.alwaysKeepResolution&&I,(_=(function(N){for(;N;){if(N.then)return void N.then(_,e);try{if(N.pop){if(N.length)return N.pop()?o.call(this):N;N=m}else N=N.call(this)}catch(D){return e(D)}}}).bind(this))(m)}}catch(m){return e(m)}}).bind(this),e)}catch(T){return e(T)}}).bind(this),e)}catch(E){return e(E)}}).bind(this),e)}catch(S){return e(S)}}).bind(this),e)})}const Is=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Dn;function Ds(h,v){return new Promise((F,c)=>{Dn||(Dn=function(d){const i=[];return i.push(d),URL.createObjectURL(new Blob(i))}(Is));const e=new Worker(Dn);e.addEventListener("message",function(d){if(v.signal&&v.signal.aborted)e.terminate();else if(d.data.progress===void 0){if(d.data.error)return c(new Error(d.data.error)),void e.terminate();F(d.data.file),e.terminate()}else v.onProgress(d.data.progress)}),e.addEventListener("error",c),v.signal&&v.signal.addEventListener("abort",()=>{c(v.signal.reason),e.terminate()}),e.postMessage({file:h,imageCompressionLibUrl:v.libURL,options:{...v,onProgress:void 0,signal:void 0}})})}function Me(h,v){return new Promise(function(F,c){let e,t,d,i,y,w;if(e={...v},d=0,{onProgress:i}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,y=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=l=>{d=l,typeof i=="function"&&i(d)},!(h instanceof Blob||h instanceof js))return c(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(h.type))return c(new Error("The file given is not an image"));if(w=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!y||typeof Worker!="function"||w)return nr(h,e).then((function(l){try{return t=l,r.call(this)}catch(p){return c(p)}}).bind(this),c);var n=(function(){try{return r.call(this)}catch(l){return c(l)}}).bind(this),s=function(l){try{return nr(h,e).then(function(p){try{return t=p,n()}catch(I){return c(I)}},c)}catch(p){return c(p)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Ds(h,e).then(function(l){try{return t=l,n()}catch{return s()}},s)}catch{s()}function r(){try{t.name=h.name,t.lastModified=h.lastModified}catch{}try{e.preserveExif&&h.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===h.type)&&(t=Ar(h,t))}catch{}return F(t)}})}Me.getDataUrlFromFile=_r,Me.getFilefromDataUrl=Gn,Me.loadImage=Er,Me.drawImageInCanvas=Ir,Me.drawFileInCanvas=vn,Me.canvasToFile=yn,Me.getExifOrientation=Dr,Me.handleMaxWidthOrHeight=Rr,Me.followExifOrientation=Fr,Me.cleanupCanvasMemory=st,Me.isAutoOrientationInBrowser=Et,Me.approximateBelowMaximumCanvasSizeOfBrowser=jr,Me.copyExifWithoutOrientation=Ar,Me.getBrowserName=yt,Me.version="2.0.2";function Rs(h){var v=typeof h;return h!=null&&(v=="object"||v=="function")}var kr=Rs,Fs=typeof an=="object"&&an&&an.Object===Object&&an,ks=Fs,Us=ks,Os=typeof self=="object"&&self&&self.Object===Object&&self,Ms=Us||Os||Function("return this")(),Ur=Ms,Ns=Ur,Ls=function(){return Ns.Date.now()},Ps=Ls,Bs=/\s/;function Hs(h){for(var v=h.length;v--&&Bs.test(h.charAt(v)););return v}var zs=Hs,$s=zs,Ws=/^\s+/;function Gs(h){return h&&h.slice(0,$s(h)+1).replace(Ws,"")}var Ys=Gs,qs=Ur,Vs=qs.Symbol,Or=Vs,rr=Or,Mr=Object.prototype,Qs=Mr.hasOwnProperty,Xs=Mr.toString,Bt=rr?rr.toStringTag:void 0;function Zs(h){var v=Qs.call(h,Bt),F=h[Bt];try{h[Bt]=void 0;var c=!0}catch{}var e=Xs.call(h);return c&&(v?h[Bt]=F:delete h[Bt]),e}var Ks=Zs,Js=Object.prototype,ei=Js.toString;function ti(h){return ei.call(h)}var ni=ti,sr=Or,ri=Ks,si=ni,ii="[object Null]",ai="[object Undefined]",ir=sr?sr.toStringTag:void 0;function oi(h){return h==null?h===void 0?ai:ii:ir&&ir in Object(h)?ri(h):si(h)}var li=oi;function ci(h){return h!=null&&typeof h=="object"}var di=ci,ui=li,fi=di,hi="[object Symbol]";function mi(h){return typeof h=="symbol"||fi(h)&&ui(h)==hi}var gi=mi,pi=Ys,ar=kr,bi=gi,or=NaN,xi=/^[-+]0x[0-9a-f]+$/i,vi=/^0b[01]+$/i,yi=/^0o[0-7]+$/i,Ti=parseInt;function Ai(h){if(typeof h=="number")return h;if(bi(h))return or;if(ar(h)){var v=typeof h.valueOf=="function"?h.valueOf():h;h=ar(v)?v+"":v}if(typeof h!="string")return h===0?h:+h;h=pi(h);var F=vi.test(h);return F||yi.test(h)?Ti(h.slice(2),F?2:8):xi.test(h)?or:+h}var Si=Ai,wi=kr,Rn=Ps,lr=Si,Ci="Expected a function",_i=Math.max,Ei=Math.min;function ji(h,v,F){var c,e,t,d,i,y,w=0,n=!1,s=!1,r=!0;if(typeof h!="function")throw new TypeError(Ci);v=lr(v)||0,wi(F)&&(n=!!F.leading,s="maxWait"in F,t=s?_i(lr(F.maxWait)||0,v):t,r="trailing"in F?!!F.trailing:r);function l(b){var M=c,f=e;return c=e=void 0,w=b,d=h.apply(f,M),d}function p(b){return w=b,i=setTimeout(C,v),n?l(b):d}function I(b){var M=b-y,f=b-w,u=v-M;return s?Ei(u,t-f):u}function k(b){var M=b-y,f=b-w;return y===void 0||M>=v||M<0||s&&f>=t}function C(){var b=Rn();if(k(b))return z(b);i=setTimeout(C,I(b))}function z(b){return i=void 0,r&&c?l(b):(c=e=void 0,d)}function B(){i!==void 0&&clearTimeout(i),w=0,c=y=e=i=void 0}function R(){return i===void 0?d:z(Rn())}function H(){var b=Rn(),M=k(b);if(c=arguments,e=this,y=b,M){if(i===void 0)return p(y);if(s)return clearTimeout(i),i=setTimeout(C,v),l(y)}return i===void 0&&(i=setTimeout(C,v)),d}return H.cancel=B,H.flush=R,H}var Ii=ji;const Di=cs(Ii);var Yn={},Ri=mt;Object.defineProperty(Yn,"__esModule",{value:!0});var Nr=Yn.default=void 0,Fi=Ri(ht()),cr=a;Nr=Yn.default=(0,Fi.default)([(0,cr.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),(0,cr.jsx)("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")],"ZoomIn");var qn={},ki=mt;Object.defineProperty(qn,"__esModule",{value:!0});var Lr=qn.default=void 0,Ui=ki(ht()),Oi=a;Lr=qn.default=(0,Ui.default)((0,Oi.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14M7 9h5v1H7z"}),"ZoomOut");var Vn={},Mi=mt;Object.defineProperty(Vn,"__esModule",{value:!0});var Pr=Vn.default=void 0,Ni=Mi(ht()),Li=a;Pr=Vn.default=(0,Ni.default)((0,Li.jsx)("path",{d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"}),"Fullscreen");var Qn={},Pi=mt;Object.defineProperty(Qn,"__esModule",{value:!0});var Br=Qn.default=void 0,Bi=Pi(ht()),Hi=a;Br=Qn.default=(0,Bi.default)((0,Hi.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var Xn={},zi=mt;Object.defineProperty(Xn,"__esModule",{value:!0});var Hr=Xn.default=void 0,$i=zi(ht()),dr=a;Hr=Xn.default=(0,$i.default)([(0,dr.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,dr.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera");const Rt=$.forwardRef(({path:h,initialImages:v=[],onImagesUpdated:F,onDelete:c,isOwnDesign:e},t)=>{const[d,i]=$.useState(v.map(o=>({...o,deleted:!1}))),[y,w]=$.useState(!1),[n,s]=$.useState(0),[r,l]=$.useState(!1),[p,I]=$.useState(null),[k,C]=$.useState(1),[z,B]=$.useState(!1),[R,H]=$.useState(!1),[b,M]=$.useState(""),[f,u]=$.useState("info"),x=$.useRef(null);$.useEffect(()=>{console.log("Initial images received:",v),i(v.map(o=>({...o,deleted:!!o.deleted})))},[v]);const A=async o=>{const N=Array.from(o.target.files||[]);w(!0);const D={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},P=N.map(async(G,W)=>{let q=G;G.size>1024*1024&&(q=await Me(G,D),M("Your image was compressed before uploading due to file size larger than 1 MB."),u("info"),H(!0));const L=`${new Date().getTime()}-${q.name}`,J=jt(),ue=It(J,`${h}/${L}`),ie=yr(ue,q);return new Promise((re,le)=>{ie.on("state_changed",ce=>{const fe=ce.bytesTransferred/ce.totalBytes*100;s(fe)},ce=>{console.error("Upload failed:",ce),le(ce)},()=>{Tr(ie.snapshot.ref).then(ce=>{re({url:ce,path:ue.fullPath,title:""})})})})});Promise.all(P).then(G=>{const W=[...d,...G];i(W),F&&F(W),M("Images uploaded successfully."),u("success"),H(!0),w(!1),s(0),x.current&&(x.current.value="")}).catch(G=>{console.error("Error uploading images: ",G),M("Failed to upload images."),u("error"),H(!0),w(!1),s(0)})},S=o=>{i(N=>{const D=N.map((P,G)=>G===o?{...P,deleted:!0}:P);return F(D),D}),M("Image marked for deletion. Update to permanently delete."),u("info"),H(!0)},E=async()=>{const o=d.filter(N=>N.deleted);if(console.log("Attempting to delete images:",o),o.length>0){const N=o.map(D=>{const P=jt(),G=It(P,D.path);return dn(G)});try{await Promise.all(N),c(o),i(D=>D.filter(P=>!P.deleted)),M("Deleted images have been permanently removed."),u("success")}catch(D){console.error("Error committing deletions:",D),M("Failed to commit deletions."),u("error")}H(!0)}else console.log("No images marked for deletion.")},T=o=>{B(!z),I(o)};$.useEffect(()=>{const o=()=>{const N=!!document.fullscreenElement;B(N)};return document.addEventListener("fullscreenchange",o),()=>document.removeEventListener("fullscreenchange",o)},[]);const _=(o,N)=>{N!=="clickaway"&&H(!1)},m=$.useCallback(Di((o,N)=>{setTimeout(()=>{i(D=>{const P=D.map((G,W)=>W===o?{...G,title:N}:G);return F&&F(P),P})},0)},30),[F]);return $.useImperativeHandle(t,()=>({commitDeletions:E})),a.jsxs("div",{children:[e&&a.jsx(mn,{title:"Upload Images",children:a.jsxs(Be,{variant:"outlined",component:"label",startIcon:a.jsx(Hr,{}),sx:{m:1,pl:2,pr:2},children:["Upload Image(s)",a.jsx("input",{type:"file",hidden:!0,multiple:!0,onChange:A,disabled:y,ref:x,accept:"image/*"})]})}),y&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Uploading... ",Math.round(n),"%"]}),a.jsx("div",{style:{width:"100%",backgroundColor:"#ddd"},children:a.jsx("div",{style:{height:"20px",width:`${n}%`,backgroundColor:"green"}})})]}),d.filter(o=>!o.deleted).map((o,N)=>a.jsxs("div",{children:[a.jsx("img",{src:o.url,alt:`Uploaded design ${N}`,onClick:()=>{l(!0),I(N)},style:{width:"100%",maxHeight:"300px",objectFit:"contain",cursor:"pointer"}}),e&&a.jsx(Xe,{onClick:()=>S(N),children:a.jsx(qt,{})}),a.jsx("textarea",{value:o.title,onChange:D=>m(N,D.target.value),placeholder:"Enter image title",rows:2,style:{width:"100%"}})]},N)),a.jsx(Tt,{open:r,onClose:()=>l(!1),fullScreen:z,PaperProps:{style:{backgroundColor:"white",boxShadow:"none",maxWidth:z?"none":void 0,maxHeight:z?"none":void 0,height:z?"100%":void 0,width:z?"100%":void 0,overflowY:"auto"}},children:p!==null&&a.jsxs(At,{children:[a.jsx("div",{style:{textAlign:"center"},children:a.jsx("img",{src:d[p].url,alt:`Zoomed Design ${p}`,style:{maxWidth:"100%",maxHeight:z?"100vh":void 0,transform:`scale(${k})`,transition:"transform 0.2s ease-out"}})}),a.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[a.jsx(Xe,{onClick:()=>C(k*1.2),children:a.jsx(Nr,{})}),a.jsx(Xe,{onClick:()=>C(k/1.2),style:{marginLeft:"10px"},children:a.jsx(Lr,{})}),a.jsx(Xe,{onClick:()=>T(p),style:{marginLeft:"10px"},children:a.jsx(Pr,{})}),z&&a.jsx(Xe,{onClick:()=>T(p),style:{position:"absolute",top:20,right:20},children:a.jsx(Br,{})})]})]})}),a.jsx(St,{open:R,autoHideDuration:6e3,onClose:_,children:a.jsx(wt,{onClose:_,severity:f,sx:{width:"100%"},children:b})})]})});/*! @license DOMPurify 3.1.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.6/LICENSE */const{entries:zr,setPrototypeOf:ur,isFrozen:Wi,getPrototypeOf:Gi,getOwnPropertyDescriptor:Yi}=Object;let{freeze:He,seal:Ze,create:$r}=Object,{apply:Bn,construct:Hn}=typeof Reflect<"u"&&Reflect;He||(He=function(v){return v});Ze||(Ze=function(v){return v});Bn||(Bn=function(v,F,c){return v.apply(F,c)});Hn||(Hn=function(v,F){return new v(...F)});const on=Ge(Array.prototype.forEach),fr=Ge(Array.prototype.pop),Ht=Ge(Array.prototype.push),fn=Ge(String.prototype.toLowerCase),Fn=Ge(String.prototype.toString),hr=Ge(String.prototype.match),zt=Ge(String.prototype.replace),qi=Ge(String.prototype.indexOf),Vi=Ge(String.prototype.trim),tt=Ge(Object.prototype.hasOwnProperty),Pe=Ge(RegExp.prototype.test),$t=Qi(TypeError);function Ge(h){return function(v){for(var F=arguments.length,c=new Array(F>1?F-1:0),e=1;e<F;e++)c[e-1]=arguments[e];return Bn(h,v,c)}}function Qi(h){return function(){for(var v=arguments.length,F=new Array(v),c=0;c<v;c++)F[c]=arguments[c];return Hn(h,F)}}function ae(h,v){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fn;ur&&ur(h,null);let c=v.length;for(;c--;){let e=v[c];if(typeof e=="string"){const t=F(e);t!==e&&(Wi(v)||(v[c]=t),e=t)}h[e]=!0}return h}function Xi(h){for(let v=0;v<h.length;v++)tt(h,v)||(h[v]=null);return h}function vt(h){const v=$r(null);for(const[F,c]of zr(h))tt(h,F)&&(Array.isArray(c)?v[F]=Xi(c):c&&typeof c=="object"&&c.constructor===Object?v[F]=vt(c):v[F]=c);return v}function Wt(h,v){for(;h!==null;){const c=Yi(h,v);if(c){if(c.get)return Ge(c.get);if(typeof c.value=="function")return Ge(c.value)}h=Gi(h)}function F(){return null}return F}const mr=He(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),kn=He(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Un=He(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Zi=He(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),On=He(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ki=He(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),gr=He(["#text"]),pr=He(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Mn=He(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),br=He(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ln=He(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ji=Ze(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ea=Ze(/<%[\w\W]*|[\w\W]*%>/gm),ta=Ze(/\${[\w\W]*}/gm),na=Ze(/^data-[\-\w.\u00B7-\uFFFF]/),ra=Ze(/^aria-[\-\w]+$/),Wr=Ze(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),sa=Ze(/^(?:\w+script|data):/i),ia=Ze(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Gr=Ze(/^html$/i),aa=Ze(/^[a-z][.\w]*(-[.\w]+)+$/i);var xr=Object.freeze({__proto__:null,MUSTACHE_EXPR:Ji,ERB_EXPR:ea,TMPLIT_EXPR:ta,DATA_ATTR:na,ARIA_ATTR:ra,IS_ALLOWED_URI:Wr,IS_SCRIPT_OR_DATA:sa,ATTR_WHITESPACE:ia,DOCTYPE_NAME:Gr,CUSTOM_ELEMENT:aa});const Gt={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},oa=function(){return typeof window>"u"?null:window},la=function(v,F){if(typeof v!="object"||typeof v.createPolicy!="function")return null;let c=null;const e="data-tt-policy-suffix";F&&F.hasAttribute(e)&&(c=F.getAttribute(e));const t="dompurify"+(c?"#"+c:"");try{return v.createPolicy(t,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+t+" could not be created."),null}};function Yr(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oa();const v=K=>Yr(K);if(v.version="3.1.6",v.removed=[],!h||!h.document||h.document.nodeType!==Gt.document)return v.isSupported=!1,v;let{document:F}=h;const c=F,e=c.currentScript,{DocumentFragment:t,HTMLTemplateElement:d,Node:i,Element:y,NodeFilter:w,NamedNodeMap:n=h.NamedNodeMap||h.MozNamedAttrMap,HTMLFormElement:s,DOMParser:r,trustedTypes:l}=h,p=y.prototype,I=Wt(p,"cloneNode"),k=Wt(p,"remove"),C=Wt(p,"nextSibling"),z=Wt(p,"childNodes"),B=Wt(p,"parentNode");if(typeof d=="function"){const K=F.createElement("template");K.content&&K.content.ownerDocument&&(F=K.content.ownerDocument)}let R,H="";const{implementation:b,createNodeIterator:M,createDocumentFragment:f,getElementsByTagName:u}=F,{importNode:x}=c;let A={};v.isSupported=typeof zr=="function"&&typeof B=="function"&&b&&b.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:S,ERB_EXPR:E,TMPLIT_EXPR:T,DATA_ATTR:_,ARIA_ATTR:m,IS_SCRIPT_OR_DATA:o,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:D}=xr;let{IS_ALLOWED_URI:P}=xr,G=null;const W=ae({},[...mr,...kn,...Un,...On,...gr]);let q=null;const V=ae({},[...pr,...Mn,...br,...ln]);let L=Object.seal($r(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),J=null,ue=null,ie=!0,re=!0,le=!1,ce=!0,fe=!1,ke=!0,Te=!1,me=!1,ye=!1,de=!1,he=!1,pe=!1,Se=!0,be=!1;const je="user-content-";let xe=!0,ne=!1,we={},Ce=null;const at=ae({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ae=null;const Ye=ae({},["audio","video","img","source","image","track"]);let te=null;const Ue=ae({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),se="http://www.w3.org/1998/Math/MathML",Oe="http://www.w3.org/2000/svg",ee="http://www.w3.org/1999/xhtml";let Ee=ee,Ie=!1,gt=null;const pt=ae({},[se,Oe,ee],Fn);let nt=null;const ot=["application/xhtml+xml","text/html"],Ot="text/html";let ge=null,Re=null;const Ke=F.createElement("form"),$e=function(j){return j instanceof RegExp||j instanceof Function},ct=function(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Re&&Re===j)){if((!j||typeof j!="object")&&(j={}),j=vt(j),nt=ot.indexOf(j.PARSER_MEDIA_TYPE)===-1?Ot:j.PARSER_MEDIA_TYPE,ge=nt==="application/xhtml+xml"?Fn:fn,G=tt(j,"ALLOWED_TAGS")?ae({},j.ALLOWED_TAGS,ge):W,q=tt(j,"ALLOWED_ATTR")?ae({},j.ALLOWED_ATTR,ge):V,gt=tt(j,"ALLOWED_NAMESPACES")?ae({},j.ALLOWED_NAMESPACES,Fn):pt,te=tt(j,"ADD_URI_SAFE_ATTR")?ae(vt(Ue),j.ADD_URI_SAFE_ATTR,ge):Ue,Ae=tt(j,"ADD_DATA_URI_TAGS")?ae(vt(Ye),j.ADD_DATA_URI_TAGS,ge):Ye,Ce=tt(j,"FORBID_CONTENTS")?ae({},j.FORBID_CONTENTS,ge):at,J=tt(j,"FORBID_TAGS")?ae({},j.FORBID_TAGS,ge):{},ue=tt(j,"FORBID_ATTR")?ae({},j.FORBID_ATTR,ge):{},we=tt(j,"USE_PROFILES")?j.USE_PROFILES:!1,ie=j.ALLOW_ARIA_ATTR!==!1,re=j.ALLOW_DATA_ATTR!==!1,le=j.ALLOW_UNKNOWN_PROTOCOLS||!1,ce=j.ALLOW_SELF_CLOSE_IN_ATTR!==!1,fe=j.SAFE_FOR_TEMPLATES||!1,ke=j.SAFE_FOR_XML!==!1,Te=j.WHOLE_DOCUMENT||!1,de=j.RETURN_DOM||!1,he=j.RETURN_DOM_FRAGMENT||!1,pe=j.RETURN_TRUSTED_TYPE||!1,ye=j.FORCE_BODY||!1,Se=j.SANITIZE_DOM!==!1,be=j.SANITIZE_NAMED_PROPS||!1,xe=j.KEEP_CONTENT!==!1,ne=j.IN_PLACE||!1,P=j.ALLOWED_URI_REGEXP||Wr,Ee=j.NAMESPACE||ee,L=j.CUSTOM_ELEMENT_HANDLING||{},j.CUSTOM_ELEMENT_HANDLING&&$e(j.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(L.tagNameCheck=j.CUSTOM_ELEMENT_HANDLING.tagNameCheck),j.CUSTOM_ELEMENT_HANDLING&&$e(j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(L.attributeNameCheck=j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),j.CUSTOM_ELEMENT_HANDLING&&typeof j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(L.allowCustomizedBuiltInElements=j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),fe&&(re=!1),he&&(de=!0),we&&(G=ae({},gr),q=[],we.html===!0&&(ae(G,mr),ae(q,pr)),we.svg===!0&&(ae(G,kn),ae(q,Mn),ae(q,ln)),we.svgFilters===!0&&(ae(G,Un),ae(q,Mn),ae(q,ln)),we.mathMl===!0&&(ae(G,On),ae(q,br),ae(q,ln))),j.ADD_TAGS&&(G===W&&(G=vt(G)),ae(G,j.ADD_TAGS,ge)),j.ADD_ATTR&&(q===V&&(q=vt(q)),ae(q,j.ADD_ATTR,ge)),j.ADD_URI_SAFE_ATTR&&ae(te,j.ADD_URI_SAFE_ATTR,ge),j.FORBID_CONTENTS&&(Ce===at&&(Ce=vt(Ce)),ae(Ce,j.FORBID_CONTENTS,ge)),xe&&(G["#text"]=!0),Te&&ae(G,["html","head","body"]),G.table&&(ae(G,["tbody"]),delete J.tbody),j.TRUSTED_TYPES_POLICY){if(typeof j.TRUSTED_TYPES_POLICY.createHTML!="function")throw $t('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof j.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw $t('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=j.TRUSTED_TYPES_POLICY,H=R.createHTML("")}else R===void 0&&(R=la(l,e)),R!==null&&typeof H=="string"&&(H=R.createHTML(""));He&&He(j),Re=j}},qe=ae({},["mi","mo","mn","ms","mtext"]),Ve=ae({},["foreignobject","annotation-xml"]),Zt=ae({},["title","style","font","a","script"]),Mt=ae({},[...kn,...Un,...Zi]),Kt=ae({},[...On,...Ki]),An=function(j){let g=B(j);(!g||!g.tagName)&&(g={namespaceURI:Ee,tagName:"template"});const U=fn(j.tagName),O=fn(g.tagName);return gt[j.namespaceURI]?j.namespaceURI===Oe?g.namespaceURI===ee?U==="svg":g.namespaceURI===se?U==="svg"&&(O==="annotation-xml"||qe[O]):!!Mt[U]:j.namespaceURI===se?g.namespaceURI===ee?U==="math":g.namespaceURI===Oe?U==="math"&&Ve[O]:!!Kt[U]:j.namespaceURI===ee?g.namespaceURI===Oe&&!Ve[O]||g.namespaceURI===se&&!qe[O]?!1:!Kt[U]&&(Zt[U]||!Mt[U]):!!(nt==="application/xhtml+xml"&&gt[j.namespaceURI]):!1},Qe=function(j){Ht(v.removed,{element:j});try{B(j).removeChild(j)}catch{k(j)}},bt=function(j,g){try{Ht(v.removed,{attribute:g.getAttributeNode(j),from:g})}catch{Ht(v.removed,{attribute:null,from:g})}if(g.removeAttribute(j),j==="is"&&!q[j])if(de||he)try{Qe(g)}catch{}else try{g.setAttribute(j,"")}catch{}},Jt=function(j){let g=null,U=null;if(ye)j="<remove></remove>"+j;else{const Y=hr(j,/^[\r\n\t ]+/);U=Y&&Y[0]}nt==="application/xhtml+xml"&&Ee===ee&&(j='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+j+"</body></html>");const O=R?R.createHTML(j):j;if(Ee===ee)try{g=new r().parseFromString(O,nt)}catch{}if(!g||!g.documentElement){g=b.createDocument(Ee,"template",null);try{g.documentElement.innerHTML=Ie?H:O}catch{}}const Q=g.body||g.documentElement;return j&&U&&Q.insertBefore(F.createTextNode(U),Q.childNodes[0]||null),Ee===ee?u.call(g,Te?"html":"body")[0]:Te?g.documentElement:Q},en=function(j){return M.call(j.ownerDocument||j,j,w.SHOW_ELEMENT|w.SHOW_COMMENT|w.SHOW_TEXT|w.SHOW_PROCESSING_INSTRUCTION|w.SHOW_CDATA_SECTION,null)},tn=function(j){return j instanceof s&&(typeof j.nodeName!="string"||typeof j.textContent!="string"||typeof j.removeChild!="function"||!(j.attributes instanceof n)||typeof j.removeAttribute!="function"||typeof j.setAttribute!="function"||typeof j.namespaceURI!="string"||typeof j.insertBefore!="function"||typeof j.hasChildNodes!="function")},xt=function(j){return typeof i=="function"&&j instanceof i},Je=function(j,g,U){A[j]&&on(A[j],O=>{O.call(v,g,U,Re)})},Nt=function(j){let g=null;if(Je("beforeSanitizeElements",j,null),tn(j))return Qe(j),!0;const U=ge(j.nodeName);if(Je("uponSanitizeElement",j,{tagName:U,allowedTags:G}),j.hasChildNodes()&&!xt(j.firstElementChild)&&Pe(/<[/\w]/g,j.innerHTML)&&Pe(/<[/\w]/g,j.textContent)||j.nodeType===Gt.progressingInstruction||ke&&j.nodeType===Gt.comment&&Pe(/<[/\w]/g,j.data))return Qe(j),!0;if(!G[U]||J[U]){if(!J[U]&&nn(U)&&(L.tagNameCheck instanceof RegExp&&Pe(L.tagNameCheck,U)||L.tagNameCheck instanceof Function&&L.tagNameCheck(U)))return!1;if(xe&&!Ce[U]){const O=B(j)||j.parentNode,Q=z(j)||j.childNodes;if(Q&&O){const Y=Q.length;for(let Z=Y-1;Z>=0;--Z){const X=I(Q[Z],!0);X.__removalCount=(j.__removalCount||0)+1,O.insertBefore(X,C(j))}}}return Qe(j),!0}return j instanceof y&&!An(j)||(U==="noscript"||U==="noembed"||U==="noframes")&&Pe(/<\/no(script|embed|frames)/i,j.innerHTML)?(Qe(j),!0):(fe&&j.nodeType===Gt.text&&(g=j.textContent,on([S,E,T],O=>{g=zt(g,O," ")}),j.textContent!==g&&(Ht(v.removed,{element:j.cloneNode()}),j.textContent=g)),Je("afterSanitizeElements",j,null),!1)},Lt=function(j,g,U){if(Se&&(g==="id"||g==="name")&&(U in F||U in Ke))return!1;if(!(re&&!ue[g]&&Pe(_,g))){if(!(ie&&Pe(m,g))){if(!q[g]||ue[g]){if(!(nn(j)&&(L.tagNameCheck instanceof RegExp&&Pe(L.tagNameCheck,j)||L.tagNameCheck instanceof Function&&L.tagNameCheck(j))&&(L.attributeNameCheck instanceof RegExp&&Pe(L.attributeNameCheck,g)||L.attributeNameCheck instanceof Function&&L.attributeNameCheck(g))||g==="is"&&L.allowCustomizedBuiltInElements&&(L.tagNameCheck instanceof RegExp&&Pe(L.tagNameCheck,U)||L.tagNameCheck instanceof Function&&L.tagNameCheck(U))))return!1}else if(!te[g]){if(!Pe(P,zt(U,N,""))){if(!((g==="src"||g==="xlink:href"||g==="href")&&j!=="script"&&qi(U,"data:")===0&&Ae[j])){if(!(le&&!Pe(o,zt(U,N,"")))){if(U)return!1}}}}}}return!0},nn=function(j){return j!=="annotation-xml"&&hr(j,D)},rn=function(j){Je("beforeSanitizeAttributes",j,null);const{attributes:g}=j;if(!g)return;const U={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q};let O=g.length;for(;O--;){const Q=g[O],{name:Y,namespaceURI:Z,value:X}=Q,Fe=ge(Y);let ve=Y==="value"?X:Vi(X);if(U.attrName=Fe,U.attrValue=ve,U.keepAttr=!0,U.forceKeepAttr=void 0,Je("uponSanitizeAttribute",j,U),ve=U.attrValue,ke&&Pe(/((--!?|])>)|<\/(style|title)/i,ve)){bt(Y,j);continue}if(U.forceKeepAttr||(bt(Y,j),!U.keepAttr))continue;if(!ce&&Pe(/\/>/i,ve)){bt(Y,j);continue}fe&&on([S,E,T],sn=>{ve=zt(ve,sn," ")});const Ct=ge(j.nodeName);if(Lt(Ct,Fe,ve)){if(be&&(Fe==="id"||Fe==="name")&&(bt(Y,j),ve=je+ve),R&&typeof l=="object"&&typeof l.getAttributeType=="function"&&!Z)switch(l.getAttributeType(Ct,Fe)){case"TrustedHTML":{ve=R.createHTML(ve);break}case"TrustedScriptURL":{ve=R.createScriptURL(ve);break}}try{Z?j.setAttributeNS(Z,Y,ve):j.setAttribute(Y,ve),tn(j)?Qe(j):fr(v.removed)}catch{}}}Je("afterSanitizeAttributes",j,null)},Sn=function K(j){let g=null;const U=en(j);for(Je("beforeSanitizeShadowDOM",j,null);g=U.nextNode();)Je("uponSanitizeShadowNode",g,null),!Nt(g)&&(g.content instanceof t&&K(g.content),rn(g));Je("afterSanitizeShadowDOM",j,null)};return v.sanitize=function(K){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=null,U=null,O=null,Q=null;if(Ie=!K,Ie&&(K="<!-->"),typeof K!="string"&&!xt(K))if(typeof K.toString=="function"){if(K=K.toString(),typeof K!="string")throw $t("dirty is not a string, aborting")}else throw $t("toString is not a function");if(!v.isSupported)return K;if(me||ct(j),v.removed=[],typeof K=="string"&&(ne=!1),ne){if(K.nodeName){const X=ge(K.nodeName);if(!G[X]||J[X])throw $t("root node is forbidden and cannot be sanitized in-place")}}else if(K instanceof i)g=Jt("<!---->"),U=g.ownerDocument.importNode(K,!0),U.nodeType===Gt.element&&U.nodeName==="BODY"||U.nodeName==="HTML"?g=U:g.appendChild(U);else{if(!de&&!fe&&!Te&&K.indexOf("<")===-1)return R&&pe?R.createHTML(K):K;if(g=Jt(K),!g)return de?null:pe?H:""}g&&ye&&Qe(g.firstChild);const Y=en(ne?K:g);for(;O=Y.nextNode();)Nt(O)||(O.content instanceof t&&Sn(O.content),rn(O));if(ne)return K;if(de){if(he)for(Q=f.call(g.ownerDocument);g.firstChild;)Q.appendChild(g.firstChild);else Q=g;return(q.shadowroot||q.shadowrootmode)&&(Q=x.call(c,Q,!0)),Q}let Z=Te?g.outerHTML:g.innerHTML;return Te&&G["!doctype"]&&g.ownerDocument&&g.ownerDocument.doctype&&g.ownerDocument.doctype.name&&Pe(Gr,g.ownerDocument.doctype.name)&&(Z="<!DOCTYPE "+g.ownerDocument.doctype.name+`>
`+Z),fe&&on([S,E,T],X=>{Z=zt(Z,X," ")}),R&&pe?R.createHTML(Z):Z},v.setConfig=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(K),me=!0},v.clearConfig=function(){Re=null,me=!1},v.isValidAttribute=function(K,j,g){Re||ct({});const U=ge(K),O=ge(j);return Lt(U,O,g)},v.addHook=function(K,j){typeof j=="function"&&(A[K]=A[K]||[],Ht(A[K],j))},v.removeHook=function(K){if(A[K])return fr(A[K])},v.removeHooks=function(K){A[K]&&(A[K]=[])},v.removeAllHooks=function(){A={}},v}var Nn=Yr();const it=({onChange:h,initialValue:v})=>{const[F,c]=$.useState(Nn.sanitize(v||"")),e=$.useRef(!1),t=$.useRef(null),[d,i]=$.useState("");$.useEffect(()=>{e.current?c(Nn.sanitize(v||"")):e.current=!0},[v]);const y=(l,p)=>{const I=p.getData(),k=Nn.sanitize(I);c(k),h(k)},w=l=>{if(!t.current){console.warn("Editor not initialized");return}const p=t.current;p.model.change(I=>{const k=p.model.document.selection.getFirstPosition();I.insertText(l,k)}),i("")},n=l=>{w(l.target.value)},s=["α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω"],r=["°","+","-","=","~","≥","≤","≠",">","<","*","/","%"];return a.jsxs("div",{children:[a.jsxs(cn,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%"},children:[a.jsx(ds,{id:"insert-symbols-label",sx:{fontSize:"0.8rem"},children:"Insert Symbols: "}),a.jsx(tr,{variant:"standard",sx:{m:1,minWidth:40},children:a.jsxs(gn,{labelId:"math-operators-label",id:"math-operators",value:d,onChange:n,displayEmpty:!0,children:[a.jsx(_t,{value:"",disabled:!0,children:"Math"}),r.map(l=>a.jsx(_t,{value:l,children:l},l))]})}),a.jsx(tr,{variant:"standard",sx:{m:1,minWidth:40},children:a.jsxs(gn,{labelId:"greek-letters-label",id:"greek-letters",value:d,onChange:n,displayEmpty:!0,children:[a.jsx(_t,{value:"",disabled:!0,children:"Greek"}),s.map(l=>a.jsx(_t,{value:l,children:l},l))]})})]}),a.jsx(us.CKEditor,{editor:fs,data:F,onReady:l=>{t.current=l},config:{toolbar:["undo","redo","|","heading","bold","italic","|","bulletedList","numberedList","blockQuote","indent","outdent","|","link","insertTable","|"],table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]}},onChange:y})]})};var Zn={},ca=mt;Object.defineProperty(Zn,"__esModule",{value:!0});var qr=Zn.default=void 0,da=ca(ht()),ua=a;qr=Zn.default=(0,da.default)((0,ua.jsx)("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"}),"InsertDriveFile");var Kn={},fa=mt;Object.defineProperty(Kn,"__esModule",{value:!0});var Vr=Kn.default=void 0,ha=fa(ht()),ma=a;Vr=Kn.default=(0,ha.default)((0,ma.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");const Ft=({path:h,initialFiles:v,onFilesChange:F,isOwnDesign:c})=>{const[e,t]=$.useState(v.map(x=>({...x,deleted:!!x.deleted}))),[d,i]=$.useState(!1),[y,w]=$.useState(0),[n,s]=$.useState({}),[r,l]=$.useState(!1),[p,I]=$.useState(""),[k,C]=$.useState("info"),z=$.useRef(null);$.useEffect(()=>{console.log("Initial files received:",v),t(v.map(x=>({...x,deleted:!!x.deleted})))},[v]),$.useEffect(()=>()=>{s({})},[]);const B=x=>{console.log("Updating files with",x),F(x),t(x)},R=async x=>{if(!x.target.files)return;const S=Array.from(x.target.files).filter(T=>T.size>5242880?(I("File size should not exceed 5 MB"),C("error"),l(!0),!1):!0);i(!0);const E=S.map(T=>{const _=new Date().getTime(),m=`${_}-${T.name}`,o=jt(),N=It(o,`${h}/${m}`),D=yr(N,T);return new Promise((P,G)=>{D.on("state_changed",W=>{const q=W.bytesTransferred/W.totalBytes*100;w(q)},W=>{console.error("Upload failed:",W),G(W)},()=>{Tr(D.snapshot.ref).then(W=>{P({id:_.toString(),url:W,name:T.name,path:N.fullPath})})})})});Promise.all(E).then(T=>{const _=[...e.filter(m=>!m.deleted),...T];B(_),I("Files uploaded successfully."),C("success"),l(!0),i(!1),w(0),z.current&&(z.current.value="")}).catch(T=>{console.error("Error uploading files: ",T),I("Failed to upload files."),C("error"),l(!0),i(!1),w(0)})},H=x=>{const A=e.map(S=>S.id===x?{...S,deleted:!0}:S);B(A),I("File marked for deletion. Update to permanently delete."),C("info"),l(!0)},b=x=>{s(A=>{var S;return{...A,[x]:((S=e.find(E=>E.id===x))==null?void 0:S.name)||""}}),console.log("editStates after handleEditClick:",n)},M=x=>{t(A=>{const S=A.map(E=>E.id===x&&n[x]!==void 0?{...E,name:n[x]}:E);return F(S),S}),s(A=>{const S={...A};return delete S[x],S}),I("File name updated successfully."),C("info"),l(!0)},f=(x,A)=>{s(S=>({...S,[x]:A}))},u=(x,A)=>{A!=="clickaway"&&l(!1)};return a.jsxs("div",{children:[c&&a.jsx(mn,{title:"Upload Files",children:a.jsxs(Be,{variant:"outlined",component:"label",startIcon:a.jsx(Vr,{}),sx:{m:1,pl:2,pr:2},children:["Upload File(s)",a.jsx("input",{type:"file",hidden:!0,multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",onChange:R,disabled:d,ref:z})]})}),d&&a.jsx("div",{children:a.jsxs("p",{children:["Uploading... ",Math.round(y),"%"]})}),a.jsx(hs,{children:e.map(x=>a.jsxs(ms,{component:"div",disabled:x.deleted,children:[a.jsx(Ts,{children:a.jsx(qr,{})}),typeof n[x.id]=="string"?a.jsx(pn,{variant:"outlined",size:"small",value:n[x.id],onChange:A=>f(x.id,A.target.value),onKeyPress:A=>A.key==="Enter"&&M(x.id),fullWidth:!0}):a.jsx(gs,{primary:x.name,secondary:a.jsx("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",children:"Download"})}),c&&(typeof n[x.id]=="string"?a.jsx(Xe,{onClick:()=>M(x.id),edge:"end","aria-label":"save",children:a.jsx(Pn,{})}):a.jsxs(a.Fragment,{children:[a.jsx(Xe,{onClick:()=>b(x.id),edge:"end","aria-label":"edit",children:a.jsx(vr,{})}),a.jsx(Xe,{onClick:()=>H(x.id),edge:"end","aria-label":"delete",children:a.jsx(qt,{})})]}))]},x.id))}),a.jsx(St,{open:r,autoHideDuration:6e3,onClose:u,children:a.jsx(wt,{onClose:u,severity:k,sx:{width:"100%"},children:p})})]})},ga=({designs:h,setDesigns:v,setIsAdding:F,getDesigns:c,onReturnToDashboard:e})=>{const{userDetails:t}=Qt();console.log("Add Design loaded");const[d,i]=$.useState(""),[y,w]=$.useState(""),[n,s]=$.useState(""),[r,l]=$.useState([]),[p,I]=$.useState([]),k=$.useMemo(()=>r,[r]),[C,z]=$.useState(!1),[B,R]=$.useState(""),[H,b]=$.useState("info"),[M,f]=$.useState(!1),[u,x]=$.useState("");console.log("Adding New Design from user:",t);const A=$.useRef(null),S=()=>{f(!1)},E=(_,m)=>{m!=="clickaway"&&z(!1)};$.useEffect(()=>{if(t!=null&&t.class){const _=t.class.filter(m=>m!=="Public");w(_[0]||"")}},[t==null?void 0:t.class]);const T=async _=>{var D;if(_.preventDefault(),console.log("Files to be saved:",p),!t||!t.uid){console.error("User object is undefined or missing UID."),x("You must be signed in to add a design."),f(!0);return}if(!d){x("All fields are required."),f(!0);return}await((D=A.current)==null?void 0:D.commitDeletions());const m=r.filter(P=>!P.deleted),o=p.filter(P=>!P.deleted).map(P=>({id:P.id,url:P.url,name:P.name,path:P.path})),N={title:n,description:d,course:y,dateCreated:Vt(),dateModified:Vt(),images:m,files:o,userId:t.uid};try{const P=await $n(Ne(oe,"designs"),N),G={...N,id:P.id};v([...h,G]),setTimeout(()=>{F(!1),c()},1e3),R(`${n} has been Added.`),b("success"),z(!0),s(""),i(""),l([]),I([])}catch(P){console.log(P),x("There was an issue adding your design."),f(!0)}};return a.jsxs("div",{className:"small-container",children:[a.jsx("button",{onClick:e,className:"muted-button margin-top-20",children:"← All Designs"}),a.jsx("div",{className:"design-record",children:a.jsxs("form",{onSubmit:T,children:[a.jsx("h1",{className:"designHeader",children:"New Design"}),a.jsx("div",{style:{display:"flex",alignItems:"center"},children:a.jsxs("div",{style:{flexGrow:8,marginRight:"12px"},children:[a.jsx("label",{className:"designTitles",htmlFor:"title",children:"Title"}),a.jsx("input",{id:"title",type:"text",name:"title",value:n,onChange:_=>s(_.target.value),style:{width:"100%"}})]})}),a.jsx("label",{className:"designTitles",htmlFor:"course",children:"Course"}),a.jsx(gn,{id:"course",value:y,onChange:_=>w(_.target.value),fullWidth:!0,children:((t==null?void 0:t.class)||[]).filter(_=>_!=="Public").map(_=>a.jsx(_t,{value:_,children:_},_))}),a.jsx("label",{className:"designTitles",htmlFor:"description",children:"Description"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Objective: What is the goal for this design?"}),a.jsx("li",{children:"Rationale: Why is this new design being done?"}),a.jsx("li",{children:"Selected Target Identified: What is the target for the design being made?"}),a.jsx("li",{children:"Functional Modification: What is being done to this target?"}),a.jsx("li",{children:"Overview/Plan for making the modification: What are the steps to be carried out to meet the objective?"})]}),a.jsx(it,{onChange:i,initialValue:d}),a.jsx(Rt,{ref:A,path:"designs/images",initialImages:k,onImagesUpdated:l,onDelete:_=>l(r.filter(m=>!_.includes(m)))}),a.jsx(Ft,{path:"designs/files",initialFiles:p,onFilesChange:I}),a.jsxs("div",{style:{marginTop:"30px",display:"flex",justifyContent:"flex-end"},children:[a.jsx(Be,{type:"submit",variant:"contained",sx:{fontSize:"1rem",mt:2,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"Add"}),a.jsx(Be,{onClick:()=>F(!1),style:{marginLeft:"12px"},variant:"outlined",sx:{fontSize:"1rem",mt:2,textTransform:"none",color:"currentColor",borderColor:"rgba(255, 0, 0, 0.5)",boxShadow:"none","&:hover":{borderColor:"rgba(255, 0, 0, 0.7)",backgroundColor:"rgba(255, 0, 0, 0.1)",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",color:"currentColor",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, border-color 0.3s ease-in-out, background-color 0.3s ease-in-out"},children:"Cancel"})]})]})}),a.jsxs(Tt,{open:M,onClose:S,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[a.jsx(kt,{id:"alert-dialog-title",children:"Notification"}),a.jsx(At,{children:a.jsx(Xt,{id:"alert-dialog-description",children:u})}),a.jsx(Ut,{children:a.jsx(Be,{onClick:S,autoFocus:!0,children:"Ok"})})]}),a.jsx(St,{open:C,autoHideDuration:1e3,onClose:E,children:a.jsx(wt,{onClose:E,severity:H,sx:{width:"100%"},children:B})})]})},pa=({designId:h,setIsAddingBuild:v,refreshBuilds:F})=>{const[c,e]=$.useState(""),[t,d]=$.useState(""),[i,y]=$.useState([]),[w,n]=$.useState([]),{userDetails:s}=Qt(),r=A=>{y(A)},l=A=>{n(A)};console.log("AddBuild loaded");const[p,I]=$.useState(!1),[k,C]=$.useState(""),[z,B]=$.useState(!1),[R,H]=$.useState(""),[b,M]=$.useState("info");console.log("Adding New Build by user:",s);const f=()=>{I(!1)},u=(A,S)=>{S!=="clickaway"&&B(!1)},x=async A=>{if(A.preventDefault(),!s||!s.uid){console.error("UserDetails object is undefined or missing UID."),C("You must be signed in to add a build."),I(!0);return}if(!t){C("Build description is required."),I(!0);return}const S=i.filter(T=>!T.deleted),E=w.filter(T=>!T.deleted).map(T=>({id:T.id,url:T.url,name:T.name,path:T.path}));try{const T=await $n(Ne(oe,"builds"),{title:c,description:t,design_ID:h,dateCreated:Vt(),userId:s.uid,images:S,files:E});console.log("Build added with ID: ",T.id),console.log("Added New Build by user:",s),H("Your build has been successfully added."),M("success"),B(!0),setTimeout(()=>{e(""),d(""),y([]),n([]),v(!1),F()},1e3)}catch(T){if(console.error("Error adding build: ",T),T instanceof Error){let _=`Failed to add the build. ${T.message}`;T.message==="permission-denied"&&(_="You do not have permission to perform this operation."),H(_),M("error"),B(!0)}else H("Failed to add the build. Please try again later."),M("error"),B(!0)}};return a.jsxs("div",{className:"small-container",children:[a.jsxs("form",{onSubmit:x,children:[a.jsx("label",{className:"buildTitles",htmlFor:"buildTitle",children:"Title"}),a.jsx("input",{id:"buildTitle",type:"text",value:c,onChange:A=>e(A.target.value),style:{width:"100%",marginBottom:"20px"}}),a.jsx("label",{className:"buildTitles",htmlFor:"buildDescription",children:"Description"}),a.jsx(it,{onChange:d,initialValue:t})," ",a.jsx(Rt,{path:`builds/${h}/images`,initialImages:i,onImagesUpdated:r}),a.jsx(Ft,{path:`builds/${h}/files`,initialFiles:w,onFilesChange:l}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[a.jsx("input",{type:"submit",value:"Save"}),a.jsx("button",{style:{marginLeft:"12px"},onClick:()=>v(!1),className:"button muted-button",children:"Cancel"})]})]}),a.jsxs(Tt,{open:p,onClose:f,children:[a.jsx(kt,{children:"Notification"}),a.jsx(At,{children:a.jsx(Xt,{children:k})}),a.jsx(Ut,{children:a.jsx(Be,{onClick:f,children:"OK"})})]}),a.jsx(St,{open:z,autoHideDuration:6e3,onClose:u,children:a.jsx(wt,{onClose:u,severity:b,sx:{width:"100%"},children:R})})]})},ba=({designId:h,buildId:v,refreshTests:F,setAddingTestIdForBuild:c})=>{const[e,t]=$.useState(""),[d,i]=$.useState(""),[y,w]=$.useState(""),[n,s]=$.useState(""),[r,l]=$.useState([]),[p,I]=$.useState([]),{userDetails:k}=Qt();console.log("AddTest loaded");const[C,z]=$.useState(!1),[B,R]=$.useState(""),[H,b]=$.useState(!1),[M,f]=$.useState(""),[u,x]=$.useState("info"),A=E=>{I(E)},S=async()=>{if(!d){R("Test description cannot be empty!"),z(!0);return}const E=r.filter(_=>!_.deleted),T=p.filter(_=>!_.deleted).map(_=>({id:_.id,url:_.url,name:_.name,path:_.path}));try{await $n(Ne(oe,"tests"),{title:e,build_ID:v,design_ID:h,dateCreated:Vt(),description:d,results:y,conclusions:n,userId:k==null?void 0:k.uid,images:E,files:T}),setTimeout(()=>{F(v),t(""),i(""),w(""),s(""),l([]),I([]),c(!1)},1e3),f("Test added successfully"),x("success"),b(!0)}catch(_){console.error("Error adding test: ",_),f("Failed to add the test"),x("error"),b(!0)}};return a.jsxs("div",{children:[a.jsx("label",{className:"testTitles",htmlFor:"testTitle",children:"Title"}),a.jsx("input",{id:"testTitle",type:"text",value:e,onChange:E=>t(E.target.value),style:{width:"100%",marginBottom:"20px"}}),a.jsx("label",{className:"testTitles",htmlFor:"testDescription",children:"Description"}),a.jsx(it,{onChange:i,initialValue:d}),a.jsx("label",{className:"testTitles",htmlFor:"testResults",children:"Results"}),a.jsx(it,{onChange:w,initialValue:y}),a.jsx("label",{className:"testTitles",htmlFor:"testConclusions",children:"Conclusions"}),a.jsx(it,{onChange:s,initialValue:n}),a.jsx(Rt,{path:`tests/${v}/images`,initialImages:r,onImagesUpdated:E=>{l(E)}}),a.jsx(Ft,{path:`tests/${v}/files`,initialFiles:p,onFilesChange:A}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[a.jsx("button",{onClick:S,children:"Save"}),a.jsx("button",{style:{marginLeft:"12px"},onClick:()=>c(!1),className:"button muted-button",children:"Cancel"})]}),a.jsxs(Tt,{open:C,onClose:()=>z(!1),children:[a.jsx(kt,{children:"Notification"}),a.jsx(At,{children:a.jsx(Xt,{children:B})}),a.jsx(Ut,{children:a.jsx(Be,{onClick:()=>z(!1),children:"OK"})})]}),a.jsx(St,{open:H,autoHideDuration:6e3,onClose:()=>b(!1),children:a.jsx(wt,{onClose:()=>b(!1),severity:u,sx:{width:"100%"},children:M})})]})};var Jn={},xa=mt;Object.defineProperty(Jn,"__esModule",{value:!0});var hn=Jn.default=void 0,va=xa(ht()),ya=a;hn=Jn.default=(0,va.default)((0,ya.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff");const Yt=h=>h&&h instanceof zn?h.toDate().toLocaleString():"",Ta=({selectedDesign:h,setIsEditing:v,getDesigns:F,onReturnToDashboard:c})=>{const{userDetails:e,loading:t}=Qt(),d=h.id,i=h.userId===(e==null?void 0:e.uid);console.log("Edit page loaded"),console.log("Design ID:",d),console.log("Editing Design by user:",e);const[y,w]=$.useState(""),[n,s]=$.useState(h.description),[r,l]=$.useState(h.course||""),[p,I]=$.useState(Yt(h.dateCreated)),[k,C]=$.useState(Yt(h.dateModified)),[z,B]=$.useState([]),[R,H]=$.useState([]),b=$.useRef(null),[M,f]=$.useState(!1),[u,x]=$.useState([]),[A,S]=$.useState({}),[E,T]=$.useState({}),[_,m]=$.useState({}),o=$.useRef(null),[N,D]=$.useState({}),[P,G]=$.useState({}),[W,q]=$.useState({}),[V,L]=$.useState(!1),[J,ue]=$.useState({}),[ie,re]=$.useState({}),[le,ce]=$.useState({}),[fe,ke]=$.useState({}),[Te,me]=$.useState({}),ye=$.useRef(null),[de,he]=$.useState({}),[pe,Se]=$.useState({}),[be,je]=$.useState({}),[xe,ne]=$.useState(!1),[we,Ce]=$.useState(""),[at,Ae]=$.useState(()=>{}),[Ye,te]=$.useState(!1),[Ue,se]=$.useState(""),[Oe,ee]=$.useState("info"),[Ee,Ie]=$.useState({design:!1,builds:!1,tests:!1}),gt=async g=>{if(g.preventDefault(),!n){Ce("All fields are required."),ne(!0);return}console.log("About to check image deletions",b.current),console.log(b.current),console.log(z.some(Y=>Y.deleted)),b.current&&z.some(Y=>Y.deleted)&&(console.log("Committing deletions"),await b.current.commitDeletions());const U=z.filter(Y=>!Y.deleted);R.some(Y=>Y.deleted)&&await ot();const O=R.filter(Y=>!Y.deleted);let Q={title:y,description:n,course:r,dateModified:Vt(),images:U.map(Y=>({url:Y.url,title:Y.title,path:Y.path})),files:O.map(Y=>({id:Y.id,url:Y.url,name:Y.name,path:Y.path})),userId:e.uid};try{await ut(De(oe,"designs",d),Q,{merge:!0}),se("Your design has been updated."),ee("success"),te(!0);const Y=zn.now();C(Yt(Y))}catch(Y){console.error("Error updating design:",Y),se("There was an issue updating your design."),ee("error"),te(!0)}Ie(Y=>({...Y,design:!1}))};$.useEffect(()=>{h&&(s(h.description||""),w(h.title||""),l(h.course||""),(async()=>{const U=De(oe,"designs",d),O=await ps(U);if(O.exists()){const Q=O.data();console.log("Fetched images:",Q.images),console.log("Fetched files:",Q.files),B(Q.images||[]),H(Q.files||[]),I(Yt(Q.dateCreated)),C(Yt(Q.dateModified))}})())},[h,d]);const pt=g=>{const U=z.filter(Q=>!g.some(Y=>Y.path===Q.path));console.log("Remaining images after deletion:",U),B(U);const O=U.map(Q=>({url:Q.url,title:Q.title,path:Q.path}));ut(De(oe,"designs",d),{images:O},{merge:!0}).then(()=>console.log("Firestore successfully updated")).catch(Q=>console.error("Failed to update Firestore:",Q))},nt=g=>{JSON.stringify(z)!==JSON.stringify(g)&&(B(g),console.log("Updated images received:",g))},ot=async()=>{const g=R.filter(U=>U.deleted);if(console.log("Files to delete:",g),g.length>0){const U=jt(),O=g.map(Q=>{const Y=It(U,Q.path);return dn(Y)});try{await Promise.all(O),console.log("Files deleted successfully");const Q=R.filter(Y=>!Y.deleted);H(Q),await En(De(oe,"designs",h.id),{files:Q.map(Y=>({id:Y.id,url:Y.url,name:Y.name,path:Y.path}))}),se("Deleted files have been permanently removed."),ee("success"),te(!0)}catch(Q){console.error("Failed to delete files: ",Q),se("Failed to delete files."),ee("error"),te(!0)}}},Ot=async g=>{var Y,Z;try{await Kt(g)}catch(X){console.error("Error deleting files:",X),se("Failed to delete build files."),ee("error"),te(!0)}const U=((Y=E[g])==null?void 0:Y.filter(X=>!X.deleted).map(({url:X,path:Fe,title:ve})=>({url:X,path:Fe,title:ve})))||[],O=((Z=_[g])==null?void 0:Z.filter(X=>!X.deleted).map(X=>({id:X.id,url:X.url,name:X.name,path:X.path})))||[],Q={};U.length>0&&(Q.images=U),O.length>0&&(Q.files=O),A[g]!==void 0&&(Q.description=A[g]);try{const X=De(oe,"builds",g);await ut(X,Q,{merge:!0}),se("Your build has been updated."),ee("success"),te(!0),$e(),Ie(Fe=>({...Fe,builds:!1}))}catch(X){console.error("Error updating build:",X),se("Failed to update build."),ee("error"),te(!0)}},ge=(g,U)=>{G(O=>({...O,[g]:U}))},Re=(g,U)=>{S(O=>({...O,[g]:U})),Ie(O=>({...O,builds:!0}))},Ke=async g=>{const U=P[g];try{const O=De(oe,"builds",g);await ut(O,{title:U},{merge:!0}),G(Q=>{const Y={...Q};return delete Y[g],Y}),$e()}catch(O){console.error("Failed to save build title:",O)}},$e=async()=>{if(!e){console.log("User details not loaded yet");return}try{console.log("Refreshing builds for user UID:",e==null?void 0:e.uid),console.log("Selected design ID for query:",h==null?void 0:h.id);let g;e.isAdmin?g=We(Ne(oe,"builds"),_e("design_ID","==",d),rt("dateCreated")):g=We(Ne(oe,"builds"),_e("design_ID","==",d),_e("userId","==",e.uid),rt("dateCreated")),console.log("Builds query details:",JSON.stringify(g,null,2));const U=await ft(g);console.log("Builds snapshot details:",JSON.stringify(U.docs.map(Q=>Q.data()),null,2)),console.log("Builds query successful, number of builds fetched: ",U.docs.length);const O=U.docs.map(Q=>(console.log("Build doc path: ",Q.ref.path),{id:Q.id,...Q.data()}));x(O),console.log("New builds state after refresh:",O)}catch(g){console.error("Error refreshing builds:",g),g.code==="permission-denied"?console.error("Permission denied when trying to refresh builds:",g):console.error("An unexpected error occurred when trying to refresh builds:",g)}},ct=(g,U)=>{const O=De(oe,"builds",g),Q=E[g].filter(Z=>!U.some(X=>X.path===Z.path));T(Z=>({...Z,[g]:Q}));const Y=Q.map(Z=>({url:Z.url,title:Z.title,path:Z.path}));ut(O,{images:Y},{merge:!0}).then(()=>{console.log("Firestore successfully updated for build images"),se("Build Image deletions updated."),ee("success")}).catch(Z=>{console.error("Failed to update build images in Firestore:",Z),se("Failed to update build image deletions."),ee("error")}),te(!0)},qe=async g=>{const U=We(Ne(oe,"tests"),_e("build_ID","==",g),_e("userId","==",e.uid)),O=await ft(U);for(const Q of O.docs)await Dt(De(oe,"tests",Q.id));await Dt(De(oe,"builds",g)),await $e(),se("Build and its tests (if any) deleted successfully."),ee("success"),te(!0)},Ve=g=>{Ce("Are you sure you want to delete this build and all associated tests? This action cannot be undone."),Ae(()=>()=>qe(g)),ne(!0)},Zt=(g,U)=>{T(O=>({...O,[g]:U}))},Mt=(g,U)=>{m(O=>({...O,[g]:U}))},Kt=async g=>{var O;const U=((O=_[g])==null?void 0:O.filter(Q=>Q.deleted))||[];if(console.log("Build files to delete:",U),U.length>0){const Q=jt(),Y=U.map(Z=>{const X=It(Q,Z.path);return dn(X)});try{await Promise.all(Y),console.log("Build files deleted successfully");const Z=_[g].filter(X=>!X.deleted);m(X=>({...X,[g]:Z})),await En(De(oe,"builds",g),{files:Z.map(X=>({id:X.id,url:X.url,name:X.name,path:X.path}))}),console.log("Firestore successfully updated to remove deleted files"),se("Deleted build files have been permanently removed."),ee("success"),te(!0)}catch(Z){console.error("Failed to delete build files: ",Z),se("Failed to delete build files."),ee("error"),te(!0)}}},An=async(g,U)=>{var Z;try{await nn(g)}catch(X){console.error("Error deleting files:",X),se("Failed to delete build files."),ee("error"),te(!0)}const O={},Q=fe[g].filter(X=>!X.deleted).map(({url:X,path:Fe,title:ve})=>({url:X,path:Fe,title:ve})),Y=((Z=Te[g])==null?void 0:Z.filter(X=>!X.deleted).map(X=>({id:X.id,url:X.url,name:X.name,path:X.path})))||[];J[g]!==void 0&&(O.description=J[g]),ie[g]!==void 0&&(O.results=ie[g]),le[g]!==void 0&&(O.conclusions=le[g]),O.images=Q,O.files=Y;try{const X=De(oe,"tests",g);await ut(X,O,{merge:!0}),se("Your test has been updated."),ee("success"),te(!0),xt(U)}catch(X){console.error(`Error updating test ID: ${g}:`,X),se("There was an issue updating your test."),ee("error"),te(!0)}},Qe=(g,U)=>{Se(O=>({...O,[g]:U}))},bt=async(g,U)=>{const O=pe[g],Q=De(oe,"tests",g);await ut(Q,{title:O},{merge:!0}),Se(Y=>{const Z={...Y};return delete Z[g],Z}),xt(U)},Jt=(g,U)=>{console.log(`Updating description for test ID ${g}:`,U),ue(O=>({...O,[g]:U})),Ie(O=>({...O,tests:!0}))},en=(g,U)=>{console.log(`Updating results for test ID ${g}:`,U),re(O=>({...O,[g]:U})),Ie(O=>({...O,tests:!0}))},tn=(g,U)=>{ce(O=>({...O,[g]:U})),Ie(O=>({...O,tests:!0}))};$.useEffect(()=>{!t&&e&&(async()=>{if(!e)return;let U;e.isAdmin?U=We(Ne(oe,"builds"),_e("design_ID","==",d),rt("dateCreated")):U=We(Ne(oe,"builds"),_e("design_ID","==",d),_e("userId","==",e.uid),rt("dateCreated"));const O=await ft(U);let Q=[],Y={},Z={};for(const X of O.docs){const Fe=X.data(),ve=X.id;Q.push({id:ve,...Fe,images:Fe.images||[],files:Fe.files||[]}),Z[ve]=!0;let Ct;e.isAdmin?Ct=We(Ne(oe,"tests"),_e("build_ID","==",ve),rt("dateCreated")):Ct=We(Ne(oe,"tests"),_e("build_ID","==",ve),_e("userId","==",e.uid),rt("dateCreated"));const sn=await ft(Ct);let er=[],wn={},Cn={};for(const dt of sn.docs){const lt=dt.data();er.push({id:dt.id,...lt}),wn[dt.id]=lt.images||[],Cn[dt.id]=lt.files||[]}Y[ve]=er,ke(dt=>{let lt={...dt};for(const Pt in wn)lt[Pt]=wn[Pt];return lt}),me(dt=>{let lt={...dt};for(const Pt in Cn)lt[Pt]=Cn[Pt];return lt})}x(Q),q(Y),je(Z)})()},[t,e,h.id,d]);const xt=async g=>{if(!e){console.log("User details not loaded yet");return}try{let U;e.isAdmin?U=We(Ne(oe,"tests"),_e("build_ID","==",g),rt("dateCreated")):U=We(Ne(oe,"tests"),_e("build_ID","==",g),_e("userId","==",e.uid),rt("dateCreated"));const Q=(await ft(U)).docs.map(X=>({id:X.id,...X.data(),images:X.data().images||[],files:X.data().files||[]}));q(X=>({...X,[g]:Q}));let Y={},Z={};Q.forEach(X=>{Y[X.id]=X.images,Z[X.id]=X.files}),ke(Y),me(Z)}catch(U){console.error("Error fetching tests:",U)}},Je=(g,U)=>{const O=De(oe,"tests",g),Q=fe[g].filter(Z=>!U.includes(Z));ke(Z=>({...Z,[g]:Q}));const Y=Q.map(({url:Z,path:X,title:Fe})=>({url:Z,path:X,title:Fe}));ut(O,{images:Y},{merge:!0}).then(()=>{console.log("Firestore successfully updated for test images"),se("Test Image deletions updated."),ee("success")}).catch(Z=>{console.error("Failed to update test images in Firestore:",Z),se("Failed to update test image deletions."),ee("error")}),te(!0)},Nt=(g,U)=>{ke(O=>({...O,[g]:U}))},Lt=(g,U)=>{me(O=>({...O,[g]:U}))},nn=async g=>{var O;const U=((O=Te[g])==null?void 0:O.filter(Q=>Q.deleted))||[];if(U.length>0){const Q=jt(),Y=U.map(Z=>{const X=It(Q,Z.path);return dn(X)});try{await Promise.all(Y);const Z=Te[g].filter(X=>!X.deleted);me(X=>({...X,[g]:Z})),await En(De(oe,"tests",g),{files:Z.map(X=>({id:X.id,url:X.url,name:X.name,path:X.path}))}),se("Deleted test files have been permanently removed."),ee("success"),te(!0)}catch(Z){console.error("Failed to delete test files: ",Z),se("Failed to delete test files."),ee("error"),te(!0)}}},rn=async(g,U)=>{await Dt(De(oe,"tests",g)),await xt(U),se("Test deleted successfully."),ee("success"),te(!0)},Sn=(g,U)=>{Ce("Are you sure you want to delete this test? This action cannot be undone."),Ae(()=>()=>rn(g,U)),ne(!0)},K=g=>{je(U=>({...U,[g]:!U[g]}))},j=()=>{const g=Object.entries(Ee).filter(([O,Q])=>Q).map(([O])=>O).join(", ");if(!g.length){c();return}const U=`You have unsaved changes in the following sections: ${g}. Are you sure you want to leave?`;Ce(U),Ae(()=>()=>{Ie({design:!1,builds:!1,tests:!1}),c()}),ne(!0)};return $.useEffect(()=>{const g=U=>{Object.values(Ee).some(Q=>Q)&&(U.preventDefault(),U.returnValue="")};return window.addEventListener("beforeunload",g),()=>window.removeEventListener("beforeunload",g)},[Ee]),a.jsxs("div",{className:"small-container",children:[a.jsx("button",{onClick:()=>{Object.values(Ee).some(U=>U)?j():c()},className:"muted-button margin-top-20",children:"← All Designs"}),a.jsx("div",{className:"design-record",children:a.jsxs("form",{onSubmit:gt,children:[a.jsx("h1",{className:"designHeader",style:{marginBottom:"20px"},children:"Design Document"}),a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsxs("div",{style:{flexGrow:8,marginRight:"12px"},children:[a.jsx("label",{className:"designTitles",htmlFor:"title",children:"Title"}),a.jsx("input",{id:"title",type:"text",name:"title",value:y,onChange:g=>{w(g.target.value),Ie(U=>({...U,design:!0}))},style:{width:"100%"}})]}),a.jsxs("div",{style:{flexGrow:2},children:[a.jsx("label",{className:"designTitles",htmlFor:"dateCreated",children:"Created"}),a.jsx("input",{id:"dateCreated",type:"text",name:"dateCreated",value:p||"",readOnly:!0,style:{width:"100%"}})]}),a.jsxs("div",{style:{flexGrow:2,marginLeft:"12px"},children:[a.jsx("label",{className:"designTitles",htmlFor:"dateModified",children:"Last Edited"}),a.jsx("input",{id:"dateModified",type:"text",name:"dateModified",value:k||"",readOnly:!0,style:{width:"100%"}})]})]}),a.jsx("label",{className:"designTitles",htmlFor:"course",children:"Course"}),a.jsx(gn,{id:"course",value:r,onChange:g=>{l(g.target.value),Ie(U=>({...U,design:!0}))},fullWidth:!0,children:a.jsx(_t,{value:r,children:r})}),a.jsx("label",{className:"designTitles",htmlFor:"description",children:"Description"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Objective: What is the goal for this design?"}),a.jsx("li",{children:"Rationale: Why is this new design being done?"}),a.jsx("li",{children:"Selected Target: What is the target for the design being made?"}),a.jsx("li",{children:"Functional Modification: What is being done to this target?"}),a.jsx("li",{children:"Overview/Plan for making the modification: What are the steps to be carried out to meet the objective?"})]}),a.jsx(it,{initialValue:n,onChange:g=>{s(g),Ie(U=>({...U,design:!0}))}}),a.jsx(Rt,{ref:b,path:`designs/${h.id}/images`,initialImages:z,onImagesUpdated:nt,onDelete:pt,isOwnDesign:i}),a.jsx(Ft,{path:`designs/${h.id}/files`,initialFiles:R,onFilesChange:H,isOwnDesign:i}),i&&a.jsxs("div",{style:{marginTop:"30px",display:"flex",justifyContent:"flex-end"},children:[a.jsx("input",{type:"submit",value:"Update"}),a.jsx("button",{style:{marginLeft:"12px"},className:"muted-button",type:"button",onClick:()=>v(!1),children:"Cancel"})]})]})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex-space-between",children:[a.jsx("h2",{className:"buildsHeader",children:"Builds"}),i&&a.jsxs("button",{className:"button muted-button",onClick:()=>{f(!0),setTimeout(()=>{o.current&&o.current.scrollIntoView({behavior:"smooth"})},100)},style:{marginTop:"20px"},children:[a.jsx("span",{role:"img","aria-label":"Add Build",children:"➕"})," Build"]})]}),u.map((g,U)=>a.jsxs("div",{className:"build-record",children:[a.jsxs("div",{className:"flex-space-between align-items-center",children:[a.jsx("div",{children:P[g.id]!==void 0?a.jsx(pn,{variant:"outlined",size:"small",fullWidth:!0,value:P[g.id],onChange:O=>ge(g.id,O.target.value),onBlur:()=>Ke(g.id),autoFocus:!0,InputProps:{endAdornment:a.jsx(Xe,{onClick:()=>Ke(g.id),size:"small",children:a.jsx(Pn,{})})}}):a.jsx("div",{className:"buildTitle",onClick:()=>G(O=>({...O,[g.id]:g.title||`Build ${U+1}`})),style:{cursor:"pointer"},children:g.title||`Build ${U+1}`})}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>D(O=>({...O,[g.id]:!O[g.id]})),className:"button muted-button",style:{border:"none",background:"none"},children:N[g.id]?a.jsx(hn,{}):a.jsx(jn,{})}),i&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"button muted-button",style:{border:"none",background:"none"},onClick:()=>Ve(g.id),children:a.jsx(qt,{})}),a.jsxs("button",{className:"button muted-button",onClick:()=>{L(g.id),setTimeout(()=>{ye.current&&ye.current.scrollIntoView({behavior:"smooth"})},100)},children:[a.jsx("span",{role:"img","aria-label":"Add Test",children:"➕"})," Test"]})]})]})]}),N[g.id]&&a.jsxs(a.Fragment,{children:[a.jsx(it,{initialValue:A[g.id]||g.description,onChange:O=>{Re(g.id,O)}}),a.jsx(Rt,{path:`builds/${g.id}/images`,initialImages:g.images,onImagesUpdated:O=>Zt(g.id,O),onDelete:O=>ct(g.id,O),isOwnDesign:i}),a.jsx(Ft,{path:`builds/${g.id}/files`,initialFiles:g.files,onFilesChange:O=>Mt(g.id,O),isOwnDesign:i}),i&&a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{onClick:()=>Ot(g.id),children:"Update"})}),a.jsx("div",{children:W[g.id]&&W[g.id].length>0&&a.jsx("button",{onClick:()=>K(g.id),className:"button muted-button",style:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"12px",marginBottom:"12px"},children:be[g.id]?a.jsxs(a.Fragment,{children:[a.jsx(jn,{style:{marginRight:"8px"}}),"Tests"]}):a.jsxs(a.Fragment,{children:[a.jsx(hn,{style:{marginRight:"8px"}}),"Tests"]})})}),!be[g.id]&&W[g.id]&&W[g.id].map((O,Q)=>a.jsxs("div",{className:"test-record",children:[a.jsxs("div",{className:"flex-space-between align-items-center",children:[a.jsx("div",{children:pe[O.id]!==void 0?a.jsx(pn,{variant:"outlined",size:"small",fullWidth:!0,value:pe[O.id],onChange:Y=>Qe(O.id,Y.target.value),onBlur:()=>bt(O.id,g.id),autoFocus:!0,InputProps:{endAdornment:a.jsx(Xe,{onClick:()=>bt(O.id,g.id),size:"small",children:a.jsx(Pn,{})})}}):a.jsx("div",{className:"testTitle",onClick:()=>Se(Y=>({...Y,[O.id]:O.title||`Test ${Q+1}`})),style:{cursor:"pointer"},children:O.title||`Test ${Q+1}`})}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>he(Y=>({...Y,[O.id]:!Y[O.id]})),className:"button muted-button",style:{border:"none",background:"none"},children:de[O.id]?a.jsx(hn,{}):a.jsx(jn,{})}),i&&a.jsx("button",{className:"button muted-button",style:{border:"none",background:"none"},onClick:()=>Sn(O.id,g.id),children:a.jsx(qt,{})})]})]}),de[O.id]&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"testTitles",children:"Description"}),a.jsx(it,{initialValue:J[O.id]||O.description,onChange:Y=>{Jt(O.id,Y)}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"testTitles",children:"Results"}),a.jsx(it,{initialValue:ie[O.id]||O.results,onChange:Y=>{en(O.id,Y)}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"testTitles",children:"Conclusions"}),a.jsx(it,{initialValue:le[O.id]||O.conclusions,onChange:Y=>{tn(O.id,Y)}})]}),a.jsxs("div",{children:[a.jsx(Rt,{path:`tests/${O.id}/images`,initialImages:fe[O.id]||[],onImagesUpdated:Y=>Nt(O.id,Y),onDelete:Y=>Je(O.id,Y),isOwnDesign:i}),a.jsx(Ft,{path:`tests/${O.id}/files`,initialFiles:Te[O.id]||[],onFilesChange:Y=>Lt(O.id,Y),isOwnDesign:i})]}),i&&a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{onClick:()=>An(O.id,g.id),children:"Update"})})]})]},O.id))]}),V===g.id&&a.jsxs("div",{className:"new-test-record",ref:ye,children:[a.jsx("h3",{className:"newTestHeader",children:"New Test"}),a.jsx(ba,{designId:h.id,buildId:g.id,refreshTests:()=>xt(g.id),setAddingTestIdForBuild:L,onImagesUpdated:O=>Nt(g.id,O),onFilesChange:O=>Lt(g.id,O)})]})]},g.id)),a.jsx("div",{children:M&&a.jsxs("div",{className:"new-build-record",ref:o,children:[a.jsx("h3",{className:"newBuildHeader",children:"New Build"}),a.jsx(pa,{designId:h.id,setIsAddingBuild:f,refreshBuilds:$e,onImagesUpdated:g=>Zt(build.id,g),onFilesChange:g=>Mt(build.id,g)})]})})]}),a.jsxs(Tt,{open:xe,onClose:()=>ne(!1),children:[a.jsx(kt,{children:"Confirmation Required"}),a.jsx(At,{children:a.jsx(Xt,{children:we})}),a.jsxs(Ut,{children:[a.jsx(Be,{onClick:()=>ne(!1),children:"Cancel"}),a.jsx(Be,{onClick:()=>{at(),ne(!1)},autoFocus:!0,children:"Confirm"})]})]}),a.jsx(St,{open:Ye,autoHideDuration:6e3,onClose:()=>te(!1),children:a.jsx(wt,{onClose:()=>te(!1),severity:Oe,sx:{width:"100%"},children:Ue})})]})},Aa=()=>{const{userDetails:h,loading:v}=Qt();console.log("Dashboard loaded");const[F,c]=$.useState([]),[e,t]=$.useState([]),[d,i]=$.useState(null),[y,w]=$.useState(!1),[n,s]=$.useState(!1),[r,l]=$.useState(!1),[p,I]=$.useState(""),[k,C]=$.useState(""),[z,B]=$.useState(!1),[R,H]=$.useState(null),[b,M]=$.useState(!1),[f,u]=$.useState(""),[x,A]=$.useState("info"),S=()=>{s(!1),w(!1),i(null),E()},E=$.useCallback(async()=>{if(!h)return;let o;const N=[],D=[];if(h.isAdmin)if(h.class&&h.class.length>0)o=We(Ne(oe,"designs"),_e("course","in",h.class),rt("dateCreated","desc"));else{c([]),t([]);return}else o=We(Ne(oe,"designs"),_e("userId","==",h.uid),rt("dateCreated","desc"));(await ft(o)).forEach(G=>{const W=G.data(),q={id:G.id,title:W.title,description:W.description,course:W.course,dateCreated:W.dateCreated,dateModified:W.dateModified,userId:W.userId,images:W.images||[],files:W.files||[]};W.userId===h.uid?N.push(q):D.push(q)}),c(N),t(D)},[h,oe]);$.useEffect(()=>{!v&&h&&E()},[h,v,E]);const T=o=>{const N=[...F,...e].find(D=>D.id===o);i(N||null),s(!0)},_=o=>{H(o),I("Are you sure you want to delete this design? This action cannot be undone."),l(!0)},m=async()=>{if(R)if(k!==(h==null?void 0:h.uid))u("User ID confirmation failed. Enter the correct User ID."),A("error"),M(!0);else try{const o=We(Ne(oe,"builds"),_e("design_ID","==",R),_e("userId","==",h.uid)),N=await ft(o);for(const D of N.docs){const P=D.id,G=We(Ne(oe,"tests"),_e("build_ID","==",P),_e("userId","==",h.uid)),W=await ft(G);for(const q of W.docs)await Dt(De(oe,"tests",q.id));await Dt(De(oe,"builds",P))}await Dt(De(oe,"designs",R)),c(D=>D.filter(P=>P.id!==R)),t(D=>D.filter(P=>P.id!==R)),u("Your design and its associated builds and tests have been deleted."),A("success"),M(!0)}catch(o){console.error("Error deleting design, builds, and tests: ",o),u("There was an issue deleting your design and its associated builds and tests."),A("error"),M(!0)}finally{C(""),B(!1),H(null)}};return a.jsxs("div",{className:"container",children:[!y&&!n&&a.jsxs(a.Fragment,{children:[a.jsx(As,{setIsAdding:w}),(h==null?void 0:h.isAdmin)&&a.jsxs(a.Fragment,{children:[a.jsx("h2",{children:"Educator Designs"}),a.jsx(In,{designs:F,handleEdit:T,handleDelete:_,isAdmin:!0,userDetails:h,showUserIdColumn:!0}),a.jsx("h2",{children:"Student Designs"}),a.jsx(In,{designs:e,handleEdit:T,handleDelete:_,isAdmin:!1,userDetails:h,showUserIdColumn:!0})]}),!(h!=null&&h.isAdmin)&&a.jsx(In,{designs:F,handleEdit:T,handleDelete:_,isAdmin:!1,userDetails:h,showUserIdColumn:!1})]}),y&&a.jsx(ga,{designs:F,setDesigns:c,setIsAdding:w,getDesigns:E,onReturnToDashboard:S}),n&&a.jsx(Ta,{designs:F,selectedDesign:d,setDesigns:c,setIsEditing:s,getDesigns:E,onReturnToDashboard:S}),a.jsxs(Tt,{open:r,onClose:()=>l(!1),PaperProps:{style:{minWidth:500}},children:[a.jsx(kt,{children:"Confirm Deletion"}),a.jsx(At,{children:a.jsx(Xt,{children:p})}),a.jsxs(Ut,{children:[a.jsx(Be,{onClick:()=>l(!1),children:"No, cancel"}),a.jsx(Be,{onClick:()=>{B(!0),l(!1)},color:"primary",children:"Yes, delete it"})]})]}),a.jsxs(Tt,{open:z,onClose:()=>B(!1),PaperProps:{style:{minWidth:500}},children:[a.jsx(kt,{children:"Confirm Your User ID"}),a.jsx(At,{children:a.jsx(pn,{autoFocus:!0,margin:"dense",id:"userId-confirm",label:"User ID",type:"text",fullWidth:!0,variant:"outlined",value:k,onChange:o=>C(o.target.value)})}),a.jsxs(Ut,{children:[a.jsx(Be,{onClick:()=>B(!1),children:"No, cancel"}),a.jsx(Be,{onClick:m,color:"primary",children:"Confirm"})]})]}),a.jsx(St,{open:b,autoHideDuration:6e3,onClose:()=>M(!1),children:a.jsx(wt,{onClose:()=>M(!1),severity:x,sx:{width:"100%"},children:f})})]})},Ca=bs.memo(Aa);export{Ca as default};
