import{X as v,Y as U,b as d,j as e,K as i,L as x,T as o,Z as g,M as ne,$ as ie,S as L,N as G,aL as A,ad as _,au as q,ae as z,av as O,aw as J,aC as K,aJ as ae,aE as te,aF as P,aH as T,aG as w,az as N,aM as le,aN as oe,H as y,a7 as p,a8 as $,a9 as B}from"./index-B4Dcnjwa.js";import{d as H}from"./Visibility-DDQKiCD-.js";const re=()=>{const{userDetails:s}=v(),l=U(),[a,r]=d.useState(!1),[c,t]=d.useState(!1),u=()=>{s!=null&&s.uid?navigator.clipboard.writeText(s.uid).then(()=>{r(!0),t(!0)}).catch(m=>{console.error("Could not copy text: ",m)}):console.error("User details are null or undefined")},b=(m,j)=>{j!=="clickaway"&&r(!1)},h=()=>{l("/")};return e.jsxs(i,{children:[e.jsx(i,{sx:{display:"flex",alignItems:"center"},children:e.jsx(x,{variant:"text",onClick:h,sx:{mr:2},children:"← Home Page"})}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[(s==null?void 0:s.isAdmin)&&e.jsx(g,{label:"Educator (Admin User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),!(s!=null&&s.isAdmin)&&e.jsx(g,{label:"Student (Regular User)",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#bbdefb",color:"#1e88e5",mr:1}}),s&&e.jsx(ne,{title:c?"Copied!":"Click to Copy",enterDelay:300,leaveDelay:200,children:e.jsx(g,{label:`User ID: ${s.uid}`,variant:"outlined",onClick:u,sx:{borderRadius:"15px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",mr:2}})}),e.jsx(ie,{})]}),e.jsx(L,{open:a,autoHideDuration:6e3,onClose:b,children:e.jsx(G,{onClose:b,severity:"success",sx:{width:"100%"},children:"User ID copied to clipboard!"})})]})]})},de=()=>{const s=U();return e.jsx(x,{variant:"contained",color:"primary",onClick:()=>s("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},ce=({materialId:s,open:l,onClose:a,onDelete:r})=>{const c=A(),t=async()=>{const u=K(c,"materials",s);await ae(u),r(),a()};return e.jsxs(_,{open:l,onClose:a,children:[e.jsx(q,{children:"Delete Material"}),e.jsx(z,{children:e.jsx(O,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(J,{children:[e.jsx(x,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(x,{onClick:t,color:"secondary",children:"Delete"})]})]})},xe=({materialId:s,onClick:l})=>e.jsx(x,{variant:"contained",color:"error",onClick:()=>l(s),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),ue=({materialId:s,open:l,onClose:a,onUnpublish:r})=>{const c=A(),t=async()=>{const u=K(c,"materials",s);await te(u,{published:!1}),r(),a()};return e.jsxs(_,{open:l,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(q,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(z,{children:e.jsx(O,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(J,{children:[e.jsx(x,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(x,{onClick:t,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},he=({selectedCourse:s,onCourseChange:l})=>{const{userDetails:a}=v(),[r,c]=d.useState(["Public-Source"]);return d.useEffect(()=>{if(a!=null&&a.class){const t=Array.from(new Set(["Public-Source",...a.class]));c(t)}else c(["Public-Source"])},[a]),e.jsx(i,{sx:{display:"flex",gap:2,mb:2},children:r.map(t=>e.jsx(x,{variant:s===t?"contained":"outlined",onClick:()=>l(t),children:t},t))})},pe=()=>{const{userDetails:s}=v(),l=A(),[a,r]=d.useState([]),[c,t]=d.useState(!0),[u,b]=d.useState(!1),[h,m]=d.useState("Public-Source"),[j,M]=d.useState(null),[f,I]=d.useState({open:!1,materialId:null}),[D,k]=d.useState(null),C=U();d.useEffect(()=>{if(!s)return;t(!0);const n=s.isAdmin?P(N(l,"materials"),w("course","==",h),T("timestamp","desc")):P(N(l,"materials"),w("course","==",h),w("published","==",!0),T("timestamp","desc")),ee=le(n,S=>{const se=S.docs.map(W=>({id:W.id,...W.data()}));r(se),t(!1)},S=>{console.error(S),k("Failed to fetch materials"),t(!1)});return()=>ee()},[l,s,h]);const F=n=>{M(n),b(!0)},X=()=>{b(!1),M(null)},Y=()=>{r(a.filter(n=>n.id!==j))},Z=n=>{I({open:!0,materialId:n})},Q=()=>{r(a.map(n=>n.id===f.materialId?{...n,published:!1}:n))},V=()=>{I({open:!1,materialId:null})};if(c)return e.jsx(oe,{});const R=a.filter(n=>!n.published),E=a.filter(n=>n.published);return e.jsxs(i,{sx:{width:"100%"},children:[e.jsx(he,{selectedCourse:h,onCourseChange:n=>{t(!0),m(n)}}),(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(i,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(o,{variant:"h6",sx:{fontWeight:"bold",color:"#F57F17"},children:"Saved"})}),e.jsx(y,{container:!0,spacing:3,children:R.length===0?e.jsx(o,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):R.map(n=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(i,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(i,{children:n.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>C(`/view-material/${n.id}`),"aria-label":"view",children:e.jsx(H,{})}),e.jsx(o,{variant:"h6",children:n.title||"Untitled"})]}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(o,{variant:"body2",color:"textSecondary",children:["Date: ",n.timestamp.toDate().toLocaleString()]}),e.jsxs(o,{variant:"body2",color:"textSecondary",children:["Status: ",n.published?"Published":"Unpublished"]})]}),e.jsx(i,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>C(`/edit-material/${n.id}`),"aria-label":"edit",children:e.jsx($,{})}),e.jsx(p,{onClick:()=>F(n.id),"aria-label":"delete",children:e.jsx(B,{})})]})}),e.jsx(i,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(o,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:n.course||"N/A"})})]})},n.id))})]}),e.jsx(i,{sx:{backgroundColor:"#C8E6C9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(o,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(y,{container:!0,spacing:3,children:E.length===0?e.jsx(o,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):E.map(n=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(i,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative"},children:[e.jsx(i,{children:n.author===(s==null?void 0:s.uid)&&e.jsx(g,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{onClick:()=>C(`/view-material/${n.id}`),"aria-label":"view",children:e.jsx(H,{})}),e.jsx(o,{variant:"h6",sx:{flexGrow:1,maxWidth:"50%",wordWrap:"break-word"},children:n.title||"Untitled"})]}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(o,{variant:"body2",color:"textSecondary",children:["Date: ",n.timestamp.toDate().toLocaleString()]}),e.jsxs(o,{variant:"body2",color:"textSecondary",children:["Status: ",n.published?"Published":"Unpublished"]})]}),e.jsx(i,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>C(`/edit-material/${n.id}`),"aria-label":"edit",children:e.jsx($,{})}),e.jsx(p,{onClick:()=>F(n.id),"aria-label":"delete",children:e.jsx(B,{})}),e.jsx(xe,{materialId:n.id,onClick:Z})]})}),e.jsx(i,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(o,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:n.course||"N/A"})})]})},n.id))}),j&&e.jsx(ce,{materialId:j,open:u,onClose:X,onDelete:Y}),f.materialId&&e.jsx(ue,{materialId:f.materialId,open:f.open,onClose:V,onUnpublish:Q}),D&&e.jsx(L,{open:!0,autoHideDuration:6e3,onClose:()=>k(null),children:e.jsx(G,{onClose:()=>k(null),severity:"error",children:D})})]})},ge=()=>{const{userDetails:s}=v();return e.jsxs(i,{sx:{flexGrow:1,padding:3},children:[e.jsx(re,{}),e.jsxs(i,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(s==null?void 0:s.isAdmin)&&e.jsx(de,{}),e.jsx(pe,{})]})]})};export{ge as default};
