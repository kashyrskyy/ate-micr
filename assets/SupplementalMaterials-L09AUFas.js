import{H as v,I as M,e as r,j as e,B as n,p as u,T as t,J as b,q as oe,K as te,t as _,A as z,az as R,a0 as O,ai as J,a1 as K,aj as V,ak as X,aq as Q,ax as le,as as ae,at as H,av as L,au as F,an as G,aA as re,aB as de,G as m,V as x,W as D,X as E}from"./index-CejaX1ZU.js";import{d as I}from"./Visibility-D9buOWoK.js";const ce=()=>{const{userDetails:s,isSuperAdmin:a}=v(),o=M(),[d,c]=r.useState(!1),[l,h]=r.useState(!1),f=()=>{s!=null&&s.uid?navigator.clipboard.writeText(s.uid).then(()=>{c(!0),h(!0)}).catch(j=>{console.error("Could not copy text: ",j)}):console.error("User details are null or undefined")},p=(j,C)=>{C!=="clickaway"&&c(!1)},k=()=>{o("/")};return e.jsxs(n,{children:[e.jsx(n,{sx:{display:"flex",alignItems:"center"},children:e.jsx(u,{variant:"text",onClick:k,sx:{mr:2},children:"← Home Page"})}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(t,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[a&&e.jsx(b,{label:"Super-Admin",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),(s==null?void 0:s.isAdmin)&&!a&&e.jsx(b,{label:"Educator",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#ffcdd2",color:"#c62828",mr:1}}),!(s!=null&&s.isAdmin)&&e.jsx(b,{label:"Student",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#bbdefb",color:"#1e88e5",mr:1}}),s&&e.jsx(oe,{title:l?"Copied!":"Click to Copy",enterDelay:300,leaveDelay:200,children:e.jsx(b,{label:`User ID: ${s.uid}`,variant:"outlined",onClick:f,sx:{borderRadius:"15px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",mr:2}})}),e.jsx(te,{})]}),e.jsx(_,{open:d,autoHideDuration:6e3,onClose:p,children:e.jsx(z,{onClose:p,severity:"success",sx:{width:"100%"},children:"User ID copied to clipboard!"})})]})]})},xe=()=>{const s=M();return e.jsx(u,{variant:"contained",color:"primary",onClick:()=>s("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},ue=({materialId:s,open:a,onClose:o,onDelete:d})=>{const c=R(),l=async()=>{const h=Q(c,"materials",s);await le(h),d(),o()};return e.jsxs(O,{open:a,onClose:o,children:[e.jsx(J,{children:"Delete Material"}),e.jsx(K,{children:e.jsx(V,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(X,{children:[e.jsx(u,{onClick:o,color:"primary",children:"Cancel"}),e.jsx(u,{onClick:l,color:"secondary",children:"Delete"})]})]})},q=({materialId:s,onClick:a})=>e.jsx(u,{variant:"contained",color:"error",onClick:()=>a(s),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),he=({materialId:s,open:a,onClose:o,onUnpublish:d})=>{const c=R(),l=async()=>{const h=Q(c,"materials",s);await ae(h,{published:!1}),d(),o()};return e.jsxs(O,{open:a,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(J,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(K,{children:e.jsx(V,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(X,{children:[e.jsx(u,{onClick:o,color:"primary",children:"Cancel"}),e.jsx(u,{onClick:l,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},pe=({selectedCourse:s,onCourseChange:a})=>{const{userDetails:o}=v(),[d,c]=r.useState(["Public-Source"]);return r.useEffect(()=>{if(o!=null&&o.class){const l=Array.from(new Set(["Public-Source",...o.class]));c(l)}else c(["Public-Source"])},[o]),e.jsx(n,{sx:{display:"flex",gap:2,mb:2},children:d.map(l=>e.jsx(u,{variant:s===l?"contained":"outlined",onClick:()=>a(l),children:l},l))})},be=()=>{const{userDetails:s}=v(),a=R(),[o,d]=r.useState([]),[c,l]=r.useState(!0),[h,f]=r.useState(!1),[p,k]=r.useState("Public-Source"),[j,C]=r.useState(null),[y,U]=r.useState({open:!1,materialId:null}),[W,S]=r.useState(null),g=M();r.useEffect(()=>{if(!s)return;l(!0);const i=s.isAdmin?H(G(a,"materials"),F("course","==",p),L("timestamp","desc")):H(G(a,"materials"),F("course","==",p),F("published","==",!0),L("timestamp","desc")),se=re(i,w=>{const ne=w.docs.map(N=>({id:N.id,...N.data()}));d(ne),l(!1)},w=>{console.error(w),S("Failed to fetch materials"),l(!1)});return()=>se()},[a,s,p]);const A=i=>{C(i),f(!0)},Y=()=>{f(!1),C(null)},Z=()=>{d(o.filter(i=>i.id!==j))},T=i=>{U({open:!0,materialId:i})},ee=()=>{d(o.map(i=>i.id===y.materialId?{...i,published:!1}:i))},ie=()=>{U({open:!1,materialId:null})};if(c)return e.jsx(de,{});const P=o.filter(i=>!i.published&&!i.scheduledTimestamp),B=o.filter(i=>i.scheduledTimestamp&&!i.published),$=o.filter(i=>i.published);return e.jsxs(n,{sx:{width:"100%"},children:[e.jsx(pe,{selectedCourse:p,onCourseChange:i=>{l(!0),k(i)}}),(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#F57C00"},children:"Saved"})}),e.jsx(m,{container:!0,spacing:3,children:P.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):P.map(i=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#FFF9C4"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(b,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>g(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(I,{})}),e.jsx(t,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Saved"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>g(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(D,{})}),e.jsx(x,{onClick:()=>A(i.id),"aria-label":"delete",children:e.jsx(E,{})})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),e.jsx(n,{sx:{backgroundColor:"#E3F2FD",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#0D47A1"},children:"Publish Scheduled"})}),e.jsx(m,{container:!0,spacing:3,children:B.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No materials scheduled for publishing found."}):B.map(i=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E3F2FD"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(b,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>g(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(I,{})}),e.jsx(t,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Scheduled for Publishing"})]}),i.scheduledTimestamp&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(n,{sx:{backgroundColor:"#E3F2FD",border:"1px solid #90CAF9",borderRadius:"16px",padding:"4px 8px"},children:e.jsxs(t,{variant:"body2",sx:{color:"#0D47A1",fontWeight:"bold"},children:["Publish Date: ",i.scheduledTimestamp.toDate().toLocaleString()]})})}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>g(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(D,{})}),e.jsx(x,{onClick:()=>A(i.id),"aria-label":"delete",children:e.jsx(E,{})}),e.jsx(q,{materialId:i.id,onClick:T})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))})]}),e.jsx(n,{sx:{backgroundColor:"#E8F5E9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(m,{container:!0,spacing:3,children:$.length===0?e.jsx(t,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):$.map(i=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E8F5E9"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(b,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(x,{onClick:()=>g(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(I,{})}),e.jsx(t,{variant:"h6",sx:{flexGrow:1,maxWidth:"50%",wordWrap:"break-word"},children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",color:"textSecondary",children:["Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Status: Published"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>g(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(D,{})}),e.jsx(x,{onClick:()=>A(i.id),"aria-label":"delete",children:e.jsx(E,{})}),e.jsx(q,{materialId:i.id,onClick:T})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(t,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),j&&e.jsx(ue,{materialId:j,open:h,onClose:Y,onDelete:Z}),y.materialId&&e.jsx(he,{materialId:y.materialId,open:y.open,onClose:ie,onUnpublish:ee}),W&&e.jsx(_,{open:!0,autoHideDuration:6e3,onClose:()=>S(null),children:e.jsx(z,{onClose:()=>S(null),severity:"error",children:W})})]})},me=()=>{const{userDetails:s}=v();return e.jsxs(n,{sx:{flexGrow:1,padding:3},children:[e.jsx(ce,{}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(s==null?void 0:s.isAdmin)&&e.jsx(xe,{}),e.jsx(be,{})]})]})};export{me as default};
