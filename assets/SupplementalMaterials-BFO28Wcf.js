import{H as A,j as e,B as n,p as h,T as l,ax as D,Y as _,ag as q,Z as z,ah as O,ai as Q,ao as Y,av as se,aq as ne,af as E,e as o,ar as $,at as G,as as v,al as H,ay as le,az as te,G as p,aA as k,Q as c,R as S,U as F,t as ae,A as re}from"./index-C2eOl179.js";import{d as w}from"./Visibility-7Ks_gYcM.js";const oe=()=>{const s=A(),r=()=>{s("/")};return e.jsxs(n,{children:[e.jsx(n,{sx:{display:"flex",alignItems:"center"},children:e.jsx(h,{variant:"text",onClick:r,sx:{mr:2},children:"← Home Page"})}),e.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(l,{variant:"h4",component:"h1",sx:{fontWeight:"bold"},children:"Supplemental Materials"})})]})},de=()=>{const s=A();return e.jsx(h,{variant:"contained",color:"primary",onClick:()=>s("/add-material"),sx:{fontSize:"1.2rem",mt:2,mb:4,textTransform:"none",minWidth:"150px",boxShadow:"none","&:hover":{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",transform:"scale(1.05)"},transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out",border:"1px solid transparent"},children:"+ Add Material"})},ce=({materialId:s,open:r,onClose:t,onDelete:d})=>{const x=D(),a=async()=>{const b=Y(x,"materials",s);await se(b),d(),t()};return e.jsxs(_,{open:r,onClose:t,children:[e.jsx(q,{children:"Delete Material"}),e.jsx(z,{children:e.jsx(O,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(Q,{children:[e.jsx(h,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:a,color:"secondary",children:"Delete"})]})]})},L=({materialId:s,onClick:r})=>e.jsx(h,{variant:"contained",color:"error",onClick:()=>r(s),sx:{backgroundColor:"#FFCDD2",color:"#C62828",borderRadius:"15px",fontWeight:"bold",padding:"4px 8px",ml:1,textTransform:"none"},children:"Unpublish"}),xe=({materialId:s,open:r,onClose:t,onUnpublish:d})=>{const x=D(),a=async()=>{const b=Y(x,"materials",s);await ne(b,{published:!1}),d(),t()};return e.jsxs(_,{open:r,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(q,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(z,{children:e.jsx(O,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(Q,{children:[e.jsx(h,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(h,{onClick:a,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},he=({selectedCourse:s,onCourseChange:r})=>{const{userDetails:t}=E(),[d,x]=o.useState(["Public-Source"]);return o.useEffect(()=>{if(t!=null&&t.class){const a=Array.from(new Set(["Public-Source",...t.class]));x(a)}else x(["Public-Source"])},[t]),e.jsx(n,{sx:{display:"flex",gap:2,mb:2},children:d.map(a=>e.jsx(h,{variant:s===a?"contained":"outlined",onClick:()=>r(a),children:a},a))})},ue=()=>{const{userDetails:s}=E(),r=D(),[t,d]=o.useState([]),[x,a]=o.useState(!0),[b,M]=o.useState(!1),[j,Z]=o.useState("Public-Source"),[m,R]=o.useState(null),[g,I]=o.useState({open:!1,materialId:null}),[U,f]=o.useState(null),u=A();o.useEffect(()=>{if(!s)return;a(!0);const i=s.isAdmin?$(H(r,"materials"),v("course","==",j),G("timestamp","desc")):$(H(r,"materials"),v("course","==",j),v("published","==",!0),G("timestamp","desc")),ee=le(i,y=>{const ie=y.docs.map(N=>({id:N.id,...N.data()}));d(ie),a(!1)},y=>{console.error(y),f("Failed to fetch materials"),a(!1)});return()=>ee()},[r,s,j]);const C=i=>{R(i),M(!0)},J=()=>{M(!1),R(null)},K=()=>{d(t.filter(i=>i.id!==m))},W=i=>{I({open:!0,materialId:i})},V=()=>{d(t.map(i=>i.id===g.materialId?{...i,published:!1}:i))},X=()=>{I({open:!1,materialId:null})};if(x)return e.jsx(te,{});const P=t.filter(i=>!i.published&&!i.scheduledTimestamp),T=t.filter(i=>i.scheduledTimestamp&&!i.published),B=t.filter(i=>i.published);return e.jsxs(n,{sx:{width:"100%"},children:[e.jsx(he,{selectedCourse:j,onCourseChange:i=>{a(!0),Z(i)}}),(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{backgroundColor:"#FFF9C4",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#F57C00"},children:"Saved"})}),e.jsx(p,{container:!0,spacing:3,children:P.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No saved (unpublished) materials found."}):P.map(i=>e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#FFF9C4"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(k,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(c,{onClick:()=>u(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(w,{})}),e.jsx(l,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(l,{variant:"body2",color:"textSecondary",children:"Status: Saved"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(c,{onClick:()=>u(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(S,{})}),e.jsx(c,{onClick:()=>C(i.id),"aria-label":"delete",children:e.jsx(F,{})})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(l,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),e.jsx(n,{sx:{backgroundColor:"#E3F2FD",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#0D47A1"},children:"Publish Scheduled"})}),e.jsx(p,{container:!0,spacing:3,children:T.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No materials scheduled for publishing found."}):T.map(i=>e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E3F2FD"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(k,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(c,{onClick:()=>u(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(w,{})}),e.jsx(l,{variant:"h6",children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Created Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(l,{variant:"body2",color:"textSecondary",children:"Status: Scheduled for Publishing"})]}),i.scheduledTimestamp&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(n,{sx:{backgroundColor:"#E3F2FD",border:"1px solid #90CAF9",borderRadius:"16px",padding:"4px 8px"},children:e.jsxs(l,{variant:"body2",sx:{color:"#0D47A1",fontWeight:"bold"},children:["Publish Date: ",i.scheduledTimestamp.toDate().toLocaleString()]})})}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(c,{onClick:()=>u(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(S,{})}),e.jsx(c,{onClick:()=>C(i.id),"aria-label":"delete",children:e.jsx(F,{})}),e.jsx(L,{materialId:i.id,onClick:W})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(l,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))})]}),e.jsx(n,{sx:{backgroundColor:"#E8F5E9",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:4,mb:2},children:e.jsx(l,{variant:"h6",sx:{fontWeight:"bold",color:"#2E7D32"},children:"Published"})}),e.jsx(p,{container:!0,spacing:3,children:B.length===0?e.jsx(l,{variant:"body1",align:"center",sx:{width:"100%"},children:"No published materials found."}):B.map(i=>e.jsx(p,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(n,{sx:{border:"1px solid #ddd",borderRadius:"8px",padding:2,position:"relative",backgroundColor:"#E8F5E9"},children:[e.jsx(n,{children:i.author===(s==null?void 0:s.uid)&&e.jsx(k,{label:"My Material",variant:"outlined",sx:{borderRadius:"15px",fontWeight:"bold",background:"#C5E1A5",color:"#2E7D32",ml:1}})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(c,{onClick:()=>u(`/view-material/${i.id}`),"aria-label":"view",children:e.jsx(w,{})}),e.jsx(l,{variant:"h6",sx:{flexGrow:1,maxWidth:"50%",wordWrap:"break-word"},children:i.title||"Untitled"})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{variant:"body2",color:"textSecondary",children:["Date: ",i.timestamp.toDate().toLocaleString()]}),e.jsx(l,{variant:"body2",color:"textSecondary",children:"Status: Published"})]}),e.jsx(n,{sx:{position:"absolute",top:8,right:8,display:"flex",gap:1},children:(s==null?void 0:s.isAdmin)&&e.jsxs(e.Fragment,{children:[e.jsx(c,{onClick:()=>u(`/edit-material/${i.id}`),"aria-label":"edit",children:e.jsx(S,{})}),e.jsx(c,{onClick:()=>C(i.id),"aria-label":"delete",children:e.jsx(F,{})}),e.jsx(L,{materialId:i.id,onClick:W})]})}),e.jsx(n,{sx:{backgroundColor:"#E0F7FA",borderRadius:"8px",padding:"4px 8px",display:"inline-block",mt:2},children:e.jsx(l,{variant:"body2",sx:{color:"#00796B",fontWeight:"bold"},children:i.course||"N/A"})})]})},i.id))}),m&&e.jsx(ce,{materialId:m,open:b,onClose:J,onDelete:K}),g.materialId&&e.jsx(xe,{materialId:g.materialId,open:g.open,onClose:X,onUnpublish:V}),U&&e.jsx(ae,{open:!0,autoHideDuration:6e3,onClose:()=>f(null),children:e.jsx(re,{onClose:()=>f(null),severity:"error",children:U})})]})},je=()=>{const{userDetails:s}=E();return e.jsxs(n,{sx:{flexGrow:1,padding:3},children:[e.jsx(oe,{}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(s==null?void 0:s.isAdmin)&&e.jsx(de,{}),e.jsx(ue,{})]})]})};export{je as default};
